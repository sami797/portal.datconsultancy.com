"use strict";
(self["webpackChunkdat_projects"] = self["webpackChunkdat_projects"] || []).push([[2396],{

/***/ 52396:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ UsageHistory)
});

// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js
var objectSpread2 = __webpack_require__(89379);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(9950);
// EXTERNAL MODULE: ./src/Components/Atoms/index.tsx + 12 modules
var Atoms = __webpack_require__(9394);
// EXTERNAL MODULE: ./node_modules/antd/es/message/index.js + 1 modules
var message = __webpack_require__(92759);
// EXTERNAL MODULE: ./node_modules/antd/es/empty/index.js + 2 modules
var empty = __webpack_require__(90247);
// EXTERNAL MODULE: ./src/Components/Organisms/Skeletons/index.tsx
var Skeletons = __webpack_require__(70619);
// EXTERNAL MODULE: ./node_modules/antd/es/tag/index.js + 1 modules
var tag = __webpack_require__(12916);
// EXTERNAL MODULE: ./node_modules/antd/es/table/index.js + 96 modules
var table = __webpack_require__(41821);
// EXTERNAL MODULE: ./src/helpers/commonEnums.ts
var commonEnums = __webpack_require__(2360);
// EXTERNAL MODULE: ./src/helpers/constants.ts
var constants = __webpack_require__(65944);
// EXTERNAL MODULE: ./src/helpers/dateHandler.ts
var dateHandler = __webpack_require__(98933);
// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js
var jsx_runtime = __webpack_require__(44414);
;// ./src/Components/Organisms/SiteSettings/CreditTransactions/UsageHistory/table-columns.tsx
function TableComponent(props){const{tableData,tableLoading,emptyText}=props;const columns=[{title:"S.No",dataIndex:"index",key:"index",render:(text,record,index)=>index+1,width:"60px"},{title:"Organization",dataIndex:"organization",key:"organization",render:(organization,record)=>{var _record$user,_record$user2,_record$user3;return/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex",children:[/*#__PURE__*/(0,jsx_runtime.jsx)("img",{src:"".concat(constants/* RESOURCE_BASE_URL */.to).concat(organization===null||organization===void 0?void 0:organization.logo),alt:"organization",style:{width:"20px",height:"20px",borderRadius:"100%",objectFit:"cover"}}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"ml-2 my-auto",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"xs",children:"".concat(organization===null||organization===void 0?void 0:organization.name)})})]})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-main",size:"sm",weight:"semi",className:"my-1 text-center",children:"Agent"}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex",children:[/*#__PURE__*/(0,jsx_runtime.jsx)("img",{src:"".concat(constants/* RESOURCE_BASE_URL */.to).concat((_record$user=record.user)===null||_record$user===void 0?void 0:_record$user.profile),alt:"profile",style:{width:"20px",height:"20px",borderRadius:"100%",objectFit:"cover"}}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"ml-2 my-auto",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"xs",children:"".concat((_record$user2=record.user)===null||_record$user2===void 0?void 0:_record$user2.firstName," ").concat((_record$user3=record.user)===null||_record$user3===void 0?void 0:_record$user3.lastName)})})]})]})]});}},{title:'Credits',dataIndex:"creditsUsed",key:"creditsUsed",className:'text-center',render:(creditsUsed,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"color-dark-main font-size-sm d-flex justify-center",children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"\n                        ".concat(commonEnums/* CreditsTransactionType */.vY[record.transactionType]==="debit"?"color-red-yp":"","\n                       ").concat(commonEnums/* CreditsTransactionType */.vY[record.transactionType]==="credit"?"color-green-yp":"","\n                    "),children:[commonEnums/* CreditsTransactionType */.vY[record.transactionType]==="debit"&&"-",commonEnums/* CreditsTransactionType */.vY[record.transactionType]==="credit"&&"+","\xA0","".concat(creditsUsed)]})})},{title:'Credits Balance',dataIndex:"currentBalance",key:"currentBalance",className:'text-center',render:(currentBalance,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-main",size:"sm",children:"".concat(currentBalance)})},{title:'Transaction Type',dataIndex:"transactionType",key:"transactionType",className:'text-center',render:(transactionType,record)=>/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[commonEnums/* CreditsTransactionType */.vY[transactionType]==="debit"&&/*#__PURE__*/(0,jsx_runtime.jsx)(tag/* default */.A,{color:"#f5222d",children:commonEnums/* CreditsTransactionType */.vY[transactionType]}),commonEnums/* CreditsTransactionType */.vY[transactionType]==="hold"&&/*#__PURE__*/(0,jsx_runtime.jsx)(tag/* default */.A,{color:"#fadb14",children:commonEnums/* CreditsTransactionType */.vY[transactionType]}),commonEnums/* CreditsTransactionType */.vY[transactionType]==="upgrade"&&/*#__PURE__*/(0,jsx_runtime.jsx)(tag/* default */.A,{color:"#497174",children:commonEnums/* CreditsTransactionType */.vY[transactionType]}),commonEnums/* CreditsTransactionType */.vY[transactionType]==="refund"&&/*#__PURE__*/(0,jsx_runtime.jsx)(tag/* default */.A,{color:"#f5222d",children:commonEnums/* CreditsTransactionType */.vY[transactionType]}),commonEnums/* CreditsTransactionType */.vY[transactionType]==="credit"&&/*#__PURE__*/(0,jsx_runtime.jsx)(tag/* default */.A,{color:"#52c41a",children:commonEnums/* CreditsTransactionType */.vY[transactionType]})]})},{title:'Transaction Date',dataIndex:"transactionDate",key:"transactionDate",render:(transactionDate,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-main",size:"sm",children:(0,dateHandler/* convertDate */.ic)(transactionDate,"dd M,yy-t")})},{title:'Description',dataIndex:"transactionMessage",key:"transactionMessage",render:(transactionMessage,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-main",size:"sm",children:transactionMessage})},{title:'Reference ID',dataIndex:"referenceId",key:"referenceId",className:'text-center',render:(referenceId,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-main",size:"sm",children:"".concat(referenceId===null?"":referenceId)})},{title:'Refunded',dataIndex:"refunded",key:"refunded",className:'text-center',render:(refunded,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-main",size:"sm",children:"".concat(refunded===true?"Yes":"No")})}];return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(table/* default */.A,{sticky:true,dataSource:tableData,columns:columns,pagination:false,scroll:{x:991},loading:tableLoading,rowKey:record=>"saved-searches-view-".concat(record.id),locale:{emptyText:emptyText}})});}
// EXTERNAL MODULE: ./src/Modules/Transactions/permissions.ts
var permissions = __webpack_require__(735);
// EXTERNAL MODULE: ./src/Modules/Organization/index.ts
var Organization = __webpack_require__(42361);
// EXTERNAL MODULE: ./src/Components/Organisms/Common/styles.module.scss
var styles_module = __webpack_require__(96019);
// EXTERNAL MODULE: ./src/helpers/common.ts
var common = __webpack_require__(88132);
// EXTERNAL MODULE: ./src/Components/Templates/SiteSettings/index.tsx
var SiteSettings = __webpack_require__(16181);
;// ./src/Components/Organisms/SiteSettings/CreditTransactions/UsageHistory/index.tsx
// import { CreditsTransactionTypeString } from "../../../../../helpers/commonEnums";
const breadCrumbsData=[{text:"Home",isLink:true,path:"/"},{text:"Site Settings",isLink:true,path:"/siteSettings"},{isLink:false,text:"Credit Usage History"}];const SiteCreditsUsageHistory=()=>{var _moduleData$meta,_moduleData$meta2,_moduleData$meta3,_moduleData$meta4;// available permissions for the properties page
const permissionSlug=(0,common/* getPermissionSlugs */.AH)(permissions/* TransactionsPermissionsEnum */.t);//const { userPermissions } = useSelector((state: RootState) => state.usersReducer);
const[moduleData,setModuleData]=(0,react.useState)({loading:false,data:[]});const[selectedFilters,setSelectedFilters]=(0,react.useState)({transactionsType:"",dateRange:[""],userId:0,propertyId:0,organizationId:0,propertyType:""});const[reset,setReset]=(0,react.useState)(false);const propType=[{label:"Residential For Sale",value:"residential-for-sale"},{label:"Residential For Rent",value:"residential-for-rent"},{label:"Commercial For Sale",value:"commercial-for-sale"},{label:"Commercial For Rent",value:"commercial-for-rent"}];const organizationModule=(0,react.useMemo)(()=>new Organization/* OrganizationModule */.I(),[]);const onSelected=event=>{const{name,value}=event===null||event===void 0?void 0:event.target;if(name==="userId"||name==="propertyId"||name==="organizationId"){const isValidNumber=(0,common/* isNumber */.Et)(value);if(!isValidNumber){let label="";switch(name){case"userId":{label="User ID";break;}case"propertyId":{label="Property ID";break;}case"organizationId":{label="Organization ID";break;}}return message/* default */.Ay.error("".concat(label," should be a number"));}}// set the selected value in the state 
setSelectedFilters((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},selectedFilters),{},{[name]:value}));};const reloadTableData=(0,react.useCallback)(query=>{setModuleData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},moduleData),{},{loading:true}));// organizationModule.getCreditHistory(query).then((res) => {
// 	setModuleData({ ...res.data, loading: false });
// }).catch((err) => {
// 	setModuleData({ ...moduleData, loading: false });
// });
},[organizationModule,moduleData]);const onUpdate=(0,react.useCallback)(()=>{var _selectedFilters$date,_selectedFilters$date2;const fromDateString=((_selectedFilters$date=selectedFilters.dateRange)===null||_selectedFilters$date===void 0?void 0:_selectedFilters$date[0])||"";const toDateString=((_selectedFilters$date2=selectedFilters.dateRange)===null||_selectedFilters$date2===void 0?void 0:_selectedFilters$date2[1])||"";const fromDate=fromDateString?(0,dateHandler/* convertDate */.ic)(fromDateString,"yy-mm-dd"):undefined;const toDate=toDateString?(0,dateHandler/* convertDate */.ic)(toDateString,"yy-mm-dd"):undefined;const data={transactionsType:selectedFilters.transactionsType?selectedFilters.transactionsType:undefined,userId:Number(selectedFilters.userId)>0?Number(selectedFilters.userId):undefined,propertyId:Number(selectedFilters.propertyId)>0?Number(selectedFilters.propertyId):undefined,organizationId:Number(selectedFilters.organizationId)>0?Number(selectedFilters.organizationId):undefined,propertyType:selectedFilters.propertyType?selectedFilters.propertyType:undefined,fromDate:fromDate,toDate:toDate};// get the data from the api
reloadTableData(data);},[selectedFilters]);const onPaginationChange=(0,react.useCallback)((page,pageSize)=>{var _selectedFilters$date3,_selectedFilters$date4;const fromDateString=((_selectedFilters$date3=selectedFilters.dateRange)===null||_selectedFilters$date3===void 0?void 0:_selectedFilters$date3[0])||"";const toDateString=((_selectedFilters$date4=selectedFilters.dateRange)===null||_selectedFilters$date4===void 0?void 0:_selectedFilters$date4[1])||"";const fromDate=fromDateString?(0,dateHandler/* convertDate */.ic)(fromDateString,"yy-mm-dd"):undefined;const toDate=toDateString?(0,dateHandler/* convertDate */.ic)(toDateString,"yy-mm-dd"):undefined;const params={page:page,perPage:pageSize,transactionsType:selectedFilters.transactionsType?selectedFilters.transactionsType:undefined,userId:Number(selectedFilters.userId)>0?Number(selectedFilters.userId):undefined,propertyId:Number(selectedFilters.propertyId)>0?Number(selectedFilters.propertyId):undefined,organizationId:Number(selectedFilters.organizationId)>0?Number(selectedFilters.organizationId):undefined,propertyType:selectedFilters.propertyType?selectedFilters.propertyType:undefined,fromDate:fromDate,toDate:toDate};reloadTableData(params);},[selectedFilters]);(0,react.useEffect)(()=>{reloadTableData({perPage:10});},[]);(0,react.useEffect)(()=>{if(reset){onUpdate();}// after 2 seconds set reset clicked state to false
const timer=setTimeout(()=>{setReset(false);},2000);return()=>clearTimeout(timer);},[reset,selectedFilters,onUpdate]);return/*#__PURE__*/(0,jsx_runtime.jsxs)(SiteSettings["default"],{permissionSlug:permissionSlug,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* PageHeader */.zY,{heading:"Credits Usage History",breadCrumbData:breadCrumbsData,filters:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.filterWrapper,children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"radio",label:"Transaction Type",name:"transactionsType",options:Object.entries([]).map(_ref=>{let[key,value]=_ref;return{label:(0,common/* capitalize */.ZH)(key),value:value};}),value:String(selectedFilters===null||selectedFilters===void 0?void 0:selectedFilters.transactionsType),onChange:onSelected,onReset:()=>{setReset(true);setSelectedFilters((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},selectedFilters),{},{transactionsType:""}));},onUpdate:onUpdate})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"input",label:"Organization ID",name:"organizationId",value:(selectedFilters===null||selectedFilters===void 0?void 0:selectedFilters.organizationId)>0?String(selectedFilters===null||selectedFilters===void 0?void 0:selectedFilters.organizationId):"",onChange:onSelected,onReset:()=>{setReset(true);setSelectedFilters((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},selectedFilters),{},{organizationId:0}));},onUpdate:onUpdate})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"input",label:"User ID",name:"userId",value:(selectedFilters===null||selectedFilters===void 0?void 0:selectedFilters.userId)>0?String(selectedFilters===null||selectedFilters===void 0?void 0:selectedFilters.userId):"",onChange:onSelected,onReset:()=>{setReset(true);setSelectedFilters((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},selectedFilters),{},{userId:0}));},onUpdate:onUpdate})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"input",label:"Property ID",name:"propertyId",value:(selectedFilters===null||selectedFilters===void 0?void 0:selectedFilters.propertyId)>0?String(selectedFilters===null||selectedFilters===void 0?void 0:selectedFilters.propertyId):"",onChange:onSelected,onReset:()=>{setReset(true);setSelectedFilters((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},selectedFilters),{},{propertyId:0}));},onUpdate:onUpdate})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"datepicker",label:"Date",name:"dateRange",onChange:value=>{setSelectedFilters((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},selectedFilters),{},{dateRange:value}));},onReset:()=>{setReset(true);setSelectedFilters((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},selectedFilters),{},{dateRange:[]}));},onUpdate:onUpdate})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"radio",label:"Property Type",name:"propertyType",options:propType.map(item=>({label:item.label,value:item.value})),value:selectedFilters===null||selectedFilters===void 0?void 0:selectedFilters.propertyType,onChange:onSelected,onReset:()=>{setReset(true);setSelectedFilters((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},selectedFilters),{},{propertyType:""}));},onUpdate:onUpdate})})]})}),moduleData.loading?/*#__PURE__*/(0,jsx_runtime.jsx)(Skeletons/* default */.A,{items:5,fullWidth:true}):/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:styles_module/* default */.A.antdTableWrapper,children:/*#__PURE__*/(0,jsx_runtime.jsx)(TableComponent,{tableData:moduleData===null||moduleData===void 0?void 0:moduleData.data,tableLoading:moduleData===null||moduleData===void 0?void 0:moduleData.loading,emptyText:/*#__PURE__*/(0,jsx_runtime.jsx)(empty/* default */.A,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:200},description:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:"No credits usage history found"})})})}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Pagination */.dK,{total:moduleData===null||moduleData===void 0?void 0:(_moduleData$meta=moduleData.meta)===null||_moduleData$meta===void 0?void 0:_moduleData$meta.total,current:moduleData===null||moduleData===void 0?void 0:(_moduleData$meta2=moduleData.meta)===null||_moduleData$meta2===void 0?void 0:_moduleData$meta2.page,defaultPageSize:moduleData!==null&&moduleData!==void 0&&(_moduleData$meta3=moduleData.meta)!==null&&_moduleData$meta3!==void 0&&_moduleData$meta3.perPage?moduleData===null||moduleData===void 0?void 0:(_moduleData$meta4=moduleData.meta)===null||_moduleData$meta4===void 0?void 0:_moduleData$meta4.perPage:10,pageSizeOptions:[10,20,50,100],onChange:onPaginationChange})]})]});};/* harmony default export */ const UsageHistory = (SiteCreditsUsageHistory);

/***/ }),

/***/ 42361:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   I: () => (/* binding */ OrganizationModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
/* harmony import */ var _modules_Common_config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(21073);
class OrganizationModule{constructor(){this.endPoint="organization";/**Get all organization records
     * @param query - query params
     */this.getAllRecords=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint,{params:query});};/**Get all organization records
     * @param query - query params
     */this.findPublished=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint+"/find-published",{params:query});};/**Get organization record by id
     * @param id - organization id
     */this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/").concat(id));};/**Delete organization record
    * @param id - organization id
    */this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete("".concat(this.endPoint,"/").concat(id));};/**Create new organization record
     * @param data - organization data
     */this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint,data,{headers:_modules_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};/**Update organization record
    * @param data - organization data
    * @param id - organization id
    */this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch("".concat(this.endPoint,"/").concat(id),data,{headers:_modules_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};this.getTenants=()=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("xero/getTenants");};}}

/***/ })

}]);