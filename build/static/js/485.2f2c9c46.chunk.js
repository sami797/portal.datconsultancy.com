"use strict";
(self["webpackChunkdat_projects"] = self["webpackChunkdat_projects"] || []).push([[485],{

/***/ 44394:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   d: () => (/* binding */ Switch)
/* harmony export */ });
/* harmony import */ var C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(89379);
/* harmony import */ var C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(80045);
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(92759);
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(25933);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(9950);
/* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(38266);
/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(44414);
const _excluded=["onChange","checked","recordId","allowChange"];const Switch=_ref=>{let{onChange,checked,recordId,allowChange=true}=_ref,rest=(0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .A)(_ref,_excluded);const[buttonState,setButtonState]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({loading:false,checked:false});const onSwitchChange=checked=>{if(allowChange===true){setButtonState((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A)((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A)({},buttonState),{},{loading:true}));onChange(checked,recordId,rest).then(res=>{setButtonState((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A)((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A)({},buttonState),{},{checked:checked,loading:false}));antd__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Ay.success(res.data.message);}).catch(err=>{setButtonState((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A)((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A)({},buttonState),{},{loading:false}));let serverErrors=(0,_helpers__WEBPACK_IMPORTED_MODULE_5__/* .errorHandler */ .r)(err);if(typeof serverErrors.message==="string"){antd__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Ay.error(serverErrors.message);}else{antd__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Ay.error("Something went wrong");}});}else{antd__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Ay.error("You don't have permission to change this record, please contact your admin.");}};(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{setButtonState((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A)((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A)({},buttonState),{},{checked:checked}));},[checked]);return/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(antd__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .A,{checked:buttonState.checked,onChange:onSwitchChange,loading:buttonState.loading});};

/***/ }),

/***/ 90485:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ SiteSettings_Roles)
});

// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js
var objectSpread2 = __webpack_require__(89379);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(9950);
// EXTERNAL MODULE: ./src/Components/Templates/SiteSettings/index.tsx
var SiteSettings = __webpack_require__(16181);
// EXTERNAL MODULE: ./node_modules/antd/es/form/index.js + 18 modules
var es_form = __webpack_require__(10678);
// EXTERNAL MODULE: ./node_modules/antd/es/message/index.js + 1 modules
var message = __webpack_require__(92759);
// EXTERNAL MODULE: ./node_modules/antd/es/input-number/index.js + 10 modules
var input_number = __webpack_require__(40202);
// EXTERNAL MODULE: ./src/Components/Atoms/index.tsx + 12 modules
var Atoms = __webpack_require__(9394);
// EXTERNAL MODULE: ./src/Components/Organisms/SiteSettings/Common/styles.module.scss
var styles_module = __webpack_require__(41394);
// EXTERNAL MODULE: ./src/Components/Organisms/Skeletons/index.tsx
var Skeletons = __webpack_require__(70619);
// EXTERNAL MODULE: ./src/helpers/common.ts
var common = __webpack_require__(88132);
// EXTERNAL MODULE: ./src/Components/Atoms/ServerErrorHandler/index.tsx
var ServerErrorHandler = __webpack_require__(13321);
// EXTERNAL MODULE: ./src/helpers/error-handler.ts
var error_handler = __webpack_require__(38266);
// EXTERNAL MODULE: ./src/Modules/Roles/index.ts
var Roles = __webpack_require__(32027);
// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js
var jsx_runtime = __webpack_require__(44414);
;// ./src/Components/Organisms/SiteSettings/Roles/modal.tsx
const SiteRolesModal=props=>{var _recordData$data2;const{openModal,onCancel,type,record,reloadTableData,permissions:{createRole,updateRole}}=props;const[form]=es_form/* default */.A.useForm();const module=(0,react.useMemo)(()=>new Roles/* RolesModule */.C(),[]);const[recordData,setRecordData]=(0,react.useState)();const[roles,setRoles]=(0,react.useState)([]);const handleErrors=err=>{const error=(0,error_handler/* errorHandler */.r)(err);if(typeof error.message=="string"){setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:error.message}));}else{let errData=(0,ServerErrorHandler/* HandleServerErrors */.p)(error.message,[]);form.setFields(errData);setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));}};const handleAlertClose=()=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));};const getDataBySlug=(0,react.useCallback)(()=>{module.getRecordById(record).then(res=>{if(res.data&&res.data.data){form.setFieldsValue((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data.data),{},{isPublished:res.data.data.isPublished,level:res.data.data.level}));setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data),{},{loading:false}));}}).catch(err=>{handleErrors(err);});},[form,record,module]);const getRoles=(0,react.useCallback)(()=>{if(type==="edit"||type==="seo")return;module.getAllRecords().then(res=>{var _res$data;if(res.data&&(_res$data=res.data)!==null&&_res$data!==void 0&&_res$data.data){var _res$data2;setRoles((_res$data2=res.data)===null||_res$data2===void 0?void 0:_res$data2.data);}}).catch(err=>{handleErrors(err);});},[module,type]);(0,react.useEffect)(()=>{if(type==="edit"){setRecordData({loading:true});getDataBySlug();}else{form.resetFields();getRoles();}},[openModal,type,form,getDataBySlug,getRoles]);const handleSlugChange=_ref=>{let{target}=_ref;let slug=(0,common/* slugifyString */.Dv)(target.value);form.setFieldsValue({slug:slug});};const onFinish=formValues=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{buttonLoading:true}));switch(type){case"edit":{if(updateRole===true){var _recordData$data;module.updateRecord(formValues,recordData===null||recordData===void 0?void 0:(_recordData$data=recordData.data)===null||_recordData$data===void 0?void 0:_recordData$data.id).then(res=>{reloadTableData();onCancel();setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to update this role");}break;}case"new":{if(createRole===true){module.createRecord(formValues).then(res=>{reloadTableData();onCancel();setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to create new role");}break;}}};return/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomModal */.jo,{visible:openModal,closable:true,onCancel:onCancel,titleText:type==="edit"?"Edit Role":"Add New Role",showFooter:false,children:recordData!==null&&recordData!==void 0&&recordData.loading?/*#__PURE__*/(0,jsx_runtime.jsx)(Skeletons/* default */.A,{items:10}):/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{className:styles_module/* default */.A.form,onFinish:onFinish,form:form,children:[(recordData===null||recordData===void 0?void 0:recordData.error)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomErrorAlert */.WZ,{description:recordData===null||recordData===void 0?void 0:recordData.error,isClosable:true,onClose:handleAlertClose}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"title",rules:[{required:true,message:"Please add a title"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Title",asterisk:true,type:"text"})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"slug",rules:[{required:true,message:"Please add a slug"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{onChange:handleSlugChange,size:"w100",label:"Slug",asterisk:true,type:"text",disabled:form.getFieldValue("slug")==="ORG-ADMIN"||form.getFieldValue("slug")==="SUPER-ADMIN"?true:false})})]}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"isPublished",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomSelect */.Ae,{label:"Published",options:[{value:true,label:"Yes"},{value:false,label:"No"}]})})}),type==="new"&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"copyRoleId",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomSelect */.Ae,{label:"Copy Permissions From",placeholder:"Select a role to copy permissions from",options:roles===null||roles===void 0?void 0:roles.map(role=>({label:role.title,value:role.id}))})})}),/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A.Item,{name:"level",children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"font-size-sm",children:"Level"}),/*#__PURE__*/(0,jsx_runtime.jsx)(input_number/* default */.A,{defaultValue:form.getFieldValue("level"),onChange:value=>{form.setFieldValue("level",value);},style:{width:'100%',borderRadius:'0.25rem',border:'2px solid var(--color-border)'},type:"number"})]}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"description",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Description",type:"textArea",defaultValue:recordData===null||recordData===void 0?void 0:(_recordData$data2=recordData.data)===null||_recordData$data2===void 0?void 0:_recordData$data2.description})})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.footer,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{size:"normal",fontSize:"sm",onClick:onCancel,type:"plain",children:"Cancel"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:recordData===null||recordData===void 0?void 0:recordData.buttonLoading,children:"Submit"})]})]})});};
// EXTERNAL MODULE: ./node_modules/antd/es/popconfirm/index.js + 1 modules
var popconfirm = __webpack_require__(56231);
// EXTERNAL MODULE: ./node_modules/antd/es/table/index.js + 96 modules
var table = __webpack_require__(41821);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/DeleteOutlined.js
var DeleteOutlined = __webpack_require__(78433);
// EXTERNAL MODULE: ./src/Components/Atoms/Headings/index.tsx
var Headings = __webpack_require__(35751);
// EXTERNAL MODULE: ./src/Components/Atoms/Switch/index.tsx
var Switch = __webpack_require__(44394);
// EXTERNAL MODULE: ./src/helpers/dateHandler.ts
var dateHandler = __webpack_require__(98933);
// EXTERNAL MODULE: ./src/Components/Icons/index.tsx + 58 modules
var Icons = __webpack_require__(63668);
// EXTERNAL MODULE: ./node_modules/react-router-dom/dist/index.js
var dist = __webpack_require__(42074);
// EXTERNAL MODULE: ./node_modules/react-redux/es/index.js + 21 modules
var es = __webpack_require__(98341);
// EXTERNAL MODULE: ./node_modules/antd/lib/typography/Paragraph.js
var Paragraph = __webpack_require__(80742);
;// ./src/Components/Organisms/SiteSettings/Roles/table-columns.tsx
const ActionComponent=props=>{const{record,onEditIconClick,reloadTableData,permissions:{deleteRole}}=props;const[actionState,setActionState]=(0,react.useState)({confirmLoading:false,openPopConfirm:false});const module=(0,react.useMemo)(()=>new Roles/* RolesModule */.C(),[]);const handleDelete=()=>{setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{confirmLoading:true}));if(deleteRole===false){message/* default */.Ay.error("You don't have permission to delete this record, please contact your admin.");setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false}));return;}module.deleteRecord(record.id).then(res=>{setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false,confirmLoading:false}));reloadTableData();}).catch(err=>{setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{confirmLoading:false}));});};const showPopconfirm=()=>{setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:true}));};return/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.actions,children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{onClick:()=>onEditIconClick(record),children:/*#__PURE__*/(0,jsx_runtime.jsx)("img",{src:"/images/editicon.svg",alt:""})}),/*#__PURE__*/(0,jsx_runtime.jsx)(popconfirm/* default */.A,{open:actionState.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:handleDelete,onCancel:()=>setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false})),okButtonProps:{loading:actionState.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:visible=>{if(!visible){setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false}));}},children:/*#__PURE__*/(0,jsx_runtime.jsx)(DeleteOutlined/* default */.A,{className:styles_module/* default */.A.bg__red,onClick:showPopconfirm})})]});};function TableComponent(props){const{tableData,tableLoading,onEditIconClick,reloadTableData,meta,filters,onManageDashboardElementsClick}=props;const{userPermissions}=(0,es/* useSelector */.d4)(state=>state.usersReducer);const permissions=userPermissions;const{updateRole,deleteRole,grantPrivilegesToRole,readRolePermissions}=permissions;const module=new Roles/* RolesModule */.C();const onIsPublishedChange=(checked,recordId)=>{return module.updateRecord({isPublished:checked},recordId);};const columns=[{title:"S.No",dataIndex:"index",key:"index",render:(text,record,index)=>index+1,width:"5%"},{title:"Title",dataIndex:"title",key:"title",render:(text,record)=>/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Headings/* default */.A,{color:"dark-main",size:"sm",children:record.title}),/*#__PURE__*/(0,jsx_runtime.jsx)(Headings/* default */.A,{color:"dark-sub",size:"xs",children:record.description})]})},{title:"Slug",dataIndex:"slug",key:"slug",render:(slug,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Headings/* default */.A,{color:"dark-main",size:"sm",children:slug})})},{title:"Dashboard",dataIndex:"DashboardElements",key:"DashboardElements",render:(DashboardElements,record)=>{var _record$DashboardElem;return/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Paragraph/* default */.A,{ellipsis:{rows:1,expandable:false},className:"my-0 color-dark-sub",children:/*#__PURE__*/(0,jsx_runtime.jsx)("ul",{style:{listStyle:"none",padding:0},children:(_record$DashboardElem=record.DashboardElements)===null||_record$DashboardElem===void 0?void 0:_record$DashboardElem.map(item=>{var _item$DashboardElemen;return/*#__PURE__*/(0,jsx_runtime.jsx)("li",{className:"font-size-xs ml-0",children:item===null||item===void 0?void 0:(_item$DashboardElemen=item.DashboardElement)===null||_item$DashboardElemen===void 0?void 0:_item$DashboardElemen.title});})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("p",{className:"color-dark-main font-weight-bold font-size-sm mb-0 ml-1 cursor-pointer",onClick:()=>onManageDashboardElementsClick(record),children:"Manage Dashboard"})]});}},{title:"Date Added",dataIndex:"addedDate",key:"addedDate",render:(addedDate,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(Headings/* default */.A,{color:"dark-main",size:"sm",children:(0,dateHandler/* convertDate */.ic)(addedDate,"dd M,yy")})//TODO: add Organization to the table
}];// show publish column only if user has update permission
if(updateRole===true){columns.push({title:"Published",dataIndex:"isPublished",key:"isPublished",render:(isPublished,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(Switch/* Switch */.d,{checked:record.isPublished,onChange:onIsPublishedChange,recordId:record.id,allowChange:updateRole})});}// show permissions column only if user has read or grant permission
if(grantPrivilegesToRole||readRolePermissions){columns.push({title:"Permissions",dataIndex:"permissions",key:"permissions",render:(slug,record)=>/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[grantPrivilegesToRole===true&&/*#__PURE__*/(0,jsx_runtime.jsxs)(dist/* Link */.N_,{to:"/siteSettings/roles/permissions?roleId=".concat(record.id),className:"d-flex",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Icons/* PermissionSettingsIcon */.IW,{className:"my-auto"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Headings/* default */.A,{color:"dark-sub",size:"sm",className:"ml-2",children:"Manage Permissions"})]}),readRolePermissions===true&&/*#__PURE__*/(0,jsx_runtime.jsxs)(dist/* Link */.N_,{to:"/siteSettings/roles/permissions/view?roleId=".concat(record.id),className:"d-flex mt-2",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Icons/* ViewIcon */.tC,{className:"my-auto"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Headings/* default */.A,{color:"dark-sub",size:"sm",className:"ml-2",children:"View Permissions"})]})]})});}// show actions column only if user has update or delete role permission
if(updateRole===true||deleteRole===true){columns.push({title:"Actions",dataIndex:"actions",key:"actions",render:(actions,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(ActionComponent,{record:record,onEditIconClick:onEditIconClick,reloadTableData:reloadTableData,permissions:permissions})});}return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:styles_module/* default */.A.antdTableWrapper,children:/*#__PURE__*/(0,jsx_runtime.jsx)(table/* default */.A,{sticky:true,dataSource:tableData,columns:columns,pagination:{current:meta===null||meta===void 0?void 0:meta.page,total:meta===null||meta===void 0?void 0:meta.total,hideOnSinglePage:true,pageSize:meta===null||meta===void 0?void 0:meta.perPage,onChange(page,pageSize){reloadTableData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},filters),{},{page:page,perPage:pageSize}));}},scroll:{x:991},loading:tableLoading,rowKey:record=>"site-Role-".concat(record.id)})});}
// EXTERNAL MODULE: ./src/Modules/Roles/permissions.ts
var Roles_permissions = __webpack_require__(39919);
// EXTERNAL MODULE: ./src/Components/Atoms/ErrorCodes/index.tsx + 1 modules
var ErrorCodes = __webpack_require__(36250);
// EXTERNAL MODULE: ./src/hooks/index.ts + 5 modules
var hooks = __webpack_require__(91970);
// EXTERNAL MODULE: ./node_modules/antd/es/transfer/index.js + 5 modules
var transfer = __webpack_require__(97579);
// EXTERNAL MODULE: ./src/Components/Organisms/Common/styles.module.scss
var Common_styles_module = __webpack_require__(96019);
// EXTERNAL MODULE: ./src/Modules/DashboardElement/index.ts
var DashboardElement = __webpack_require__(66722);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/MenuOutlined.js + 1 modules
var MenuOutlined = __webpack_require__(5099);
// EXTERNAL MODULE: ./node_modules/react-dnd/dist/hooks/useDrop/useDrop.js + 9 modules
var useDrop = __webpack_require__(89135);
// EXTERNAL MODULE: ./node_modules/react-dnd/dist/hooks/useDrag/useDrag.js + 9 modules
var useDrag = __webpack_require__(65325);
// EXTERNAL MODULE: ./node_modules/react-dnd/dist/core/DndProvider.js + 33 modules
var DndProvider = __webpack_require__(59767);
// EXTERNAL MODULE: ./node_modules/react-dnd-html5-backend/dist/index.js + 12 modules
var react_dnd_html5_backend_dist = __webpack_require__(72500);
;// ./src/Components/Organisms/SiteSettings/Roles/DashboardElements/styles.module.scss
// extracted by mini-css-extract-plugin
/* harmony default export */ const DashboardElements_styles_module = ({"itemWrapper":"styles_itemWrapper__9w9b0","drop-over-downward":"styles_drop-over-downward__zvM-W","drop-over-upward":"styles_drop-over-upward__qnx9H"});
;// ./src/Components/Organisms/SiteSettings/Roles/DashboardElements/modal.tsx
const DashboardElementsModal=props=>{var _dashboardElementsDat;const{openModal,onCancel,record,reloadTableData,recordData,permissions:{createRole}}=props;const[form]=es_form/* default */.A.useForm();// roles module
const module=(0,react.useMemo)(()=>new Roles/* RolesModule */.C(),[]);const dashboardElementModule=(0,react.useMemo)(()=>new DashboardElement/* DashboardElementModule */.F(),[]);const[dashboardElementsData,setDashboardElementsData]=(0,react.useState)();let selectedKeys=[];if(recordData&&recordData.DashboardElements){var _recordData$Dashboard;recordData===null||recordData===void 0?void 0:(_recordData$Dashboard=recordData.DashboardElements)===null||_recordData$Dashboard===void 0?void 0:_recordData$Dashboard.map(ele=>{var _ele$DashboardElement,_ele$DashboardElement2;selectedKeys.push(ele===null||ele===void 0?void 0:(_ele$DashboardElement=ele.DashboardElement)===null||_ele$DashboardElement===void 0?void 0:(_ele$DashboardElement2=_ele$DashboardElement.id)===null||_ele$DashboardElement2===void 0?void 0:_ele$DashboardElement2.toString());});}const[targetKeys,setTargetKeys]=(0,react.useState)(selectedKeys);const handleErrors=err=>{const error=(0,error_handler/* errorHandler */.r)(err);if(typeof error.message=="string"){setDashboardElementsData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},dashboardElementsData),{},{error:error.message}));}else{let errData=(0,ServerErrorHandler/* HandleServerErrors */.p)(error.message,[]);form.setFields(errData);setDashboardElementsData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},dashboardElementsData),{},{error:""}));}};const handleAlertClose=()=>{setDashboardElementsData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},dashboardElementsData),{},{error:""}));};const getDashboardElementsData=(0,react.useCallback)(()=>{dashboardElementModule.getAllRecords().then(res=>{var _res$data;if(res.data&&(_res$data=res.data)!==null&&_res$data!==void 0&&_res$data.data){setDashboardElementsData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data),{},{loading:false}));}}).catch(err=>{handleErrors(err);});},[form,record,module,dashboardElementModule]);const filterOption=(inputValue,option)=>{var _option$description;return(option===null||option===void 0?void 0:(_option$description=option.description)===null||_option$description===void 0?void 0:_option$description.indexOf(inputValue===null||inputValue===void 0?void 0:inputValue.toLowerCase()))>-1;};const handleChange=newTargetKeys=>{setTargetKeys(Array.from(new Set(newTargetKeys)));form.setFieldValue("elementIds",newTargetKeys);};(0,react.useEffect)(()=>{setDashboardElementsData({loading:true});getDashboardElementsData();},[openModal,form]);const onFinish=formValues=>{console.log(formValues.elementIds);if(formValues.elementIds){if(createRole){var _formValues$elementId;setDashboardElementsData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},dashboardElementsData),{},{buttonLoading:true}));const formData=formValues===null||formValues===void 0?void 0:(_formValues$elementId=formValues.elementIds)===null||_formValues$elementId===void 0?void 0:_formValues$elementId.map(ele=>Number(ele));module.addElements({elementIds:formData},record).then(res=>{reloadTableData();onCancel();setDashboardElementsData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:false}));message/* default */.Ay.success("Saved Successfully");}).catch(err=>{handleErrors(err);setDashboardElementsData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:false}));});let removedRoles=[];selectedKeys.map(ele=>{if(!targetKeys.includes(ele))removedRoles.push(Number(ele));});if((removedRoles===null||removedRoles===void 0?void 0:removedRoles.length)>0){module.removeElements({elementIds:removedRoles},record).catch(err=>{message/* default */.Ay.error(err.message);});}}else{message/* default */.Ay.error("You don't have permission to manage roles, please contact your admin");}}else{message/* default */.Ay.success("No changes made");onCancel();}};//drag and drop logic start
// change order
const moveRow=async(dragIndex,hoverIndex)=>{const clonedList=targetKeys;const el=clonedList.splice(dragIndex,1)[0];clonedList.splice(hoverIndex,0,el);handleChange(clonedList);};const DraggableItem=_ref=>{let{index,label,moveRow}=_ref;const type="DraggableItem";const ref=(0,react.useRef)();const[{isOver,dropClassName},drop]=(0,useDrop/* useDrop */.H)({accept:type,collect:monitor=>{const{index:dragIndex}=monitor.getItem()||{};if(dragIndex===index){return{};}return{isOver:monitor.isOver(),dropClassName:dragIndex<index?" drop-over-downward":" drop-over-upward"};},drop:item=>{moveRow(item.index,index);}});const[{isDragging},drag,preview]=(0,useDrag/* useDrag */.i)({type,item:{index},collect:monitor=>({isDragging:monitor.isDragging()})});preview(drop(ref));return/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{ref:ref,className:"".concat(isOver?dropClassName:"")+" "+DashboardElements_styles_module.itemWrapper,children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"label",children:label}),index!==-1&&/*#__PURE__*/(0,jsx_runtime.jsx)("span",{ref:drag,children:/*#__PURE__*/(0,jsx_runtime.jsx)(MenuOutlined/* default */.A,{})})]},label);};return/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomModal */.jo,{visible:openModal,closable:true,onCancel:onCancel,titleText:"Manage Dashboard Elements",showFooter:false,children:dashboardElementsData!==null&&dashboardElementsData!==void 0&&dashboardElementsData.loading?/*#__PURE__*/(0,jsx_runtime.jsx)(Skeletons/* default */.A,{items:10}):/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{className:Common_styles_module/* default */.A.form,onFinish:onFinish,form:form,children:[(dashboardElementsData===null||dashboardElementsData===void 0?void 0:dashboardElementsData.error)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomErrorAlert */.WZ,{description:dashboardElementsData===null||dashboardElementsData===void 0?void 0:dashboardElementsData.error,isClosable:true,onClose:handleAlertClose}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"elementIds",rules:[{required:false}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(DndProvider/* DndProvider */.Q,{backend:react_dnd_html5_backend_dist/* HTML5Backend */.t2,children:/*#__PURE__*/(0,jsx_runtime.jsx)(transfer/* default */.A,{dataSource:dashboardElementsData===null||dashboardElementsData===void 0?void 0:(_dashboardElementsDat=dashboardElementsData.data)===null||_dashboardElementsDat===void 0?void 0:_dashboardElementsDat.map((ele,index)=>{var _ele$title;return{key:ele.id.toString(),title:ele.title,description:(_ele$title=ele.title)===null||_ele$title===void 0?void 0:_ele$title.toLowerCase()};}),listStyle:{width:250,height:400},showSearch:true,filterOption:filterOption,targetKeys:targetKeys,onChange:handleChange//onSearch={handleSearch}
,render:item=>/*#__PURE__*/(0,jsx_runtime.jsx)(DraggableItem,{index:targetKeys.findIndex(key=>key===item.key),label:item.title,moveRow:moveRow})})})})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:Common_styles_module/* default */.A.footer,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{size:"normal",fontSize:"sm",onClick:onCancel,type:"plain",children:"Cancel"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:dashboardElementsData===null||dashboardElementsData===void 0?void 0:dashboardElementsData.buttonLoading,children:"Save"})]})]})});};
;// ./src/Components/Organisms/SiteSettings/Roles/index.tsx
const breadCrumbsData=[{text:"Home",isLink:true,path:"/"},{isLink:true,text:"Site Settings",path:"/siteSettings"},{isLink:false,text:"Roles"}];function SiteRoleSettings(){// available permissions for the properties page
const permissionSlug=(0,common/* getPermissionSlugs */.AH)(Roles_permissions/* RolePermissionsEnum */.M);// add new permission for the roles page
permissionSlug.push("grantPrivilegesToRole","readRolePermissions");const{userPermissions}=(0,es/* useSelector */.d4)(state=>state.usersReducer);const permissions=userPermissions;const{createRole,readRole,updateRole}=permissions;const[currentEditType,setcurrentEditType]=(0,react.useState)({editType:"new",recordId:0,openModal:false});const[editDashboardElements,setEditDashboardElements]=(0,react.useState)({recordId:0,openModal:false,recordData:{}});const onEditDashboardClick=record=>{// if (addUserRole === false) {
// 	message.error("You don't have permission to manage roles for this user");
// 	return;
// }
setEditDashboardElements((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},editDashboardElements),{},{recordId:record.id,recordData:record,openModal:true}));};const module=new Roles/* RolesModule */.C();const[filters,setFilters]=(0,react.useState)({page:1,perPage:10});const{data,onRefresh,setData,loading,meta}=(0,hooks/* useFetchData */.Gs)({method:module.getAllRecords,initialQuery:(0,objectSpread2/* default */.A)({},filters)});const onCancelClick=()=>{if(createRole===false){message/* default */.Ay.error("You don't have permission to create new record");return;}setcurrentEditType((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},currentEditType),{},{openModal:!currentEditType.openModal,editType:"new"}));};const onEditIconClick=record=>{if(updateRole===false){message/* default */.Ay.error("You don't have permission to update this record");return;}setcurrentEditType((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},currentEditType),{},{editType:"edit",recordId:record.id,openModal:true}));};return/*#__PURE__*/(0,jsx_runtime.jsxs)(SiteSettings["default"],{permissionSlug:permissionSlug,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* PageHeader */.zY,{heading:"Roles",buttonText:"Add New Role",onButtonClick:onCancelClick,breadCrumbData:breadCrumbsData,showAdd:createRole===true?true:false}),readRole===true&&/*#__PURE__*/(0,jsx_runtime.jsx)(TableComponent,{tableData:data,tableLoading:loading,onEditIconClick:onEditIconClick,reloadTableData:onRefresh,meta:meta,filters:filters,onManageDashboardElementsClick:onEditDashboardClick}),readRole===false&&/*#__PURE__*/(0,jsx_runtime.jsx)(ErrorCodes/* ErrorCode403 */.$t,{mainMessage:"You don't have permission to view this data"}),currentEditType.openModal&&/*#__PURE__*/(0,jsx_runtime.jsx)(SiteRolesModal,{record:currentEditType.recordId,type:currentEditType.editType,reloadTableData:onRefresh,onCancel:onCancelClick,openModal:currentEditType.openModal,permissions:permissions}),editDashboardElements.openModal&&/*#__PURE__*/(0,jsx_runtime.jsx)(DashboardElementsModal,{record:editDashboardElements.recordId,recordData:editDashboardElements.recordData,type:"edit",reloadTableData:onRefresh,onCancel:()=>setEditDashboardElements((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},editDashboardElements),{},{openModal:false})),openModal:editDashboardElements.openModal,permissions:permissions})]});}/* harmony default export */ const SiteSettings_Roles = (SiteRoleSettings);

/***/ }),

/***/ 66722:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   F: () => (/* binding */ DashboardElementModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
class DashboardElementModule{constructor(){this.endPoint="dashboard-elements";/**Get all Biometric records
	 * @param query - query params
	 */this.getAllRecords=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint,{params:query});};this.getDashboardContent=()=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint+"/get-dashboard-content");};this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(_services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* .BASE_URL */ .C+this.endPoint+"/"+id);};this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete(_services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* .BASE_URL */ .C+this.endPoint+"/"+id);};this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(_services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* .BASE_URL */ .C+this.endPoint,data);};this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch(_services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* .BASE_URL */ .C+this.endPoint+"/"+id,data);};}}

/***/ }),

/***/ 32027:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   C: () => (/* binding */ RolesModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
class RolesModule{constructor(){this.endPoint="role";this.getAllRecords=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint,{params:query});};this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/").concat(id,"?all=true"));};this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete("".concat(this.endPoint,"/").concat(id));};this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint+"/",data);};this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch("".concat(this.endPoint,"/").concat(id),data);};/** Add Elements to Role
 * @param {number} id - The id of the Role
 * @param {number[]} data.elementIds - The ids of the Elements
 */this.addElements=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post("".concat(this.endPoint,"/addDashboardElement/").concat(id),data);};/**
	 * Remove Elements from Role
	 * @param {number} id - The id of the Role
	 * @param {number[]} data.elementIds - The ids of the Elements
	 */this.removeElements=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post("".concat(this.endPoint,"/removeDashboardElement/").concat(id),data);};}}

/***/ })

}]);