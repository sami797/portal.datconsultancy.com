"use strict";
(self["webpackChunkdat_projects"] = self["webpackChunkdat_projects"] || []).push([[2105],{

/***/ 92107:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ Dashboard_Attendance)
});

// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js
var objectSpread2 = __webpack_require__(89379);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(9950);
// EXTERNAL MODULE: ./node_modules/antd/es/date-picker/index.js + 56 modules
var date_picker = __webpack_require__(4132);
// EXTERNAL MODULE: ./node_modules/antd/es/form/index.js + 18 modules
var es_form = __webpack_require__(10678);
// EXTERNAL MODULE: ./node_modules/antd/es/message/index.js + 1 modules
var message = __webpack_require__(92759);
// EXTERNAL MODULE: ./node_modules/antd/es/select/index.js + 30 modules
var es_select = __webpack_require__(97554);
// EXTERNAL MODULE: ./node_modules/antd/es/empty/index.js + 2 modules
var empty = __webpack_require__(90247);
// EXTERNAL MODULE: ./src/Components/Atoms/index.tsx + 12 modules
var Atoms = __webpack_require__(9394);
// EXTERNAL MODULE: ./src/Components/Organisms/Common/styles.module.scss
var styles_module = __webpack_require__(96019);
// EXTERNAL MODULE: ./src/Components/Organisms/Skeletons/index.tsx
var Skeletons = __webpack_require__(70619);
// EXTERNAL MODULE: ./src/Components/Atoms/ServerErrorHandler/index.tsx
var ServerErrorHandler = __webpack_require__(13321);
// EXTERNAL MODULE: ./src/helpers/error-handler.ts
var error_handler = __webpack_require__(38266);
// EXTERNAL MODULE: ./src/helpers/useDebounce.ts
var useDebounce = __webpack_require__(28173);
// EXTERNAL MODULE: ./src/Modules/Attendance/index.ts
var Attendance = __webpack_require__(33965);
// EXTERNAL MODULE: ./src/Modules/User/index.ts
var User = __webpack_require__(47645);
// EXTERNAL MODULE: ./node_modules/moment/moment.js
var moment = __webpack_require__(59051);
var moment_default = /*#__PURE__*/__webpack_require__.n(moment);
// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js
var jsx_runtime = __webpack_require__(44414);
;// ./src/Components/Organisms/Dashboard/Attendance/modal.tsx
const{TimePicker}=date_picker/* default */.A;const AttendanceModal=props=>{var _recordData$data;const{openModal,onCancel,type,record,reloadTableData,permissions:{createAttendance,updateAttendance},employeeId,date}=props;const[form]=es_form/* default */.A.useForm();const module=new Attendance/* AttendanceModule */.E();const[recordData,setRecordData]=(0,react.useState)();//user search
const[searchTermUser,setSearchTermUser]=(0,react.useState)("");const debouncedSearchTermUser=(0,useDebounce/* useDebounce */.d)(searchTermUser,500);const[users,setUsers]=(0,react.useState)([]);const userModule=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const onUserSearch=(0,react.useCallback)(()=>{if(debouncedSearchTermUser){userModule.getAllRecords({name:debouncedSearchTermUser}).then(res=>{setUsers(prev=>{var _res$data,_res$data$data;// if the data is already present in the state, then don't add it again
const filteredData=res===null||res===void 0?void 0:(_res$data=res.data)===null||_res$data===void 0?void 0:(_res$data$data=_res$data.data)===null||_res$data$data===void 0?void 0:_res$data$data.filter(item=>{return!(prev!==null&&prev!==void 0&&prev.find(prevItem=>prevItem.id===item.id));});// add the new data to the existing data
return[...prev,...filteredData];});}).catch(err=>{message/* default */.Ay.error(err.response.data.message);});}},[debouncedSearchTermUser]);(0,react.useEffect)(()=>{onUserSearch();},[onUserSearch]);const handleErrors=err=>{const error=(0,error_handler/* errorHandler */.r)(err);if(typeof error.message=="string"){setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:error.message}));}else{let errData=(0,ServerErrorHandler/* HandleServerErrors */.p)(error.message,[]);form.setFields(errData);setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));}};const handleAlertClose=()=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));};const getDataBySlug=(0,react.useCallback)(()=>{module.getRecordById(record).then(res=>{var _res$data2,_res$data2$data;const userId=res===null||res===void 0?void 0:(_res$data2=res.data)===null||_res$data2===void 0?void 0:(_res$data2$data=_res$data2.data)===null||_res$data2$data===void 0?void 0:_res$data2$data.userId;if(res.data&&res.data.data){form.setFieldsValue((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data.data),{},{userId:userId,checkIn:moment_default()(res.data.data.checkIn),checkOut:moment_default()(res.data.data.checkOut),date:moment_default()(res.data.data.checkIn)}));setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data),{},{loading:false}));// get the employee data from the api
if(userId){userModule.getRecordById(userId).then(res=>{var _res$data3;setUsers([res===null||res===void 0?void 0:(_res$data3=res.data)===null||_res$data3===void 0?void 0:_res$data3.data]);}).catch(err=>{message/* default */.Ay.error(err.response.data.message);});}}}).catch(err=>{handleErrors(err);});},[form,record,module]);(0,react.useEffect)(()=>{if(type==="edit"){setRecordData({loading:true});getDataBySlug();}else{form.resetFields();}},[]);(0,react.useEffect)(()=>{if(employeeId){userModule.getRecordById(employeeId).then(res=>{setUsers([res===null||res===void 0?void 0:res.data.data]);}).catch(err=>{console.log(err);});form.setFieldValue("userId",employeeId);}if(date){form.setFieldValue("date",moment_default()(date).add(1,"d"));}},[employeeId,date]);const onFinish=formValues=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{buttonLoading:true}));const _temp={};if(formValues.checkIn)_temp["checkIn"]=formValues.date._d.toISOString().substring(0,10)+formValues.checkIn._d.toISOString().substring(10);if(formValues.checkOut)_temp["checkOut"]=formValues.date._d.toISOString().substring(0,10)+formValues.checkOut._d.toISOString().substring(10);switch(type){case"edit":{if(updateAttendance===true){module.updateRecord((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},formValues),_temp),record).then(res=>{reloadTableData();onCancel();setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to update this record");}break;}case"new":{if(createAttendance===true){module.createRecord((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},formValues),_temp)).then(res=>{reloadTableData();onCancel();setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to create this record");}break;}}};return/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomModal */.jo,{visible:openModal,closable:true,onCancel:onCancel,titleText:type==="edit"?"Edit Attendance":"Add New Attendance",showFooter:false,children:recordData!==null&&recordData!==void 0&&recordData.loading?/*#__PURE__*/(0,jsx_runtime.jsx)(Skeletons/* default */.A,{items:3}):/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{className:styles_module/* default */.A.form,onFinish:onFinish,form:form,children:[(recordData===null||recordData===void 0?void 0:recordData.error)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomErrorAlert */.WZ,{description:recordData===null||recordData===void 0?void 0:recordData.error,isClosable:true,onClose:handleAlertClose}),type==="new"&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A.Item,{name:"userId",rules:[{required:true,message:"Please select an employee"}],children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{className:"font-size-sm",children:["Employee  ",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"color-red-yp",children:"*"})]}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_select/* default */.A,{allowClear:true,style:{width:"100%"},defaultValue:(recordData===null||recordData===void 0?void 0:(_recordData$data=recordData.data)===null||_recordData$data===void 0?void 0:_recordData$data.userId)||employeeId,placeholder:"Search for the employee",className:"selectAntdCustom",onChange:value=>form.setFieldsValue({userId:value}),showSearch:true,onSearch:value=>setSearchTermUser(value),optionFilterProp:"label",options:users===null||users===void 0?void 0:users.map(item=>{return{label:item.firstName+" "+item.lastName,value:item.id};}),notFoundContent:/*#__PURE__*/(0,jsx_runtime.jsx)(empty/* default */.A,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:"No data found, Please search for the employee"})})})]})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"note",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Note",type:"text",placeHolder:"Enter note"})})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{style:{width:'100%'},children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{style:{fontSize:'var(--font-size-sm)',color:'var(--color-dark-main)',width:'33%'},children:["Date",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{style:{color:'var(--color-red-yp)'},children:" *"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"date",rules:[{required:true,message:"Please select date "}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(date_picker/* default */.A,{style:{borderRadius:'0.25rem',borderWidth:2,width:'100%',borderColor:'var(--color-border)'}})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{style:{fontSize:'var(--font-size-sm)',color:'var(--color-dark-main)',width:'33%'},children:["Check in time",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{style:{color:'var(--color-red-yp)'},children:" *"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"checkIn",rules:[{required:true,message:"Please select date "}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(TimePicker,{showSecond:false,style:{borderRadius:'0.25rem',borderWidth:2,width:'100%',borderColor:'var(--color-border)'}})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{style:{fontSize:'var(--font-size-sm)',color:'var(--color-dark-main)',width:'33%'},children:["Check out time",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{style:{color:'var(--color-red-yp)'},children:" *"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"checkOut",rules:[{required:true,message:"Please select date "}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(TimePicker,{showSecond:false,style:{borderRadius:'0.25rem',borderWidth:2,width:'100%',borderColor:'var(--color-border)'}})})]})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex justify-end",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{size:"normal",fontSize:"sm",onClick:onCancel,type:"plain",children:"Cancel"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:recordData===null||recordData===void 0?void 0:recordData.buttonLoading,children:type==="edit"?"Edit Attendance":"Add Attendance"})]})]})});};
// EXTERNAL MODULE: ./src/Components/Organisms/Dashboard/Attendance/table-columns.tsx
var table_columns = __webpack_require__(16457);
// EXTERNAL MODULE: ./node_modules/react-redux/es/index.js + 21 modules
var es = __webpack_require__(98341);
// EXTERNAL MODULE: ./node_modules/antd/es/button/index.js
var es_button = __webpack_require__(48538);
// EXTERNAL MODULE: ./node_modules/antd/es/segmented/index.js + 2 modules
var segmented = __webpack_require__(84649);
// EXTERNAL MODULE: ./src/Components/Atoms/ErrorCodes/index.tsx + 1 modules
var ErrorCodes = __webpack_require__(36250);
// EXTERNAL MODULE: ./src/Components/Templates/Layout/index.tsx + 28 modules
var Layout = __webpack_require__(81168);
// EXTERNAL MODULE: ./src/hooks/index.ts + 5 modules
var hooks = __webpack_require__(91970);
// EXTERNAL MODULE: ./src/helpers/commonEnums.ts
var commonEnums = __webpack_require__(2360);
// EXTERNAL MODULE: ./src/Modules/Attendance/permissions.ts
var Attendance_permissions = __webpack_require__(43053);
// EXTERNAL MODULE: ./src/helpers/common.ts
var common = __webpack_require__(88132);
;// ./src/Components/Organisms/Dashboard/Attendance/styles.module.scss
// extracted by mini-css-extract-plugin
/* harmony default export */ const Attendance_styles_module = ({"view_as":"styles_view_as__TfAHq","monthPicker":"styles_monthPicker__0ge5W","yearPicker":"styles_yearPicker__3zfa1"});
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/DownOutlined.js
var DownOutlined = __webpack_require__(73022);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/BarsOutlined.js
var BarsOutlined = __webpack_require__(5992);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/CalendarOutlined.js
var CalendarOutlined = __webpack_require__(10604);
// EXTERNAL MODULE: ./node_modules/react-big-calendar/dist/react-big-calendar.esm.js + 294 modules
var react_big_calendar_esm = __webpack_require__(85189);
// EXTERNAL MODULE: ./node_modules/react-big-calendar/lib/css/react-big-calendar.css
var react_big_calendar = __webpack_require__(66379);
// EXTERNAL MODULE: ./src/helpers/constants.ts
var constants = __webpack_require__(65944);
;// ./src/Components/Organisms/Dashboard/Attendance/Calendar/index.tsx
const localizer=(0,react_big_calendar_esm/* momentLocalizer */.ye)((moment_default()));const CalendarComponent=_ref=>{let{data,month,year,onCellClick}=_ref;console.log("year",year);console.log("month",month);const[events,setEvents]=(0,react.useState)([]);let holidays=[];data.workingHour.hours.forEach(ele=>{if(ele.closed){holidays.push(ele.day);}});const dayPropGetter=(0,react.useCallback)(date=>{var _data$attendanceData,_data$attendanceData$,_data$attendanceData$2,_data$attendanceData$3,_data$attendanceData$4;return (0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},Number((_data$attendanceData=data.attendanceData)===null||_data$attendanceData===void 0?void 0:(_data$attendanceData$=_data$attendanceData.find(item=>moment_default()(item.day).get("D")===moment_default()(date).get("D")))===null||_data$attendanceData$===void 0?void 0:_data$attendanceData$.status)===commonEnums/* AttendanceStatus */.qg.incomplete&&{className:'incomplete-hours',style:{backgroundColor:'rgba(255, 140, 0, 0.6)'}}),(data===null||data===void 0?void 0:(_data$attendanceData$2=data.attendanceData.find(item=>moment_default()(item.day).get("D")===moment_default()(date).get("D")))===null||_data$attendanceData$2===void 0?void 0:_data$attendanceData$2.status)===commonEnums/* AttendanceStatus */.qg.absent&&{className:'absent',style:{backgroundColor:'rgba(247,5,5, 0.4)'}}),(data===null||data===void 0?void 0:(_data$attendanceData$3=data.attendanceData.find(item=>moment_default()(item.day).get("D")===moment_default()(date).get("D")))===null||_data$attendanceData$3===void 0?void 0:_data$attendanceData$3.status)===commonEnums/* AttendanceStatus */.qg.late&&{className:'late',style:{backgroundColor:'rgba(245,188,2, 0.4)'}}),(data===null||data===void 0?void 0:(_data$attendanceData$4=data.attendanceData.find(item=>moment_default()(item.day).get("D")===moment_default()(date).get("D")))===null||_data$attendanceData$4===void 0?void 0:_data$attendanceData$4.status)===commonEnums/* AttendanceStatus */.qg.complete&&{style:{backgroundColor:'white'}}),(holidays.includes(moment_default()(date).day())||moment_default()(date).month()!==month)&&{style:{backgroundColor:'var(--color-light-50)'}}),(0,common/* isDateGreaterThan */.uh)(new Date(),date)&&{className:'incomplete-hours',style:{background:"url(\"".concat(constants/* RESOURCE_BASE_URL */.to,"public/icons/lines.png\")"),backgroundRepeat:'no-repeat',backgroundSize:'cover'}});},[events]);(0,react.useEffect)(()=>{var _data$leaves,_data$publicHolidays;const _temp=[];(_data$leaves=data.leaves)===null||_data$leaves===void 0?void 0:_data$leaves.forEach(leave=>{_temp.push({id:leave.id,start:moment_default()(leave.leaveFrom).toDate(),end:moment_default()(leave.leaveTo).toDate(),title:(leave===null||leave===void 0?void 0:leave.purpose)+" (On leave)"});});(_data$publicHolidays=data.publicHolidays)===null||_data$publicHolidays===void 0?void 0:_data$publicHolidays.forEach(leave=>{_temp.push({id:leave.id,start:moment_default()(leave.date).toDate(),end:moment_default()(leave.date).toDate(),title:leave===null||leave===void 0?void 0:leave.title});});setEvents(_temp);},[data.leaves]);return/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{style:{display:'flex',flexDirection:'column',gap:'0.5rem'},children:[/*#__PURE__*/(0,jsx_runtime.jsx)(react_big_calendar_esm/* Calendar */.Vv,{components:{month:{dateHeader:_ref2=>{let{date,label}=_ref2;return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{onClick:event=>{var _data$attendanceData2,_data$attendanceData3;const recordId=data===null||data===void 0?void 0:(_data$attendanceData2=data.attendanceData)===null||_data$attendanceData2===void 0?void 0:(_data$attendanceData3=_data$attendanceData2.find(item=>moment_default()(item.day).get("D")===moment_default()(date).get("D")))===null||_data$attendanceData3===void 0?void 0:_data$attendanceData3.recordId;if(!(holidays.includes(moment_default()(date).day())||moment_default()(date).month()!==month)&&!(0,common/* isDateGreaterThan */.uh)(new Date(),date)){onCellClick(recordId?"edit":"new",date,recordId);}},style:{width:'100%',height:'8vh',cursor:!(holidays.includes(moment_default()(date).day())||moment_default()(date).month()!==month)&&!(0,common/* isDateGreaterThan */.uh)(new Date(),date)?'pointer':'not-allowed',fontSize:'var(--font-size-lg)',fontWeight:'600'},children:label});}}},localizer:localizer,date:year&&month?new Date("".concat(year,"/").concat(month+1,"/01")):new Date(),defaultView:"month",events:events,style:{height:"70vh",color:'var(--color-dark-main)'},views:["month"],dayPropGetter:dayPropGetter,toolbar:false}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{alignSelf:'flex-start'},children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{style:{border:'1px solid var(--color-border)',display:'flex',padding:'0.5rem',gap:'0.5rem',alignItems:'flex-start'},children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{style:{display:'flex',gap:'0.5rem',fontSize:'var(--font-size-sm)'},children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{width:'1rem',height:'1rem',backgroundColor:'rgba(247,5,5, 0.4)',borderRadius:'50%'}}),/*#__PURE__*/(0,jsx_runtime.jsx)("p",{style:{margin:0},children:"Absent"})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{style:{display:'flex',gap:'0.5rem',fontSize:'var(--font-size-sm)'},children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{width:'1rem',height:'1rem',backgroundColor:'rgba(255, 140, 0, 0.6)',borderRadius:'50%'}}),/*#__PURE__*/(0,jsx_runtime.jsx)("p",{style:{margin:0},children:"Incomplete hours"})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{style:{display:'flex',gap:'0.5rem',fontSize:'var(--font-size-sm)',alignSelf:'flex-start'},children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{width:'1rem',height:'1rem',backgroundColor:'rgba(245,188,2, 0.4)',borderRadius:'50%'}}),/*#__PURE__*/(0,jsx_runtime.jsx)("p",{style:{margin:0},children:"Late"})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{style:{display:'flex',gap:'0.5rem',fontSize:'var(--font-size-sm)',alignSelf:'flex-start'},children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{width:'1rem',height:'1rem',backgroundColor:'var(--color-light-50)',borderRadius:'50%'}}),/*#__PURE__*/(0,jsx_runtime.jsx)("p",{style:{margin:0},children:"Weekend"})]})]})})]});};/* harmony default export */ const Calendar = (CalendarComponent);
// EXTERNAL MODULE: ./node_modules/react-router-dom/dist/index.js
var dist = __webpack_require__(42074);
// EXTERNAL MODULE: ./src/helpers/dateHandler.ts
var dateHandler = __webpack_require__(98933);
// EXTERNAL MODULE: ./src/services/tokenService.ts
var tokenService = __webpack_require__(92966);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/wrapRegExp.js
var wrapRegExp = __webpack_require__(36140);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js
var objectWithoutProperties = __webpack_require__(80045);
// EXTERNAL MODULE: ./node_modules/antd/es/modal/index.js + 7 modules
var modal = __webpack_require__(32645);
;// ./src/Components/Organisms/Dashboard/Attendance/Export/styles.module.scss
// extracted by mini-css-extract-plugin
/* harmony default export */ const Export_styles_module = ({"date_picker":"styles_date_picker__Fks-y","date_footer":"styles_date_footer__MnwBg"});
// EXTERNAL MODULE: ./src/Components/Atoms/Select/index.tsx + 1 modules
var Select = __webpack_require__(39590);
// EXTERNAL MODULE: ./src/helpers/options.ts
var options = __webpack_require__(59179);
;// ./src/Modules/Attendance/types.ts
let ReportType=/*#__PURE__*/function(ReportType){ReportType["all"]="all";ReportType["users"]="users";ReportType["department"]="department";ReportType["organization"]="organization";return ReportType;}({});
// EXTERNAL MODULE: ./src/Modules/Department/index.ts
var Department = __webpack_require__(98924);
// EXTERNAL MODULE: ./src/Modules/Organization/index.ts
var Organization = __webpack_require__(42361);
;// ./src/Components/Organisms/Dashboard/Attendance/Export/index.tsx
const _excluded=["date_range"];const{RangePicker}=date_picker/* default */.A;const datePresets=[{text:'This Month',value:[moment_default()().startOf('month'),moment_default()().endOf('month')]},{text:'Last Month',value:[moment_default()().subtract(1,'month').startOf('month'),moment_default()().subtract(1,'month').endOf('month')]}];const AttendanceExport=props=>{var _users$data,_departments$data,_organizations$data;const{isModalOpen,setIsModalOpen}=props;const[form]=es_form/* default */.A.useForm();const[reportType,setReportType]=(0,react.useState)("all");const[dateOpen,setDateOpen]=(0,react.useState)(false);const[isLoading,setIsLoading]=(0,react.useState)(false);const module=(0,react.useMemo)(()=>new Attendance/* AttendanceModule */.E(),[]);const usersModule=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const departmentModule=(0,react.useMemo)(()=>new Department/* DepartmentModule */.d(),[]);const organizationModule=(0,react.useMemo)(()=>new Organization/* OrganizationModule */.I(),[]);const[usersTerm,setUserTerms]=(0,react.useState)("");const[users,setUsers]=(0,react.useState)({loading:false,data:[]});const debouncedUsersTerm=(0,useDebounce/* useDebounce */.d)(usersTerm,500);const[departments,setDepartments]=(0,react.useState)({loading:false,data:[]});const[organizations,setOrganizations]=(0,react.useState)({loading:false,data:[]});const onSubmit=async values=>{const{date_range}=values,rest=(0,objectWithoutProperties/* default */.A)(values,_excluded);try{let params=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},rest),{},{fromDate:new Date((date_range===null||date_range===void 0?void 0:date_range[0].toISOString())||""),toDate:new Date((date_range===null||date_range===void 0?void 0:date_range[1].toISOString())||"")});setIsLoading(true);const response=await module.generateReport(params);const disposition=response.headers['content-disposition'];const matches=/*#__PURE__*/(0,wrapRegExp/* default */.A)(/filename=(.*)/,{filename:1}).exec(disposition);const filename=matches&&matches.groups&&matches.groups.filename?matches.groups.filename:'downloaded_file.xlsx';message/* default */.Ay.success("Report downloaded successfully");const url=window.URL.createObjectURL(new Blob([response.data]));const a=document.createElement('a');a.href=url;a.download=filename;document.body.appendChild(a);a.click();document.body.removeChild(a);window.URL.revokeObjectURL(url);}catch(error){const errorMessage=(0,common/* handleError */.H4)(error);message/* default */.Ay.error(errorMessage||"Something went wrong while downloading the file");}finally{setIsLoading(false);}};const GetUsers=name=>{setUsers(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:true}));const{getAllRecords}=usersModule;getAllRecords({name}).then(res=>{const{data}=res.data;setUsers(prev=>{// if the data is already present in the state, then don't add it again
const filteredData=data===null||data===void 0?void 0:data.filter(item=>{return!(prev!==null&&prev!==void 0&&prev.data.find(prevItem=>(prevItem===null||prevItem===void 0?void 0:prevItem.id)===item.id));});// add the new data to the existing data
return{data:[...prev.data,...filteredData],loading:false};});}).catch(err=>{const errorMessage=(0,common/* handleError */.H4)(err);message/* default */.Ay.error(errorMessage||"Something went wrong");setUsers(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:false}));});};const GetDepartments=(0,react.useCallback)(()=>{setDepartments(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:true}));const{getAllRecords}=departmentModule;getAllRecords().then(res=>{const data=res.data.data;setDepartments(prev=>{// if the data is already present in the state, then don't add it again
const filteredData=data===null||data===void 0?void 0:data.filter(item=>{return!(prev!==null&&prev!==void 0&&prev.data.find(prevItem=>(prevItem===null||prevItem===void 0?void 0:prevItem.id)===item.id));});// add the new data to the existing data
return{data:[...prev.data,...filteredData],loading:false};});}).catch(err=>{const errorMessage=(0,common/* handleError */.H4)(err);message/* default */.Ay.error(errorMessage||"Something went wrong");setDepartments(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:false}));});},[departmentModule]);const GetOrganizations=(0,react.useCallback)(()=>{setOrganizations(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:true}));const{getAllRecords}=organizationModule;getAllRecords().then(res=>{const{data}=res===null||res===void 0?void 0:res.data;setOrganizations(prev=>{// if the data is already present in the state, then don't add it again
const filteredData=data===null||data===void 0?void 0:data.filter(item=>{return!(prev!==null&&prev!==void 0&&prev.data.find(prevItem=>(prevItem===null||prevItem===void 0?void 0:prevItem.id)===item.id));});// add the new data to the existing data
return{data:[...prev.data,...filteredData],loading:false};});}).catch(err=>{const errorMessage=(0,common/* handleError */.H4)(err);message/* default */.Ay.error(errorMessage||"Something went wrong");setOrganizations(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:false}));});},[organizationModule]);const handleReportTypeChange=(0,react.useCallback)(reportType=>{setReportType(reportType);if(reportType===ReportType.department&&departments.data.length===0){GetDepartments();}if(reportType===ReportType.organization&&organizations.data.length===0){GetOrganizations();}},[GetDepartments,GetOrganizations,departments.data.length,organizations.data.length]);(0,react.useEffect)(()=>{if(debouncedUsersTerm!==""){GetUsers(debouncedUsersTerm);}},[debouncedUsersTerm]);return/*#__PURE__*/(0,jsx_runtime.jsx)(modal/* default */.A,{title:"Export to Excel",open:isModalOpen,onCancel:()=>setIsModalOpen(false),okText:"Export",okButtonProps:{form:"export_form",htmlType:"submit",loading:isLoading},children:/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{layout:"vertical",form:form,onFinish:onSubmit,name:"export_form",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"date_range",label:"Date Range",requiredMark:"optional",rules:[{required:true,message:'Please select a date range'}],style:{marginBottom:0},children:/*#__PURE__*/(0,jsx_runtime.jsx)(RangePicker,{className:Export_styles_module.date_picker,open:dateOpen,onOpenChange:open=>setDateOpen(open),renderExtraFooter:()=>/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:Export_styles_module.date_footer,children:[datePresets.map((preset,index)=>/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{type:"ghost",size:"small",onClick:()=>{var _preset$value,_preset$value2;const fromDate=preset===null||preset===void 0?void 0:(_preset$value=preset.value)===null||_preset$value===void 0?void 0:_preset$value[0];const toDate=preset===null||preset===void 0?void 0:(_preset$value2=preset.value)===null||_preset$value2===void 0?void 0:_preset$value2[1];form.setFieldsValue({date_range:[fromDate,toDate]});},children:preset.text},"date_preset_".concat(index))),/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{style:{marginRight:0,marginLeft:"auto"},type:"primary",onClick:()=>setDateOpen(false),children:"Ok"})]})})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"reportType",requiredMark:"optional",style:{marginBottom:0},rules:[{required:true,message:'Please select a report type'}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Select/* default */.A,{label:"Report Type",options:(0,options/* getOptionsFromEnum */.uf)(ReportType).map(item=>({label:(0,common/* capitalize */.ZH)(item===null||item===void 0?void 0:item.label),value:item===null||item===void 0?void 0:item.value})),value:reportType,onChange:reportType=>handleReportTypeChange(reportType)})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"mt-3",children:[reportType===ReportType.users&&/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"userIds",requiredMark:"optional",rules:[{required:true,message:'Please select a user'}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* SelectWithSearch */.fd,{asterisk:false,label:"Users",loading:users===null||users===void 0?void 0:users.loading,mode:"multiple",options:users===null||users===void 0?void 0:(_users$data=users.data)===null||_users$data===void 0?void 0:_users$data.map(user=>({label:"".concat(user===null||user===void 0?void 0:user.firstName," ").concat(user===null||user===void 0?void 0:user.lastName),value:"".concat(user===null||user===void 0?void 0:user.id)})),onSearch:value=>setUserTerms(value),notFoundDescription:"".concat(usersTerm&&!users.loading?"No employees found, modify your search and try again":"Search for employees to generate report for")})}),reportType===ReportType.department&&/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"departmentId",requiredMark:"optional",rules:[{required:true,message:'Please select a department'}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* SelectWithSearch */.fd,{asterisk:false,label:"Departments",loading:departments===null||departments===void 0?void 0:departments.loading,options:departments===null||departments===void 0?void 0:(_departments$data=departments.data)===null||_departments$data===void 0?void 0:_departments$data.map(department=>({label:department===null||department===void 0?void 0:department.title,value:"".concat(department===null||department===void 0?void 0:department.id)})),onSearch:()=>{}})})]}),reportType===ReportType.organization&&/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"organizationId",requiredMark:"optional",rules:[{required:true,message:'Please select an organization'}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* SelectWithSearch */.fd,{asterisk:false,label:"Organizations",loading:organizations===null||organizations===void 0?void 0:organizations.loading,options:organizations===null||organizations===void 0?void 0:(_organizations$data=organizations.data)===null||_organizations$data===void 0?void 0:_organizations$data.map(organization=>({label:organization===null||organization===void 0?void 0:organization.name,value:"".concat(organization===null||organization===void 0?void 0:organization.id)})),onSearch:()=>{}})})]})});};/* harmony default export */ const Export = (AttendanceExport);
;// ./src/Components/Organisms/Dashboard/Attendance/index.tsx
const{MonthPicker,YearPicker}=date_picker/* default */.A;const breadCrumbsData=[{text:"Home",isLink:true,path:"/"},{isLink:false,text:"Attendance"}];function Attendance_Attendance(){var _localStorage;const[searchParams,setSearchParams]=(0,dist/* useSearchParams */.ok)();const user=tokenService/* default */.A.getUserData();const[selectedCellDate,setSelectedCellDate]=(0,react.useState)();// available permissions for this module
const permissionSlug=(0,common/* getPermissionSlugs */.AH)(Attendance_permissions/* AttendancePermissionSet */.R);const{userPermissions}=(0,es/* useSelector */.d4)(state=>state.usersReducer);const permissions=userPermissions;const{readAttendance,createAttendance,updateAttendance,readAllAttendance}=permissions;const[attendanceViewAs,setAttendanceViewAs]=(0,react.useState)(()=>{const viewAs=localStorage.getItem("attendanceViewAs");if(viewAs==="calendar"){return"calendar";}return"table";});// Function to handle view as change
const onViewAsChange=value=>{localStorage.setItem("attendanceViewAs",value);};const[currentEditType,setcurrentEditType]=(0,react.useState)({editType:"new",recordId:0,openModal:false});const[isModalOpen,setIsModalOpen]=(0,react.useState)(false);const[excelData,setExcelData]=(0,react.useState)([]);const[calendarFilters,setCalendarFilters]=(0,react.useState)({type:undefined,year:Number(searchParams.get("year"))||moment_default()(new Date()).year(),month:Number(searchParams.get("month"))||moment_default()(new Date()).month(),userId:localStorage.getItem("attendanceUser")?readAllAttendance?Number(JSON.parse(((_localStorage=localStorage)===null||_localStorage===void 0?void 0:_localStorage.getItem("attendanceUser"))||"")):user.id:user.id});const module=new Attendance/* AttendanceModule */.E();const{data,onRefresh,setData,loading}=(0,hooks/* useFetchData */.Gs)({method:module.getUserAttendance,initialQuery:calendarFilters});const onCancelClick=()=>{if(createAttendance===false){message/* default */.Ay.error("You don't have permission to create new record");return;}setcurrentEditType((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},currentEditType),{},{openModal:!currentEditType.openModal,editType:"new"}));};const onCellClick=(editType,date,id)=>{if(updateAttendance===false){message/* default */.Ay.error("You don't have permission to update this record");return;}if(id)setcurrentEditType((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},currentEditType),{},{editType:editType,recordId:id,openModal:true}));else{setcurrentEditType({editType:"new",recordId:0,openModal:true});}if(date){setSelectedCellDate(new Date(date).toISOString());}};//user search
const[searchTermUser,setSearchTermUser]=(0,react.useState)("");const debouncedSearchTermUser=(0,useDebounce/* useDebounce */.d)(searchTermUser,500);const[users,setUsers]=(0,react.useState)([]);const userModule=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const onUserSearch=(0,react.useCallback)(()=>{if(debouncedSearchTermUser){userModule.getAllRecords({name:debouncedSearchTermUser}).then(res=>{setUsers(prev=>{var _res$data,_res$data$data;// if the data is already present in the state, then don't add it again
const filteredData=res===null||res===void 0?void 0:(_res$data=res.data)===null||_res$data===void 0?void 0:(_res$data$data=_res$data.data)===null||_res$data$data===void 0?void 0:_res$data$data.filter(item=>{return!(prev!==null&&prev!==void 0&&prev.find(prevItem=>prevItem.id===item.id));});// add the new data to the existing data
return[...prev,...filteredData];});}).catch(err=>{message/* default */.Ay.error(err.response.data.message);});}else if(calendarFilters.userId){userModule.getRecordById(calendarFilters.userId).then(res=>{var _res$data2;setUsers([res===null||res===void 0?void 0:(_res$data2=res.data)===null||_res$data2===void 0?void 0:_res$data2.data]);}).catch(err=>{message/* default */.Ay.error(err.response.data.message);});}},[debouncedSearchTermUser]);(0,react.useEffect)(()=>{onUserSearch();},[onUserSearch,calendarFilters.userId]);const getExcelData=(0,react.useCallback)(()=>{if(data&&data.attendanceData.length>0){const _data=data===null||data===void 0?void 0:data.attendanceData.map(item=>{return{date:(0,dateHandler/* convertDate */.ic)(item===null||item===void 0?void 0:item.day,"dd MM,yy"),day:dateHandler/* weekDays */.Mq[new Date(item.day).getDay()],hours:item===null||item===void 0?void 0:item.hoursWorked,status:(0,common/* capitalize */.ZH)(commonEnums/* AttendanceStatus */.qg[item.status]),proRatedDeduction:item.proRatedDeduction,note:item.note};});setExcelData(_data);}},[data]);(0,react.useEffect)(()=>{getExcelData();},[getExcelData]);// headers for the excel export
const headers=[{label:"Date",key:"date"},{label:"Day",key:"day"},{label:"Hours",key:"hours"},{label:"Status",key:"status"},{label:"Pro Rated Deduction",key:"proRatedDeduction"},{label:"Note",key:"note"}];return/*#__PURE__*/(0,jsx_runtime.jsxs)(Layout/* default */.A,{permissionSlug:permissionSlug,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* PageHeader */.zY,{heading:"Attendance",buttonText:"Add Attendance",onButtonClick:onCancelClick,breadCrumbData:breadCrumbsData,showAdd:createAttendance===true?true:false,excelExport:/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{style:{marginRight:15,display:"flex",alignItems:"center"},onClick:()=>setIsModalOpen(true),icon:/*#__PURE__*/(0,jsx_runtime.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"none",viewBox:"0 0 24 24",className:"mr-1",children:/*#__PURE__*/(0,jsx_runtime.jsx)("path",{fill:"#42526E",d:"M16.19 2H7.81C4.17 2 2 4.17 2 7.81v8.37C2 19.83 4.17 22 7.81 22h8.37c3.64 0 5.81-2.17 5.81-5.81V7.81C22 4.17 19.83 2 16.19 2zm1.06 10.33c0 .41-.34.75-.75.75s-.75-.34-.75-.75V9.31l-7.72 7.72c-.15.15-.34.22-.53.22s-.38-.07-.53-.22a.754.754 0 010-1.06l7.72-7.72h-3.02c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h4.83c.41 0 .75.34.75.75v4.83z"})}),children:"Export to Excel"}),filters:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_select/* default */.A,{allowClear:true,placeholder:"Search for the employee",className:"selectAntdCustom",disabled:readAllAttendance?false:true,onChange:value=>{const _tempCalendar=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},calendarFilters),{},{userId:value});setCalendarFilters(_tempCalendar);if(value){localStorage.setItem("attendanceUser",String(value));onRefresh(_tempCalendar);}else{localStorage.removeItem("attendanceUser");setData(undefined);}// !shouldFetch && setShoudFetch(true);
},value:calendarFilters.userId?calendarFilters.userId:undefined,showSearch:true,onSearch:value=>setSearchTermUser(value),optionFilterProp:"label",options:users===null||users===void 0?void 0:users.map(item=>{return{label:item.firstName+" "+item.lastName,value:item.id};}),notFoundContent:/*#__PURE__*/(0,jsx_runtime.jsx)(empty/* default */.A,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:"No data found, Please search for the employee"})})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)("label",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(MonthPicker,{onChange:value=>{const selectedMonth=value===null||value===void 0?void 0:value.month();const selectedYear=calendarFilters.year?calendarFilters.year:moment_default()(new Date()).year();const _temp=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},calendarFilters),{},{month:selectedMonth,year:selectedYear});setCalendarFilters(_temp);onRefresh(_temp);if(selectedMonth){searchParams.set("month",selectedMonth.toString());}else if(selectedMonth===0){searchParams.set("month","0");}searchParams.set('year',selectedYear.toString());setSearchParams(searchParams);},className:Attendance_styles_module.monthPicker,suffixIcon:/*#__PURE__*/(0,jsx_runtime.jsx)(DownOutlined/* default */.A,{}),clearIcon:false,format:"MMMM",placeholder:"Month",value:calendarFilters.month!==undefined&&calendarFilters.month!==null?moment_default()(new Date()).month(calendarFilters.month):undefined})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)("label",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(YearPicker,{onChange:value=>{const selectedYear=value===null||value===void 0?void 0:value.year();const _temp=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},calendarFilters),{},{year:selectedYear});setCalendarFilters(_temp);onRefresh(_temp);selectedYear&&searchParams.set('year',selectedYear.toString());setSearchParams(searchParams);},placeholder:"Year",className:Attendance_styles_module.yearPicker,suffixIcon:/*#__PURE__*/(0,jsx_runtime.jsx)(DownOutlined/* default */.A,{}),clearIcon:false,value:calendarFilters.year?moment_default()(new Date()).year(calendarFilters.year):undefined,disabledDate:date=>date>moment_default()(new Date())})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:Attendance_styles_module.view_as,style:{overflow:"auto"},children:/*#__PURE__*/(0,jsx_runtime.jsx)(segmented/* default */.A,{options:[{label:'Table',value:'table',icon:/*#__PURE__*/(0,jsx_runtime.jsx)(BarsOutlined/* default */.A,{})},{label:'Calendar',value:'calendar',icon:/*#__PURE__*/(0,jsx_runtime.jsx)(CalendarOutlined/* default */.A,{})}],onChange:value=>{setAttendanceViewAs(value);onViewAsChange(value);},value:attendanceViewAs})})]})}),readAttendance===true&&attendanceViewAs==="table"&&/*#__PURE__*/(0,jsx_runtime.jsx)(table_columns/* default */.A,{tableData:data?data:{},tableLoading:loading,onEditIconClick:onCellClick,reloadTableData:()=>onRefresh(calendarFilters),emptyText:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomEmpty */.ZX,{description:calendarFilters.userId?"No records found":"Please select an employee to get started"})}),readAttendance===true&&attendanceViewAs==="calendar"&&(calendarFilters.month||calendarFilters.month===0)&&calendarFilters.year&&(data?/*#__PURE__*/(0,jsx_runtime.jsx)(Calendar,{onCellClick:onCellClick,data:data,month:calendarFilters.month,year:calendarFilters.year}):/*#__PURE__*/(0,jsx_runtime.jsx)(empty/* default */.A,{description:"Please select an employee to get started"})),readAttendance===false&&/*#__PURE__*/(0,jsx_runtime.jsx)(ErrorCodes/* ErrorCode403 */.$t,{mainMessage:"You don't have permission to view this data"}),currentEditType.openModal&&/*#__PURE__*/(0,jsx_runtime.jsx)(AttendanceModal,{record:currentEditType.recordId,type:currentEditType.editType,reloadTableData:()=>onRefresh(calendarFilters),onCancel:onCancelClick,openModal:currentEditType.openModal,permissions:permissions,employeeId:calendarFilters.userId,date:selectedCellDate?selectedCellDate:null}),isModalOpen&&/*#__PURE__*/(0,jsx_runtime.jsx)(Export,{isModalOpen:isModalOpen,setIsModalOpen:setIsModalOpen})]});}/* harmony default export */ const Dashboard_Attendance = (Attendance_Attendance);

/***/ }),

/***/ 16457:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ TableComponent)
/* harmony export */ });
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(41821);
/* harmony import */ var _Atoms_Headings__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(35751);
/* harmony import */ var _Common_styles_module_scss__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(96019);
/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(98341);
/* harmony import */ var _helpers_dateHandler__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(98933);
/* harmony import */ var _helpers_common__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(88132);
/* harmony import */ var _helpers_commonEnums__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(2360);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(59051);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(44414);
function TableComponent(props){var _tableData$workingHou,_tableData$workingHou2;const{tableData,tableLoading,onEditIconClick,reloadTableData,emptyText}=props;const{userPermissions}=(0,react_redux__WEBPACK_IMPORTED_MODULE_2__/* .useSelector */ .d4)(state=>state.usersReducer);const permissions=userPermissions;let holidays=[];(_tableData$workingHou=tableData.workingHour)===null||_tableData$workingHou===void 0?void 0:(_tableData$workingHou2=_tableData$workingHou.hours)===null||_tableData$workingHou2===void 0?void 0:_tableData$workingHou2.forEach(ele=>{if(ele.closed){holidays.push(ele.day);}});const columns=[{title:"S.No",dataIndex:"index",key:"index",render:(text,record,index)=>index+1,width:"7.5%"},{title:"Date",dataIndex:"day",key:"day",render:(text,record)=>{var _record$ModifiedBy,_record$ModifiedBy2;return/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Fragment,{children:[/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"d-flex",children:[/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_Atoms_Headings__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A,{className:"cursor-pointer",color:onEditIconClick?"primary-main":"dark-main",size:"sm",weight:"bold",onClick:()=>{if(onEditIconClick)onEditIconClick(record.recordId?"edit":"new",text,record.recordId);},children:(0,_helpers_dateHandler__WEBPACK_IMPORTED_MODULE_7__/* .convertDate */ .ic)(text,"dd M,yy")}),/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("small",{className:"pl-2 color-dark-sub",children:"\n\t\t\t\t\t".concat(record.checkIn?"["+moment__WEBPACK_IMPORTED_MODULE_5___default()(record.checkIn).format("hh:mm A"):"","\n\t\t\t\t\t").concat(record.checkOut?" - "+moment__WEBPACK_IMPORTED_MODULE_5___default()(record.checkOut).format("hh:mm A")+"]":"","\n\t\t\t\t\t")})]}),record.ModifiedBy&&/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("small",{style:{color:'var(--color-dark-sub)',fontSize:"0.6rem"},children:[/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("span",{children:"Modified on "}),/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("span",{children:[" ",record.modifiedDate&&(0,_helpers_dateHandler__WEBPACK_IMPORTED_MODULE_7__/* .convertDate */ .ic)(record.modifiedDate,"dd M,yy")]}),/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("span",{children:" by "}),/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("span",{className:"inline-block",children:((_record$ModifiedBy=record.ModifiedBy)===null||_record$ModifiedBy===void 0?void 0:_record$ModifiedBy.firstName)+" "+((_record$ModifiedBy2=record.ModifiedBy)===null||_record$ModifiedBy2===void 0?void 0:_record$ModifiedBy2.lastName)+" "})]}),/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{})]});},width:"250px"},{title:"Day",dataIndex:"day",key:"day",render:text=>/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_Atoms_Headings__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A,{color:"dark-main",size:"sm",weight:"bold",children:_helpers_dateHandler__WEBPACK_IMPORTED_MODULE_7__/* .weekDays */ .Mq[new Date(text).getDay()]})},{title:"Hours worked",dataIndex:"hoursWorked",key:"hoursWorked",render:text=>/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Fragment,{children:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_Atoms_Headings__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A,{color:"dark-main",size:"sm",weight:"bold",children:text?text+" hours":"N/A"})})},{title:"Status",dataIndex:"status",key:"status",render:(text,record)=>/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Fragment,{children:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_Atoms_Headings__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A,{style:{color:_helpers_commonEnums__WEBPACK_IMPORTED_MODULE_4__/* .attendanceStatusColor */ .$g[text-1]},size:"sm",weight:"bold",children:(0,_helpers_common__WEBPACK_IMPORTED_MODULE_3__/* .isDateGreaterThan */ .uh)(new Date(),record.day)?"-":(0,_helpers_common__WEBPACK_IMPORTED_MODULE_3__/* .capitalize */ .ZH)(_helpers_commonEnums__WEBPACK_IMPORTED_MODULE_4__/* .AttendanceStatus */ .qg[text])})})},{title:"Pro Rated Deduction",dataIndex:"proRatedDeduction",key:"proRatedDeduction",render:text=>/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Fragment,{children:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_Atoms_Headings__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A,{color:"dark-main",size:"sm",weight:"bold",children:text})})},{title:"Note",dataIndex:"note",key:"note",render:text=>/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Fragment,{children:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_Atoms_Headings__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A,{color:"dark-main",size:"xs",weight:"normal",children:text})}),width:"200px"},permissions.updateAttendance?{title:"Actions",dataIndex:"actions",key:"actions",render:(text,record)=>permissions.updateAttendance&&!(0,_helpers_common__WEBPACK_IMPORTED_MODULE_3__/* .isDateGreaterThan */ .uh)(new Date(),record.day)&&/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:_Common_styles_module_scss__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A.actions,children:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("span",{onClick:()=>{if(onEditIconClick)onEditIconClick(record.recordId?"edit":"new",record.day,record.recordId);},children:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("img",{src:"/images/editicon.svg",alt:""})})}),width:"100px"}:{}];return/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{style:{maxHeight:"calc(100vh - 80px)",clear:"both",maxWidth:"100%",overflow:"auto"},children:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(antd__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .A,{sticky:true,dataSource:tableData===null||tableData===void 0?void 0:tableData.attendanceData,columns:columns,scroll:{x:991},pagination:false,loading:tableLoading,rowKey:record=>"Attendance-type-".concat(record.day),locale:{emptyText}})});}

/***/ }),

/***/ 33965:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   E: () => (/* binding */ AttendanceModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
class AttendanceModule{constructor(){this.endPoint="attendance";/**Get all Attendance records
     * @param query - query params
     */this.getAllRecords=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint,{params:query});};/**Get Attendance record by id
     * @param id - Attendance id
     */this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/").concat(id));};/**Get Attendance record by id
     * @param id - Attendance id
     */this.getUserAttendance=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint+"/getUserAttendance",{params:query});};/**Get Attendance record by id
     * @param id - Attendance id
     */this.findUserAttendanceForPayroll=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint+"/findUserAttendanceForPayroll",{params:query});};/**Find published Attendance records
     * @param query - query params
     */this.findPublished=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/published"),{params:query});};/**Delete Attendance record
    * @param id - Attendance id
    */this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete("".concat(this.endPoint,"/").concat(id));};/**Create new Attendance record
     * @param data - Attendance data
     */this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint,data);};/**Update Attendance record
    * @param data - Attendance data
    * @param id - Attendance id
    */this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch("".concat(this.endPoint,"/").concat(id),data);};this.generateReport=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post("".concat(this.endPoint,"/generateReport"),data,{responseType:'blob'});};}}

/***/ }),

/***/ 98924:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   d: () => (/* binding */ DepartmentModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
class DepartmentModule{constructor(){this.endPoint="department";this.getAllRecords=queryData=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint,{params:queryData});};this.getAllPublishedRecords=queryData=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint+"/find-published",{params:queryData});};this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint+"/"+id);};this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete(this.endPoint+"/"+id);};this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint,data);};this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch(this.endPoint+"/"+id,data);};}}

/***/ }),

/***/ 42361:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   I: () => (/* binding */ OrganizationModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
/* harmony import */ var _modules_Common_config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(21073);
class OrganizationModule{constructor(){this.endPoint="organization";/**Get all organization records
     * @param query - query params
     */this.getAllRecords=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint,{params:query});};/**Get all organization records
     * @param query - query params
     */this.findPublished=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint+"/find-published",{params:query});};/**Get organization record by id
     * @param id - organization id
     */this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/").concat(id));};/**Delete organization record
    * @param id - organization id
    */this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete("".concat(this.endPoint,"/").concat(id));};/**Create new organization record
     * @param data - organization data
     */this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint,data,{headers:_modules_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};/**Update organization record
    * @param data - organization data
    * @param id - organization id
    */this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch("".concat(this.endPoint,"/").concat(id),data,{headers:_modules_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};this.getTenants=()=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("xero/getTenants");};}}

/***/ }),

/***/ 59179:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Fq: () => (/* binding */ TransactionStatusOptions),
/* harmony export */   GV: () => (/* binding */ ClientStatusOptions),
/* harmony export */   jD: () => (/* binding */ QuotationTypeOptions),
/* harmony export */   ln: () => (/* binding */ FinanceStatusOptions),
/* harmony export */   uf: () => (/* binding */ getOptionsFromEnum),
/* harmony export */   yB: () => (/* binding */ PaymentScheduleOptions)
/* harmony export */ });
/* harmony import */ var _commonEnums__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(2360);
/** Used to get options from enum object */const getOptionsFromEnum=enumObject=>{const enumEntries=Object.entries(enumObject);const options=enumEntries.filter(_ref=>{let[key]=_ref;return isNaN(Number(key));}).map(_ref2=>{let[key,value]=_ref2;return{label:key,value:value};});return options;};/** Finance Status Options */const FinanceStatusOptions=getOptionsFromEnum(_commonEnums__WEBPACK_IMPORTED_MODULE_0__/* .PermitFinanceStatus */ .cY);/** Client Status Options */const ClientStatusOptions=getOptionsFromEnum(_commonEnums__WEBPACK_IMPORTED_MODULE_0__/* .PermitClientStatus */ .Vn);/** Government Transaction Status Options */const TransactionStatusOptions=getOptionsFromEnum(_commonEnums__WEBPACK_IMPORTED_MODULE_0__/* .TransactionStatus */ .x8);/** Quotation Type Options */const QuotationTypeOptions=getOptionsFromEnum(_commonEnums__WEBPACK_IMPORTED_MODULE_0__/* .QuotationTypeEnum */ .eE);/** Supervision Payment Schedule Options */const PaymentScheduleOptions=getOptionsFromEnum(_commonEnums__WEBPACK_IMPORTED_MODULE_0__/* .SupervisionPaymentSchedule */ .ve);

/***/ })

}]);