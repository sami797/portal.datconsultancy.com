"use strict";
(self["webpackChunkdat_projects"] = self["webpackChunkdat_projects"] || []).push([[2293],{

/***/ 30386:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(89379);
/* harmony import */ var C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(80045);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(9950);
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(16330);
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(81541);
/* harmony import */ var _ant_design_icons__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(9494);
/* harmony import */ var _input_module_scss__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(16835);
/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(44414);
const _excluded=["label","hint","asterisk","helperText","className"];const{TextArea}=antd__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A;const CustomTextArea=/*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)((props,ref)=>{const{label,hint,asterisk,helperText,className}=props,rest=(0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .A)(props,_excluded);return/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:[label?/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("label",{className:_input_module_scss__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A.labelWrap,children:[/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{children:label}),hint?/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(antd__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .A,{title:hint,children:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_ant_design_icons__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .A,{})}):null,asterisk?/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{className:_input_module_scss__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A.asterisk,children:"*"}):null]}):null,/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(TextArea,(0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .A)((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .A)({ref:ref},rest),{},{className:"".concat(_input_module_scss__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A["inpt"]," ").concat(className)})),helperText?/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("small",{className:_input_module_scss__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A.helperText,children:helperText}):null]});});CustomTextArea.defaultProps={autoSize:{minRows:4},placeholder:"Enter text here",asterisk:false,hint:""};/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (CustomTextArea);

/***/ }),

/***/ 32293:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ Organisms_Enquiries)
});

// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js
var objectSpread2 = __webpack_require__(89379);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(9950);
// EXTERNAL MODULE: ./node_modules/antd/es/message/index.js + 1 modules
var message = __webpack_require__(92759);
// EXTERNAL MODULE: ./node_modules/antd/es/segmented/index.js + 2 modules
var segmented = __webpack_require__(84649);
// EXTERNAL MODULE: ./node_modules/react-redux/es/index.js + 21 modules
var es = __webpack_require__(98341);
// EXTERNAL MODULE: ./src/Components/Templates/Layout/index.tsx + 28 modules
var Layout = __webpack_require__(81168);
// EXTERNAL MODULE: ./src/hooks/index.ts + 5 modules
var hooks = __webpack_require__(91970);
// EXTERNAL MODULE: ./src/Modules/Enquiry/index.ts
var Enquiry = __webpack_require__(81471);
// EXTERNAL MODULE: ./src/Modules/Enquiry/permissions.ts
var Enquiry_permissions = __webpack_require__(78475);
// EXTERNAL MODULE: ./src/Modules/ProjectType/index.ts
var ProjectType = __webpack_require__(12975);
// EXTERNAL MODULE: ./src/Components/Atoms/ErrorCodes/index.tsx + 1 modules
var ErrorCodes = __webpack_require__(36250);
// EXTERNAL MODULE: ./src/Components/Atoms/index.tsx + 12 modules
var Atoms = __webpack_require__(9394);
// EXTERNAL MODULE: ./src/Components/Atoms/CustomFilter/more.tsx
var more = __webpack_require__(38714);
// EXTERNAL MODULE: ./src/helpers/useDebounce.ts
var useDebounce = __webpack_require__(28173);
// EXTERNAL MODULE: ./src/helpers/commonEnums.ts
var commonEnums = __webpack_require__(2360);
// EXTERNAL MODULE: ./src/helpers/common.ts
var common = __webpack_require__(88132);
// EXTERNAL MODULE: ./src/helpers/dateHandler.ts
var dateHandler = __webpack_require__(98933);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js
var objectWithoutProperties = __webpack_require__(80045);
// EXTERNAL MODULE: ./node_modules/antd/es/form/index.js + 18 modules
var es_form = __webpack_require__(10678);
// EXTERNAL MODULE: ./node_modules/antd/es/drawer/index.js + 6 modules
var drawer = __webpack_require__(73780);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/extends.js
var esm_extends = __webpack_require__(58168);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/typeof.js
var esm_typeof = __webpack_require__(82284);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 1 modules
var slicedToArray = __webpack_require__(5544);
// EXTERNAL MODULE: ./node_modules/classnames/index.js
var classnames = __webpack_require__(48383);
var classnames_default = /*#__PURE__*/__webpack_require__.n(classnames);
// EXTERNAL MODULE: ./node_modules/rc-util/es/Children/toArray.js
var toArray = __webpack_require__(50604);
// EXTERNAL MODULE: ./node_modules/rc-util/es/omit.js
var omit = __webpack_require__(15207);
// EXTERNAL MODULE: ./node_modules/antd/es/config-provider/context.js
var context = __webpack_require__(5741);
// EXTERNAL MODULE: ./node_modules/antd/es/select/index.js + 30 modules
var es_select = __webpack_require__(97554);
// EXTERNAL MODULE: ./node_modules/antd/es/_util/reactNode.js
var reactNode = __webpack_require__(39156);
;// ./node_modules/antd/es/auto-complete/index.js



/**
 * TODO: 4.0
 *
 * - Remove `dataSource`
 * - `size` not work with customizeInput
 * - CustomizeInput not feedback `ENTER` key since accessibility enhancement
 */








var Option = es_select/* default */.A.Option;
function isSelectOptionOrSelectOptGroup(child) {
  return child && child.type && (child.type.isSelectOption || child.type.isSelectOptGroup);
}
var AutoComplete = function AutoComplete(props, ref) {
  var customizePrefixCls = props.prefixCls,
    className = props.className,
    popupClassName = props.popupClassName,
    dropdownClassName = props.dropdownClassName,
    children = props.children,
    dataSource = props.dataSource;
  var childNodes = (0,toArray/* default */.A)(children);
  // ============================= Input =============================
  var customizeInput;
  if (childNodes.length === 1 && (0,reactNode/* isValidElement */.zO)(childNodes[0]) && !isSelectOptionOrSelectOptGroup(childNodes[0])) {
    var _childNodes = (0,slicedToArray/* default */.A)(childNodes, 1);
    customizeInput = _childNodes[0];
  }
  var getInputElement = customizeInput ? function () {
    return customizeInput;
  } : undefined;
  // ============================ Options ============================
  var optionChildren;
  // [Legacy] convert `children` or `dataSource` into option children
  if (childNodes.length && isSelectOptionOrSelectOptGroup(childNodes[0])) {
    optionChildren = children;
  } else {
    optionChildren = dataSource ? dataSource.map(function (item) {
      if ((0,reactNode/* isValidElement */.zO)(item)) {
        return item;
      }
      switch ((0,esm_typeof/* default */.A)(item)) {
        case 'string':
          return /*#__PURE__*/react.createElement(Option, {
            key: item,
            value: item
          }, item);
        case 'object':
          {
            var optionValue = item.value;
            return /*#__PURE__*/react.createElement(Option, {
              key: optionValue,
              value: optionValue
            }, item.text);
          }
        default:
           false ? 0 : void 0;
          return undefined;
      }
    }) : [];
  }
   false ? 0 : void 0;
   false ? 0 : void 0;
   false ? 0 : void 0;
  return /*#__PURE__*/react.createElement(context/* ConfigConsumer */.TG, null, function (_ref) {
    var getPrefixCls = _ref.getPrefixCls;
    var prefixCls = getPrefixCls('select', customizePrefixCls);
    return /*#__PURE__*/react.createElement(es_select/* default */.A, (0,esm_extends/* default */.A)({
      ref: ref
    }, (0,omit/* default */.A)(props, ['dataSource']), {
      prefixCls: prefixCls,
      popupClassName: popupClassName || dropdownClassName,
      className: classnames_default()("".concat(prefixCls, "-auto-complete"), className),
      mode: es_select/* default */.A.SECRET_COMBOBOX_MODE_DO_NOT_USE
    }, {
      // Internal api
      getInputElement: getInputElement
    }), optionChildren);
  });
};
var RefAutoComplete = /*#__PURE__*/react.forwardRef(AutoComplete);
RefAutoComplete.Option = Option;
/* harmony default export */ const auto_complete = (RefAutoComplete);
// EXTERNAL MODULE: ./node_modules/antd/es/input/index.js + 5 modules
var input = __webpack_require__(16330);
// EXTERNAL MODULE: ./node_modules/antd/es/image/index.js + 13 modules
var es_image = __webpack_require__(9206);
// EXTERNAL MODULE: ./node_modules/antd/es/tooltip/index.js
var tooltip = __webpack_require__(81541);
// EXTERNAL MODULE: ./node_modules/antd/es/popconfirm/index.js + 1 modules
var popconfirm = __webpack_require__(56231);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/CloudDownloadOutlined.js + 1 modules
var CloudDownloadOutlined = __webpack_require__(40841);
// EXTERNAL MODULE: ./src/helpers/error-handler.ts
var error_handler = __webpack_require__(38266);
// EXTERNAL MODULE: ./src/Components/Atoms/ServerErrorHandler/index.tsx
var ServerErrorHandler = __webpack_require__(13321);
// EXTERNAL MODULE: ./src/Components/Atoms/ErrorAlert/index.tsx
var ErrorAlert = __webpack_require__(96002);
// EXTERNAL MODULE: ./src/Components/Organisms/Skeletons/index.tsx
var Skeletons = __webpack_require__(70619);
// EXTERNAL MODULE: ./src/Components/Organisms/Common/styles.module.scss
var styles_module = __webpack_require__(96019);
;// ./src/Components/Organisms/Enquiries/styles.module.scss
// extracted by mini-css-extract-plugin
/* harmony default export */ const Enquiries_styles_module = ({"actions":"styles_actions__cp0Iu","bg__red":"styles_bg__red__Hxg7u","form":"styles_form__xXPW9","footer":"styles_footer__999wy","opacity_6":"styles_opacity_6__kYx+3","dropdown":"styles_dropdown__aLcpT","overlay":"styles_overlay__lVs6A","overlay_item":"styles_overlay_item__ANiqY","overlay_popConfirm":"styles_overlay_popConfirm__gaNHa","disabledButton":"styles_disabledButton__1Wm4Z","message":"styles_message__AJ6dm","notesTitle":"styles_notesTitle__NjffZ","note":"styles_note__DPcsC","qualifyButton":"styles_qualifyButton__q1Eso","status":"styles_status__fyI+x","manage_media_photo":"styles_manage_media_photo__QOLrz","manage_media_photo_image":"styles_manage_media_photo_image__KSGe7","manage_media_photo_content":"styles_manage_media_photo_content__TMuQU","media_photo_actions":"styles_media_photo_actions__wuyDz","phoneCode":"styles_phoneCode__Z8RaV","date_picker":"styles_date_picker__5CFEx","z_index":"styles_z_index__l6lH6","date_footer":"styles_date_footer__OiQAk"});
// EXTERNAL MODULE: ./src/Components/Atoms/Input/textarea.tsx
var Input_textarea = __webpack_require__(30386);
// EXTERNAL MODULE: ./src/Components/Icons/delete.tsx
var Icons_delete = __webpack_require__(32006);
// EXTERNAL MODULE: ./src/helpers/constants.ts
var constants = __webpack_require__(65944);
// EXTERNAL MODULE: ./src/services/tokenService.ts
var tokenService = __webpack_require__(92966);
// EXTERNAL MODULE: ./src/Modules/Country/index.ts
var Country = __webpack_require__(83584);
// EXTERNAL MODULE: ./src/services/axiosInstance.ts
var axiosInstance = __webpack_require__(83365);
// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js
var jsx_runtime = __webpack_require__(44414);
;// ./src/Components/Organisms/Enquiries/drawer.tsx
const _excluded=["note","attachments","phone","phoneCode"];const EnquiriesModal=props=>{var _data$Attachments,_data$Attachments2;const{type,visible,onCancel,onRefresh,recordId,projectTypeData,permissions:{readEnquiry,createEnquiry,updateEnquiry}}=props;const access_token=tokenService/* default */.A.getLocalAccessToken();const[form]=es_form/* default */.A.useForm();const module=(0,react.useMemo)(()=>new Enquiry/* EnquiryModule */.y(),[]);const countryModule=(0,react.useMemo)(()=>new Country/* CountryModule */.j(),[]);const[nameOptions,setNameOptions]=(0,react.useState)([]);// List of names for auto-complete
const[existingNameDetails,setExistingNameDetails]=(0,react.useState)(null);// Initialize with false
const[errors,setErrors]=(0,react.useState)('');const[isSubmitting,setIsSubmitting]=(0,react.useState)(false);const[loadingg,setLoadingg]=(0,react.useState)(false);const condition=(0,react.useMemo)(()=>{if(type==="edit"||type==="attachments"){return readEnquiry&&visible&&recordId>0;}return false;},[type,visible]);// Fetch Data by id
const{data,loading,error,onRefresh:onRefreshDataById}=(0,hooks/* useConditionFetchData */.P6)({method:()=>module.getRecordById(recordId),condition:condition});// Fetch Countries
const{data:countries}=(0,hooks/* useFetchData */.Gs)({method:countryModule.getAllRecords});const titleText=(0,react.useMemo)(()=>{if(type==="new"){return"New Enquiry";}else if(type==="edit"){return"Edit Enquiry";}else if(type==="attachments"){return"Attachments";}},[type]);const handleErrors=err=>{const error=(0,error_handler/* errorHandler */.r)(err);if(typeof error.message=="string"){setErrors(error.message);}else{let errData=(0,ServerErrorHandler/* HandleServerErrors */.p)(error.message,[]);form.setFields(errData);setErrors("");}};const handleAlertClose=()=>setErrors("");const onFinish=values=>{var _attachments$fileList;setIsSubmitting(true);const{note,attachments,phone,phoneCode}=values,rest=(0,objectWithoutProperties/* default */.A)(values,_excluded);const formData=new FormData();// add attachments to form data 
const files=attachments===null||attachments===void 0?void 0:(_attachments$fileList=attachments.fileList)===null||_attachments$fileList===void 0?void 0:_attachments$fileList.map(file=>{return file.originFileObj;});if(files!==null&&files!==void 0&&files.length){for(let i=0;i<files.length;i++){formData.append('files[]',files[i]);}}switch(type){case"new":{const data=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},rest),{},{phoneCode:phoneCode&&phone?String(phoneCode):undefined,phone:phone?String(phone):undefined,slug:"admin-panel-enquiry",source:"manual"});if(createEnquiry===true){module.createRecord(data).then(res=>{const{data}=res===null||res===void 0?void 0:res.data;if(data!==null&&data!==void 0&&data.id){var _data$id;formData.append("enquiryId",data===null||data===void 0?void 0:(_data$id=data.id)===null||_data$id===void 0?void 0:_data$id.toString());if((files===null||files===void 0?void 0:files.length)>0){module.uploadFile(formData).catch(err=>{const errorMessage=(0,common/* handleError */.H4)(err);message/* default */.Ay.error(errorMessage||"Something went wrong while uploading attachments");});}onRefresh({status:commonEnums/* EnquiryStatus */.aQ.Active});onCancel();setIsSubmitting(false);}else{setIsSubmitting(false);message/* default */.Ay.error("Something went wrong");}}).catch(err=>{handleErrors(err);setIsSubmitting(false);});}else{setIsSubmitting(false);message/* default */.Ay.error("You don't have enough permission to create a new enquiry");}break;}case"edit":{if(updateEnquiry===true){const data=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},rest),{},{phoneCode:phoneCode&&phone?String(phoneCode):undefined,phone:phone?String(phone):undefined});module.updateRecord(data,recordId).then(res=>{var _res$data;if(res!==null&&res!==void 0&&(_res$data=res.data)!==null&&_res$data!==void 0&&_res$data.data){onRefresh();}onCancel();setIsSubmitting(false);}).catch(err=>{handleErrors(err);setIsSubmitting(false);});}else{setIsSubmitting(false);message/* default */.Ay.error("You don't have enough permission to update an enquiry");}break;}case"attachments":{if((files===null||files===void 0?void 0:files.length)>0){formData.append("enquiryId",recordId.toString());module.uploadFile(formData).then(()=>{setIsSubmitting(false);onRefreshDataById();onRefresh();// clear attachments
form.setFieldsValue({attachments:null});}).catch(err=>{handleErrors(err);setIsSubmitting(false);});}else{setIsSubmitting(false);message/* default */.Ay.error("Please add attachments");}}}};const onRemoveFile=id=>{module.removeFile(id).then(res=>{var _res$data2;onRefreshDataById();onRefresh();message/* default */.Ay.success((res===null||res===void 0?void 0:(_res$data2=res.data)===null||_res$data2===void 0?void 0:_res$data2.message)||'File removed successfully');});};const fetchNames=async query=>{try{setLoadingg(true);const response=await axiosInstance/* default */.A.get('/enquiry');const{data}=response;// Filter names based on the query
const filteredNames=data.data.filter(enquiry=>enquiry.name.toLowerCase().includes(query.toLowerCase())).map(enquiry=>enquiry.name);setNameOptions(filteredNames);setErrors('');}catch(error){console.error('Error fetching data:',error);// Log error details for debugging
setErrors('Failed to fetch enquiry data.');}finally{setLoadingg(false);}};// Handle name selection from auto-complete
const handleSelect=async name=>{try{setLoadingg(true);const response=await axiosInstance/* default */.A.get('/enquiry');const{data}=response;// Find the selected name details
const selectedName=data.data.find(enquiry=>enquiry.name===name);if(selectedName){setExistingNameDetails(selectedName);}}catch(error){console.error('Error fetching details:',error);// Log error details for debugging
setErrors('Failed to fetch enquiry details.');}finally{setLoadingg(false);}};(0,react.useEffect)(()=>{error&&handleErrors(error);},[error]);(0,react.useEffect)(()=>{if(data){form.setFieldsValue((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},data),{},{name:data===null||data===void 0?void 0:data.name,email:data===null||data===void 0?void 0:data.email,phone:data===null||data===void 0?void 0:data.phone,phoneCode:data===null||data===void 0?void 0:data.phoneCode,message:data===null||data===void 0?void 0:data.message,projectTypeId:data===null||data===void 0?void 0:data.projectTypeId}));}else{form.setFieldValue("phoneCode","971");}},[data]);return/*#__PURE__*/(0,jsx_runtime.jsx)(drawer/* default */.A,{open:visible,onClose:()=>onCancel(),closable:true,title:titleText,destroyOnClose:true,width:window.innerWidth>768?700:"100%",bodyStyle:{padding:"0px 25px"},footer:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:Enquiries_styles_module.footer,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{size:"normal",fontSize:"sm",onClick:onCancel,type:"plain",children:"Cancel"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:isSubmitting,onClick:()=>form.submit(),children:"Submit"})]}),children:loading?/*#__PURE__*/(0,jsx_runtime.jsx)(Skeletons/* default */.A,{items:2}):/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{className:styles_module/* default */.A.form,onFinish:onFinish,form:form,children:[errors&&/*#__PURE__*/(0,jsx_runtime.jsx)(ErrorAlert/* default */.A,{description:errors,isClosable:true,onClose:handleAlertClose}),/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[type!=="attachments"&&/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"name",rules:[{required:true,message:"Please add name"}],validateStatus:existingNameDetails?"success":"",help:existingNameDetails?"":"Name not found",children:/*#__PURE__*/(0,jsx_runtime.jsx)(auto_complete,{options:nameOptions.map(name=>({value:name})),onSearch:fetchNames,onSelect:handleSelect,placeholder:"Enter name",disabled:loading,children:/*#__PURE__*/(0,jsx_runtime.jsx)(input/* default */.A,{size:"large"})})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"phone",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Phone",type:"number",defaultValue:data===null||data===void 0?void 0:data.phone,style:{width:"100%",border:"1px solid transparent"},addonBefore:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"phoneCode",style:{marginBottom:0},initialValue:"971",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomSelect */.Ae,{options:countries===null||countries===void 0?void 0:countries.reverse().map(item=>{return{value:item.phoneCode,label:"".concat(item.flag).concat(item.phoneCode)};}),placeholder:"Select Country",style:{width:90}})})})})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"email",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Email",type:"text"})})]}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"projectTypeId",rules:[{required:true,message:"Please select project type"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomSelect */.Ae,{options:projectTypeData===null||projectTypeData===void 0?void 0:projectTypeData.map(item=>{return{value:item.id,label:item.title};}),placeholder:"Select Project Type",label:"Project Type",asterisk:true})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"message",rules:[{required:true,message:"Please add message"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Input_textarea/* default */.A,{label:"Message",asterisk:true})})})]}),type==="attachments"&&/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[!loading&&(data===null||data===void 0?void 0:(_data$Attachments=data.Attachments)===null||_data$Attachments===void 0?void 0:_data$Attachments.length)===0&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomEmpty */.ZX,{description:"No attachments found",className:"d-flex flex-column"}),!loading&&(data===null||data===void 0?void 0:(_data$Attachments2=data.Attachments)===null||_data$Attachments2===void 0?void 0:_data$Attachments2.map((item,idx)=>{var _item$mimeType;return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:Enquiries_styles_module.manage_media_photo,children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:Enquiries_styles_module.manage_media_photo_image,children:[(_item$mimeType=item.mimeType)!==null&&_item$mimeType!==void 0&&_item$mimeType.includes('image')?/*#__PURE__*/(0,jsx_runtime.jsx)(es_image/* default */.A,{src:"".concat(constants/* PROTECTED_RESOURCE_BASE_URL */.SO).concat(item.file,"?authKey=").concat(access_token),alt:item.title,width:100,height:70,style:{borderRadius:5,objectFit:'cover'},preview:false}):/*#__PURE__*/(0,jsx_runtime.jsx)(es_image/* default */.A,{src:"/images/doc.png",alt:"Document-".concat(idx),width:100,height:70,preview:false,style:{objectFit:'contain'}}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:Enquiries_styles_module.manage_media_photo_content,children:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{style:{cursor:'pointer'},className:Enquiries_styles_module.manage_media_photo_name_label,children:item.title})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:Enquiries_styles_module.media_photo_actions,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(tooltip/* default */.A,{title:"Download",children:/*#__PURE__*/(0,jsx_runtime.jsx)("a",{href:"".concat(constants/* PROTECTED_RESOURCE_BASE_URL */.SO).concat(item.file,"?authKey=").concat(access_token,"&download=true"),target:"_blank",style:{color:"var(--color-dark-sub)"},download:item.title,children:/*#__PURE__*/(0,jsx_runtime.jsx)(CloudDownloadOutlined/* default */.A,{style:{fontSize:22,cursor:"pointer",marginTop:5}})})}),/*#__PURE__*/(0,jsx_runtime.jsx)(popconfirm/* default */.A,{title:"Are you sure to delete this file?",onConfirm:()=>onRemoveFile(item.id),okText:"Yes",cancelText:"No",placement:"left",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Icons_delete/* DeleteIcon */.d,{cursor:'pointer',width:20})})]})]})},"".concat(item.title,"-").concat(idx));}))]}),type!=="edit"&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:type==="attachments"?"mt-5":"",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* ImageUploader */.GA,{title:"Attachments",name:"attachments",multiple:true})})]})]})});};/* harmony default export */ const Enquiries_drawer = (EnquiriesModal);
// EXTERNAL MODULE: ./node_modules/antd/es/typography/index.js + 15 modules
var typography = __webpack_require__(30377);
// EXTERNAL MODULE: ./node_modules/antd/es/card/index.js + 3 modules
var card = __webpack_require__(2557);
// EXTERNAL MODULE: ./node_modules/antd/es/button/index.js
var es_button = __webpack_require__(48538);
// EXTERNAL MODULE: ./node_modules/antd/es/tag/index.js + 1 modules
var tag = __webpack_require__(12916);
// EXTERNAL MODULE: ./node_modules/antd/es/table/index.js + 96 modules
var table = __webpack_require__(41821);
// EXTERNAL MODULE: ./node_modules/moment/moment.js
var moment = __webpack_require__(59051);
var moment_default = /*#__PURE__*/__webpack_require__.n(moment);
// EXTERNAL MODULE: ./src/Components/Icons/index.tsx + 58 modules
var Icons = __webpack_require__(63668);
// EXTERNAL MODULE: ./src/Modules/User/index.ts
var User = __webpack_require__(47645);
// EXTERNAL MODULE: ./node_modules/antd/es/skeleton/index.js + 11 modules
var skeleton = __webpack_require__(46005);
// EXTERNAL MODULE: ./node_modules/antd/es/divider/index.js
var divider = __webpack_require__(40895);
// EXTERNAL MODULE: ./node_modules/antd/es/dropdown/index.js
var dropdown = __webpack_require__(57811);
// EXTERNAL MODULE: ./node_modules/antd/es/space/index.js + 1 modules
var space = __webpack_require__(80737);
// EXTERNAL MODULE: ./node_modules/antd/es/avatar/index.js + 3 modules
var avatar = __webpack_require__(75871);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/UserOutlined.js + 1 modules
var UserOutlined = __webpack_require__(79378);
;// ./src/Components/Organisms/Enquiries/assign-to.tsx
const UserDropDown=props=>{const{AssignedTo,users,loading,permissions:{assignEnquiry},getUsers,enquiryId,reloadTableData}=props;const[messageApi,contextHolder]=message/* default */.Ay.useMessage();const module=(0,react.useMemo)(()=>new Enquiry/* EnquiryModule */.y(),[]);const[searchTerm,setSearchTerm]=(0,react.useState)("");const debouncedSearchTerm=(0,useDebounce/* useDebounce */.d)(searchTerm,500);const openMessage=data=>{messageApi.open({key:data.key,type:data.type,content:data.content,duration:data.type==="loading"?0:2});};// controls the dropdown visibility
const[visible,setVisible]=(0,react.useState)(false);// handle dropdown menu visibility change event
const onVisibleChange=flag=>setVisible(flag);(0,react.useEffect)(()=>{if(debouncedSearchTerm){getUsers({name:debouncedSearchTerm});}},[debouncedSearchTerm]);const onUserChange=userId=>{if(userId&&assignEnquiry===true){openMessage({key:"update",type:"loading",content:"Updating..."});module.assignEnquiry({assignedToId:userId},enquiryId).then(res=>{var _res$data;if(res!==null&&res!==void 0&&(_res$data=res.data)!==null&&_res$data!==void 0&&_res$data.data){var _res$data2;openMessage({key:"update",type:"success",content:res===null||res===void 0?void 0:(_res$data2=res.data)===null||_res$data2===void 0?void 0:_res$data2.message});setVisible(!visible);reloadTableData();}}).catch(err=>{const errorMessage=(0,common/* handleError */.H4)(err);openMessage({key:"update",type:"error",content:errorMessage||"Something went wrong"});});}else{openMessage({key:"update",type:"error",content:"You don't have permission to assign enquiry"});}};const overlay=/*#__PURE__*/(0,jsx_runtime.jsxs)(card/* default */.A,{className:"".concat(Enquiries_styles_module.overlay," pa-2"),children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{placeHolder:"Search User...",value:searchTerm,size:"w100",onChange:e=>{const{value}=e.target;searchTerm!==value&&setSearchTerm(value);},icon:/*#__PURE__*/(0,jsx_runtime.jsx)("img",{src:"/images/searchIcon.svg",alt:"Search Icon"})}),loading?/*#__PURE__*/(0,jsx_runtime.jsx)(skeleton/* default */.A,{active:true,className:"mt-1"}):/*#__PURE__*/(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(users===null||users===void 0?void 0:users.length)>0?/*#__PURE__*/(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:users===null||users===void 0?void 0:users.map(user=>{return/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:Enquiries_styles_module.overlay_item,onClick:()=>{if((AssignedTo===null||AssignedTo===void 0?void 0:AssignedTo.id)!==(user===null||user===void 0?void 0:user.id)&&assignEnquiry===true){const selectedUser=Number(user===null||user===void 0?void 0:user.id);onUserChange(selectedUser);}},children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("span",{className:(AssignedTo===null||AssignedTo===void 0?void 0:AssignedTo.id)===(user===null||user===void 0?void 0:user.id)?Enquiries_styles_module.disabledButton:"",children:[user===null||user===void 0?void 0:user.firstName," ",user===null||user===void 0?void 0:user.lastName," - ","(".concat(user===null||user===void 0?void 0:user.email,")")]}),/*#__PURE__*/(0,jsx_runtime.jsx)(divider/* default */.A,{className:"my-0"})]},"users-".concat(user===null||user===void 0?void 0:user.id));})}):/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:Enquiries_styles_module.overlay_item_noData,children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomEmpty */.ZX,{description:debouncedSearchTerm?"No results found, please modify your search term":"Please search for a user to assign this enquiry to"})})})]});return/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[contextHolder,/*#__PURE__*/(0,jsx_runtime.jsx)(dropdown/* default */.A,{dropdownRender:()=>overlay,trigger:assignEnquiry===true?["click"]:[],open:assignEnquiry===true?visible:false,onOpenChange:onVisibleChange,className:Enquiries_styles_module.dropdown,children:/*#__PURE__*/(0,jsx_runtime.jsx)(space/* default */.A,{children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%",cursor:assignEnquiry===true?"pointer":"default"},children:[/*#__PURE__*/(0,jsx_runtime.jsx)(avatar/* default */.A,{src:"".concat(constants/* RESOURCE_BASE_URL */.to).concat(AssignedTo===null||AssignedTo===void 0?void 0:AssignedTo.profile),icon:/*#__PURE__*/(0,jsx_runtime.jsx)(UserOutlined/* default */.A,{}),size:30}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"sm",className:"ml-1",children:"".concat(AssignedTo!==null&&AssignedTo!==void 0&&AssignedTo.firstName&&AssignedTo!==null&&AssignedTo!==void 0&&AssignedTo.lastName?"".concat(AssignedTo===null||AssignedTo===void 0?void 0:AssignedTo.firstName," ").concat(AssignedTo===null||AssignedTo===void 0?void 0:AssignedTo.lastName):"Assign To")})]})})})]});};/* harmony default export */ const assign_to = (UserDropDown);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/DeleteOutlined.js
var DeleteOutlined = __webpack_require__(78433);
;// ./src/Components/Organisms/Enquiries/actions.tsx
const ActionComponent=props=>{const{record,onEditIconClick,onAddNoteClick,reloadTableData,permissions:{deleteEnquiry,updateEnquiry}}=props;const module=(0,react.useMemo)(()=>new Enquiry/* EnquiryModule */.y(),[]);const[actionState,setActionState]=(0,react.useState)({confirmLoading:false,openPopConfirm:false});const showPopconfirm=()=>setActionState(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{openPopConfirm:true}));const handleDelete=()=>{setActionState(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{confirmLoading:true}));if(deleteEnquiry===false){message/* default */.Ay.error("You don't have permission to delete this record, please contact your admin.");setActionState(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{confirmLoading:false,openPopConfirm:false}));return;}module.deleteRecord(record.id).then(()=>{setActionState(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{openPopConfirm:false,confirmLoading:false}));reloadTableData();}).catch(err=>{var _err$response,_err$response$data;const errorMessage=err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message;message/* default */.Ay.error(errorMessage||"Something went wrong, please try again later.");setActionState(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{confirmLoading:false,openPopConfirm:false}));});};return/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:Enquiries_styles_module.actions,children:[updateEnquiry&&/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{onClick:()=>onEditIconClick(record),children:/*#__PURE__*/(0,jsx_runtime.jsx)("img",{src:"/images/editicon.svg",alt:"Edit Icon"})}),/*#__PURE__*/(0,jsx_runtime.jsx)("span",{onClick:()=>onAddNoteClick(record),children:/*#__PURE__*/(0,jsx_runtime.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"#fff",width:19,height:19,children:/*#__PURE__*/(0,jsx_runtime.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z"})})})]}),deleteEnquiry&&/*#__PURE__*/(0,jsx_runtime.jsx)(popconfirm/* default */.A,{open:actionState.openPopConfirm,placement:"rightBottom",title:"Are you sure?",onConfirm:handleDelete,onCancel:()=>setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false})),okButtonProps:{loading:actionState.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:visible=>{if(!visible){setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false}));}},children:/*#__PURE__*/(0,jsx_runtime.jsx)(DeleteOutlined/* default */.A,{className:Enquiries_styles_module.bg__red,onClick:showPopconfirm})})]});};/* harmony default export */ const actions = (ActionComponent);
// EXTERNAL MODULE: ./node_modules/antd/es/modal/index.js + 7 modules
var modal = __webpack_require__(32645);
// EXTERNAL MODULE: ./node_modules/antd/es/radio/index.js + 4 modules
var es_radio = __webpack_require__(17811);
// EXTERNAL MODULE: ./node_modules/antd/es/date-picker/index.js + 56 modules
var date_picker = __webpack_require__(4132);
// EXTERNAL MODULE: ./src/Modules/Organization/index.ts
var Organization = __webpack_require__(42361);
// EXTERNAL MODULE: ./src/helpers/options.ts
var helpers_options = __webpack_require__(59179);
;// ./src/Components/Organisms/Enquiries/status.tsx
const statusColors={1:"#FF9800",// darker yellow
2:"#43A047",// darker green
3:"#E53935",// darker red
4:"#FF5722"// darker orange
};const datePresets=[7,14,30,60,90];/** Status Dropdown */const StatusDropdown=props=>{var _xeroTenants$data,_assignToOptions$data;const{status,record,reloadTableData,projectTypeData,permissions:{updateEnquiryStatus}}=props;const[form]=es_form/* default */.A.useForm();const[messageApi,contextHolder]=message/* default */.Ay.useMessage();const module=(0,react.useMemo)(()=>new Enquiry/* EnquiryModule */.y(),[]);const orgModule=(0,react.useMemo)(()=>new Organization/* OrganizationModule */.I(),[]);const userModule=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);// Assign To Search Term
const[assignToTerm,setAssignToTerm]=(0,react.useState)("");const[xeroTenants,setXeroTenants]=(0,react.useState)({loading:true,data:[]});const debouncedAssignToTerm=(0,useDebounce/* useDebounce */.d)(assignToTerm,500);const[confirmEnquiry,setConfirmEnquiry]=(0,react.useState)({open:false,loading:false,value:null,clientType:"company"});const[openDate,setOpenDate]=(0,react.useState)(false);const{data:orgData,onRefresh}=(0,hooks/* useConditionFetchData */.P6)({method:orgModule.findPublished,condition:!!confirmEnquiry.open});// Search for the assign to options
const[assignToOptions,setAssignToOptions]=(0,react.useState)({data:[],loading:false});const openMessage=data=>{messageApi.open({key:data.key,type:data.type,content:data.content,duration:data.type==="loading"?0:2});};// controls the dropdown visibility
const[visible,setVisible]=(0,react.useState)(false);// const [clients] = useState<OrganizationType[]>([]);
const[openPopConfirm,setOpenPopConfirm]=(0,react.useState)({open:false,selected:null});// const onFetchClients = () => {
//   module.findDuplicateCompany(record.id).then((res) => {
//     setClients(res?.data?.data || [])
//   })
// }
const onStatusChange=_status=>{if(record.id&&updateEnquiryStatus===true){openMessage({key:"update",type:"loading",content:"Updating..."});module.changeStatus(record.id,_status).then(res=>{var _res$data;if(res!==null&&res!==void 0&&(_res$data=res.data)!==null&&_res$data!==void 0&&_res$data.data){var _res$data2;openMessage({key:"update",type:"success",content:res===null||res===void 0?void 0:(_res$data2=res.data)===null||_res$data2===void 0?void 0:_res$data2.message});if(confirmEnquiry.open!==true){setVisible(!visible);}reloadTableData();}}).catch(err=>{const errorMessage=(0,common/* handleError */.H4)(err);openMessage({key:"update",type:"error",content:errorMessage});});}else{openMessage({key:"update",type:"error",content:"You don't have permission to change status"});}};/** Get All Companies for Submission By Field */const GetUsers=params=>{setAssignToOptions(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:true}));const{getAllRecords}=userModule;getAllRecords(params).then(res=>{setAssignToOptions(prev=>{var _res$data3,_res$data3$data;// if the data is already present in the state, then don't add it again
const filteredData=res===null||res===void 0?void 0:(_res$data3=res.data)===null||_res$data3===void 0?void 0:(_res$data3$data=_res$data3.data)===null||_res$data3$data===void 0?void 0:_res$data3$data.filter(item=>{return!(prev!==null&&prev!==void 0&&prev.data.find(prevItem=>prevItem.id===item.id));});// add the new data to the existing data
return{data:[...prev.data,...filteredData],loading:false};});}).catch(err=>{message/* default */.Ay.error(err.response.data.message||"Something went wrong!");setAssignToOptions(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:false}));});};const onConfirmEnquiry=values=>{setConfirmEnquiry(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:true}));const valuesToSubmit=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},values),{},{clientType:Number(values.clientType),enquiryId:record.id});module.autoCreateLead(valuesToSubmit).then(res=>{var _res$data4;if(res!==null&&res!==void 0&&(_res$data4=res.data)!==null&&_res$data4!==void 0&&_res$data4.data){var _res$data5;setConfirmEnquiry(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:false,open:false}));reloadTableData();openMessage({content:(res===null||res===void 0?void 0:(_res$data5=res.data)===null||_res$data5===void 0?void 0:_res$data5.message)||"Lead created successfully",key:"update",type:"success"});}}).catch(err=>{const errorMessage=(0,common/* handleError */.H4)(err);openMessage({key:"update",type:"error",content:errorMessage||"Something went wrong"});setConfirmEnquiry(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:false}));});};const initOptions=(0,helpers_options/* getOptionsFromEnum */.uf)(commonEnums/* EnquiryStatus */.aQ);// Get only the spam option
const options=initOptions.filter(option=>{return Number(option.value)===commonEnums/* EnquiryStatus */.aQ.Spam;});// Assign To Search
const onAssignToSearch=(0,react.useCallback)(()=>{if(debouncedAssignToTerm){GetUsers({name:debouncedAssignToTerm});}},[debouncedAssignToTerm]);(0,react.useEffect)(()=>{onAssignToSearch();},[onAssignToSearch]);(0,react.useEffect)(()=>{form.setFieldsValue({clientType:Number(commonEnums/* LeadTypeEnum */.AO.individual),projectTypeId:record===null||record===void 0?void 0:record.projectTypeId,message:record===null||record===void 0?void 0:record.message});},[]);(0,react.useEffect)(()=>{if(confirmEnquiry.open===true){orgModule.getTenants().then(res=>{var _res$data6;if(res.data&&(_res$data6=res.data)!==null&&_res$data6!==void 0&&_res$data6.data){setXeroTenants({loading:false,data:res.data.data});}}).catch(err=>{console.error("Error while fetching tenants",err===null||err===void 0?void 0:err.message);});onRefresh();}},[confirmEnquiry.open]);return/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[contextHolder,/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"d-flex justify-end align-center",children:status===commonEnums/* EnquiryStatus */.aQ.Active?/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{type:"ghost",size:"small",className:Enquiries_styles_module.qualifyButton,onClick:()=>setConfirmEnquiry(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{open:true})),children:"Qualify"}),/*#__PURE__*/(0,jsx_runtime.jsx)(popconfirm/* default */.A,{title:"Are you sure you want to disqualify this enquiry?",onConfirm:()=>onStatusChange(openPopConfirm.selected),onCancel:()=>setOpenPopConfirm((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},openPopConfirm),{},{open:false})),open:openPopConfirm.open,children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* DropdownWithLabel */.g_,{label:"Disqualify",onClick:()=>setOpenPopConfirm({open:true,selected:commonEnums/* EnquiryStatus */.aQ.Unqualified}),items:options.map((option,index)=>{return{key:"option-".concat(index),label:option.label,onClick:()=>{const value=Number(option.value);setOpenPopConfirm({open:true,selected:value});}};}),trigger:["click"]})})]}):/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:Enquiries_styles_module.status,style:{backgroundColor:statusColors[status]},children:commonEnums/* EnquiryStatus */.aQ[status]})}),confirmEnquiry.open&&/*#__PURE__*/(0,jsx_runtime.jsxs)(modal/* default */.A,{open:confirmEnquiry.open,onCancel:()=>setConfirmEnquiry(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{open:false})),title:"Confirm Enquiry",okText:"Save",destroyOnClose:true,footer:null,getContainer:false,children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:"This will create a new lead automatically and sent to the lead management team."}),/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{layout:"vertical",form:form,onFinish:onConfirmEnquiry,name:"confirmEnquiry",children:[/*#__PURE__*/(0,jsx_runtime.jsx)("label",{children:"Lead Type"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"clientType",initialValue:commonEnums/* LeadTypeEnum */.AO.individual,rules:[{required:true,message:"Please select an option"}],style:{marginBottom:10},children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_radio/* default.Group */.Ay.Group,{onChange:e=>{const value=e.target.value;setConfirmEnquiry(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{leadType:value}));// if (value === LeadTypeEnum['company']) {
//   onFetchClients()
// }
},children:Object.entries(commonEnums/* LeadTypeEnum */.AO).map(_ref=>{let[key,value]=_ref;return/*#__PURE__*/(0,jsx_runtime.jsx)(es_radio/* default */.Ay,{value:Number(value),children:(0,common/* capitalize */.ZH)(key)},key);})})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"projectTypeId",style:{marginBottom:10},rules:[{required:true,message:"Please select project type"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomSelect */.Ae,{options:projectTypeData===null||projectTypeData===void 0?void 0:projectTypeData.map(item=>{return{value:item.id,label:item.title};}),placeholder:"Select Project Type",label:"Project Type",asterisk:true})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"submissionById",style:{marginBottom:10},rules:[{required:true,message:"Please select submission by company"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomSelect */.Ae,{asterisk:true,label:"Submission By",options:orgData===null||orgData===void 0?void 0:orgData.map(org=>{return{value:(org===null||org===void 0?void 0:org.id)||'',label:org===null||org===void 0?void 0:org.name};})})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"xeroTenantId",style:{marginBottom:10},rules:[{required:true,message:"Please select xero account"}],help:/*#__PURE__*/(0,jsx_runtime.jsx)("small",{children:"All Record including invoices, quotations, project of this client will be synced to the selected xero account."}),children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomSelect */.Ae,{asterisk:true,label:"Choose XERO account",options:(_xeroTenants$data=xeroTenants.data)===null||_xeroTenants$data===void 0?void 0:_xeroTenants$data.map(org=>{return{value:(org===null||org===void 0?void 0:org.tenantId)||'',label:org===null||org===void 0?void 0:org.tenantName};})})}),/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("label",{style:{color:"var(--color-dark-main)",fontSize:"var(--font-size-sm)"},children:"Due Date for Submission"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"dueDateForSubmissions",style:{marginBottom:10},children:/*#__PURE__*/(0,jsx_runtime.jsx)(date_picker/* default */.A,{placeholder:"Due Date for Submission",className:Enquiries_styles_module.date_picker,open:openDate,showToday:false,onOpenChange:status=>setOpenDate(status),renderExtraFooter:()=>/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:Enquiries_styles_module.date_footer,children:datePresets.map(days=>/*#__PURE__*/(0,jsx_runtime.jsxs)(es_button/* default */.A,{type:"ghost",size:"small",onClick:()=>{const date=moment_default()().add(days,'days');form.setFieldsValue({dueDateForSubmissions:date});setOpenDate(false);},children:["In ",days," days"]},days))})})})]}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"assignedToId",style:{marginBottom:30},help:/*#__PURE__*/(0,jsx_runtime.jsx)("small",{children:"If you want to assign this lead to someone, please select from the list"})// className="mb-10"
,children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* SelectWithSearch */.fd,{placeholder:"Select an user",label:"Assign To",asterisk:false,notFoundDescription:"No user found, search with name",customOption:true,onSearch:value=>{// search only if the value is not present in the options
const isValuePresent=assignToOptions.data.find(item=>{const{firstName,lastName}=item;return"".concat(firstName," ").concat(lastName).toLowerCase().includes(value.toLowerCase());});if(!isValuePresent){setAssignToTerm(value);}},options:(_assignToOptions$data=assignToOptions.data)===null||_assignToOptions$data===void 0?void 0:_assignToOptions$data.map(item=>({label:"".concat(item.firstName," ").concat(item.lastName),value:item.id,icon:/*#__PURE__*/(0,jsx_runtime.jsx)(avatar/* default */.A,{size:"small",src:"".concat(constants/* RESOURCE_BASE_URL */.to).concat(item.profile),alt:"".concat(item.firstName," ").concat(item.lastName)})}))})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"message",help:/*#__PURE__*/(0,jsx_runtime.jsx)("small",{children:" Enter any additional message for the lead management team"}),children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{defaultValue:record.message,label:"Message",type:"textArea",size:"w100"})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex justify-end",style:{gap:"1rem"},children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{onClick:()=>{setConfirmEnquiry(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{open:false}));},children:"Cancel"},"cancel"),/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{type:"primary",htmlType:"submit",loading:confirmEnquiry.loading,children:"Save"},"save")]})]})]})]});};/* harmony default export */ const Enquiries_status = (StatusDropdown);
;// ./src/Components/Organisms/Enquiries/table.tsx
const{Paragraph}=typography/* default */.A;const EnquiriesTable=props=>{const{tableLoading,tableData,onEditIconClick,reloadTableData,meta,onAddNoteClick,projectTypeData,permissions,onAttachmentClick}=props;const{updateEnquiry,deleteEnquiry}=permissions;const userModule=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const[users,setUsers]=(0,react.useState)({data:[],loading:false});const getUsers=query=>{var _query;setUsers(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:true}));query={name:((_query=query)===null||_query===void 0?void 0:_query.name)||''};userModule.getAllRecords(query).then(res=>{var _res$data;const data=res===null||res===void 0?void 0:(_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.data;setUsers({data:data,loading:false});}).catch(err=>{var _err$response,_err$response$data;message/* default */.Ay.error((err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||"Something went wrong");setUsers(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:false}));});};const columns=[{title:"S.No",dataIndex:"index",key:"index",render:(_text,_record,index)=>(0,common/* getTableRowNumber */.YO)(index,meta),width:"60px"},{title:'User',dataIndex:"user",key:"user",render:(_user,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"d-flex",children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"my-auto",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-main",weight:"bold",size:"sm",children:"".concat(record.name)}),(record===null||record===void 0?void 0:record.email)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Paragraph,{title:record.email,ellipsis:{rows:1,expandable:false},copyable:{text:record.email},className:"font-size-xs color-dark-sub mb-0 mt-1",children:record.email}),(record===null||record===void 0?void 0:record.phone)&&(record===null||record===void 0?void 0:record.phone)!=="undefined"&&/*#__PURE__*/(0,jsx_runtime.jsx)(Paragraph,{title:"+".concat(record.phoneCode).concat(record.phone),ellipsis:{rows:1,expandable:false},copyable:{text:"+".concat(record.phoneCode).concat(record.phone)},className:"font-size-xs color-dark-sub mb-0 mt-1",children:"+".concat(record.phoneCode).concat(record.phone)}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"xs",children:"Source: ".concat(commonEnums/* EnquirySource */.L4[record.source])}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex flex-column",children:[(record===null||record===void 0?void 0:record.addedDate)&&/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex mt-1 align-center",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Icons/* CalenderIcon */.e$,{className:"mr-2",width:13}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"xs",className:"mt-1",children:"Added: ".concat((0,dateHandler/* convertDate */.ic)(record.addedDate,"dd MM yy"))||0})]}),(record===null||record===void 0?void 0:record.modifiedDate)&&/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex align-center",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Icons/* CalenderIcon */.e$,{className:"mr-2",width:13}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"xs",className:"mt-1",children:"Modified: ".concat((0,dateHandler/* convertDate */.ic)(record.modifiedDate,"dd MM yy"))||0})]})]})]})}),width:"200px"},{title:'Assigned To',dataIndex:"AssignedTo",key:"AssignedTo",render:(AssignedTo,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(assign_to,{AssignedTo:AssignedTo,enquiryId:record.id,permissions:permissions,loading:users.loading,users:users.data,getUsers:getUsers,reloadTableData:reloadTableData}),width:"200px"},{title:"Message/Note",dataIndex:"message",key:"message",render:(message,record)=>{var _record$ProjectType;const{LeadEnquiryFollowUp}=record;return/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{style:{backgroundColor:"var(--color-border)",padding:"10px",borderRadius:"2px",fontSize:"var(--font-size-sm)"},children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{dangerouslySetInnerHTML:{__html:message}}),/*#__PURE__*/(0,jsx_runtime.jsxs)("span",{className:"font-size-sm color-dark-main font-weight-bold",children:["Project Type: ",record===null||record===void 0?void 0:(_record$ProjectType=record.ProjectType)===null||_record$ProjectType===void 0?void 0:_record$ProjectType.title]}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:(LeadEnquiryFollowUp===null||LeadEnquiryFollowUp===void 0?void 0:LeadEnquiryFollowUp.length)===0&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{size:"xs",fontSize:"xs",type:"plain",className:"mt-1",onClick:()=>onAddNoteClick(record),children:"Add Note"})})]}),(LeadEnquiryFollowUp===null||LeadEnquiryFollowUp===void 0?void 0:LeadEnquiryFollowUp.length)>0&&/*#__PURE__*/(0,jsx_runtime.jsx)(card/* default */.A,{size:"small",title:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex justify-space-between align-center",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-main",size:"sm",weight:"semi",children:"Notes"}),/*#__PURE__*/(0,jsx_runtime.jsx)(tooltip/* default */.A,{title:updateEnquiry===false?"You don't have permission to add notes":"",children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{type:"link",size:"small",onClick:()=>onAddNoteClick(record),style:{padding:"0px 0.5rem",margin:0,fontSize:'12px',fontWeight:500,color:"var(--color-dark-sub)",backgroundColor:"var(--color-inactive)"},disabled:updateEnquiry===false,children:"Manage Notes"})})]}),headStyle:{padding:"0px 0.5rem",margin:0},className:"mt-2",children:(LeadEnquiryFollowUp===null||LeadEnquiryFollowUp===void 0?void 0:LeadEnquiryFollowUp.length)>0?LeadEnquiryFollowUp===null||LeadEnquiryFollowUp===void 0?void 0:LeadEnquiryFollowUp.map((item,index)=>/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"mb-2",style:{borderBottom:index===(LeadEnquiryFollowUp===null||LeadEnquiryFollowUp===void 0?void 0:LeadEnquiryFollowUp.length)-1?'':'1px solid var(--color-border)',paddingBottom:index===(LeadEnquiryFollowUp===null||LeadEnquiryFollowUp===void 0?void 0:LeadEnquiryFollowUp.length)-1?'':'0.5rem'},children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex align-center",children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"font-size-sm color-dark-800",children:item.AddedBy.firstName+" "+item.AddedBy.lastName}),/*#__PURE__*/(0,jsx_runtime.jsxs)("span",{className:"font-size-xs color-dark-sub ml-2",style:{opacity:0.7},children:[moment_default()(item===null||item===void 0?void 0:item.addedDate).fromNow(),item.isConcern&&/*#__PURE__*/(0,jsx_runtime.jsx)(tag/* default */.A,{color:"warning",className:"ml-2",children:"Concern"}),item.isResolved&&/*#__PURE__*/(0,jsx_runtime.jsx)(tag/* default */.A,{color:"green",className:"ml-2",children:"Resolved"})]})]}),/*#__PURE__*/(0,jsx_runtime.jsx)(Paragraph,{ellipsis:{rows:2,expandable:true},className:"font-size-xs color-dark-sub mb-0",children:item===null||item===void 0?void 0:item.note})]},"notes-".concat(index))):/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"font-size-xs color-dark-sub text-center",children:"No Notes"})})]});},width:"450px"},{title:'Status',dataIndex:"status",key:"status",render:(status,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(Enquiries_status,{record:record,status:status,permissions:permissions,reloadTableData:reloadTableData,projectTypeData:projectTypeData}),width:"200px"},{title:'Attachments',dataIndex:"Attachments",key:"Attachments",render:(Attachments,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"".concat((Attachments===null||Attachments===void 0?void 0:Attachments.length)>0?"dark-main":"dark-sub"),className:"text-underline cursor-pointer",onClick:()=>onAttachmentClick(record),children:"".concat((Attachments===null||Attachments===void 0?void 0:Attachments.length)>0?(Attachments===null||Attachments===void 0?void 0:Attachments.length)+" files":"  No Attachments"," ")}),width:"200px"}];if(updateEnquiry===true||deleteEnquiry){columns.push({title:"Actions",dataIndex:"actions",key:"actions",render:(_actions,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(actions,{record:record,onEditIconClick:onEditIconClick,reloadTableData:reloadTableData,onAddNoteClick:onAddNoteClick,permissions:permissions}),width:"120px"});}return/*#__PURE__*/(0,jsx_runtime.jsx)(table/* default */.A,{sticky:true,dataSource:tableData,columns:columns,pagination:false,scroll:{x:991},loading:tableLoading,rowKey:record=>"enquiry-".concat(record.id)});};/* harmony default export */ const Enquiries_table = (EnquiriesTable);
// EXTERNAL MODULE: ./node_modules/antd/es/checkbox/index.js + 2 modules
var es_checkbox = __webpack_require__(52765);
// EXTERNAL MODULE: ./node_modules/antd/es/spin/index.js
var spin = __webpack_require__(90650);
// EXTERNAL MODULE: ./node_modules/antd/es/tabs/index.js + 22 modules
var tabs = __webpack_require__(92555);
// EXTERNAL MODULE: ./node_modules/@ant-design/pro-card/es/ProCard.js + 15 modules
var ProCard = __webpack_require__(91692);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/LoadingOutlined.js
var LoadingOutlined = __webpack_require__(29008);
;// ./src/Components/Organisms/Enquiries/Notes/styles.module.scss
// extracted by mini-css-extract-plugin
/* harmony default export */ const Notes_styles_module = ({"tabs":"styles_tabs__0lWcY","divider":"styles_divider__IPr0A","notes":"styles_notes__H9vDf","notes_wrapper":"styles_notes_wrapper__OiC-O","note":"styles_note__9VjaA","note_user_avatar":"styles_note_user_avatar__A85Um","note_content_wrapper":"styles_note_content_wrapper__H3vq-","note_header":"styles_note_header__jeyC3","note_header_date":"styles_note_header_date__fd+As","note_header_delete":"styles_note_header_delete__Zrd7a","note_content":"styles_note_content__VJBoM","notes_form_input_wrapper":"styles_notes_form_input_wrapper__SU5VD","notes_form_avatar":"styles_notes_form_avatar__JCsqB","notes_form_input":"styles_notes_form_input__oLWga","notes_form_send_loader":"styles_notes_form_send_loader__rX+Jj","notes_form_send":"styles_notes_form_send__NcE3w"});
;// ./src/Components/Organisms/Enquiries/Notes/logs-table.tsx
const{Paragraph: logs_table_Paragraph}=typography/* default */.A;const LogsTable=_ref=>{let{data,loading}=_ref;const columns=[{title:"S.No",dataIndex:"index",key:"index",render:(_text,_record,index)=>index+1,width:"60px"},{title:'User',dataIndex:"user",key:"user",render:(_user,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"d-flex",children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"my-auto",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-main",size:"sm",children:"".concat(record.name)}),(record===null||record===void 0?void 0:record.email)&&/*#__PURE__*/(0,jsx_runtime.jsxs)(logs_table_Paragraph,{title:record.email,ellipsis:{rows:1,expandable:false},copyable:{text:record.email},className:"font-size-xs color-dark-sub mb-0 mt-1",children:["Email:  ",record.email]}),(record===null||record===void 0?void 0:record.phone)&&/*#__PURE__*/(0,jsx_runtime.jsxs)(logs_table_Paragraph,{title:"+".concat(record.phoneCode).concat(record.phone),ellipsis:{rows:1,expandable:false},copyable:{text:"+".concat(record.phoneCode).concat(record.phone)},className:"font-size-xs color-dark-sub mb-0 mt-1",children:["Phone:   ","+".concat(record.phoneCode).concat(record.phone)]}),(record===null||record===void 0?void 0:record.slug)&&/*#__PURE__*/(0,jsx_runtime.jsxs)(logs_table_Paragraph,{title:record.slug,ellipsis:{rows:1,expandable:false},copyable:{text:record.slug},className:"font-size-xs color-dark-sub mb-0 mt-1",children:["Slug:  ",record.slug]}),(record===null||record===void 0?void 0:record.source)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"xs",children:"Source: ".concat(commonEnums/* EnquirySource */.L4[record.source])}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex mt-4",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Icons/* CalenderIcon */.e$,{className:"mr-2"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"sm",children:"".concat((0,dateHandler/* convertDate */.ic)(record.addedDate,"dd MM yy"))})]})]})})},{title:'Message',dataIndex:"message",key:"message",render:message=>/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-main",size:"sm",children:message}),width:"20%"},{title:'Note',dataIndex:'LeadEnquiryFollowUp',key:'LeadEnquiryFollowUp',render:note=>/*#__PURE__*/(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:note===null||note===void 0?void 0:note.map(item=>/*#__PURE__*/(0,jsx_runtime.jsx)(logs_table_Paragraph,{ellipsis:{rows:3,expandable:true},className:"font-size-xs color-dark-sub mb-0 mt-1",children:item.note}))})}];return/*#__PURE__*/(0,jsx_runtime.jsx)(table/* default */.A,{dataSource:data,columns:columns,loading:loading});};/* harmony default export */ const logs_table = (LogsTable);
;// ./src/Components/Organisms/Enquiries/Notes/index.tsx
const{TextArea}=input/* default */.A;const EnquiryNotes=props=>{var _loggedInUserData$dat,_loggedInUserData$dat2,_loggedInUserData$dat3;const{enquiryId,onRefresh,permissions,open,onCancel}=props;const{loggedInUserData}=(0,es/* useSelector */.d4)(state=>state.usersReducer);const{updateEnquiry,readEnquiry}=permissions;const module=(0,react.useMemo)(()=>new Enquiry/* EnquiryModule */.y(),[]);const[activeTab,setActiveTab]=(0,react.useState)("addNote");const[showDelete,setShowDelete]=(0,react.useState)({});const[notes,setNotes]=(0,react.useState)({content:'',loading:false,isConcern:false});const[concernResolved,setConcernResolved]=(0,react.useState)({confirmLoading:false,visible:false});const logsCondition=(0,react.useMemo)(()=>{return!!enquiryId&&readEnquiry===true&&activeTab==="logs";},[enquiryId,readEnquiry,activeTab]);// Fetch notes
const{data:allNotes,onRefresh:onRefreshNotes,loading:notesLoading}=(0,hooks/* useConditionFetchData */.P6)({method:()=>module.getNoteById(enquiryId),condition:!!enquiryId&&readEnquiry===true});// Fetch notes logs
const{data:noteLogs,onRefresh:onRefreshNoteLogs,loading:logsLoading}=(0,hooks/* useConditionFetchData */.P6)({method:()=>module.getLogsById(enquiryId),condition:logsCondition});/**Function to add a note
   * @param {string} note note to be added
   */const onAddNote=(note,isConcern)=>{if(!note){message/* default */.Ay.error('Please enter a note');return;}if(!enquiryId)return;if(updateEnquiry===true){setNotes(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:true}));module.addNote(enquiryId,{note,isConcern}).then(res=>{var _res$data;message/* default */.Ay.success((res===null||res===void 0?void 0:(_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.message)||'Note added successfully');setNotes({content:'',loading:false,isConcern:false});onRefresh();onRefreshNotes();}).catch(err=>{var _err$response,_err$response$data;message/* default */.Ay.error((err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Something went wrong');setNotes(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:false}));});}else{message/* default */.Ay.error('You do not have permission to add notes');}};/**Function to remove a note
   * @param {number} noteId id of the note to be deleted
   */const onRemoveNote=noteId=>{if(updateEnquiry===true){module.removeNote(noteId).then(res=>{var _res$data2;message/* default */.Ay.success((res===null||res===void 0?void 0:(_res$data2=res.data)===null||_res$data2===void 0?void 0:_res$data2.message)||'Note deleted successfully');onRefresh();onRefreshNotes();}).catch(err=>{var _err$response2,_err$response2$data;message/* default */.Ay.error((err===null||err===void 0?void 0:(_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||'Something went wrong');});}else{message/* default */.Ay.error('You do not have permission to delete notes');}};return/*#__PURE__*/(0,jsx_runtime.jsx)(modal/* default */.A,{title:"Notes",open:open,onCancel:onCancel,width:700,footer:activeTab==="addNote"&&!notesLoading?/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_checkbox/* default */.A,{checked:notes.isConcern,onChange:e=>setNotes(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{isConcern:e.target.checked})),children:"Mark as a concern"}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:Notes_styles_module.notes_form_input_wrapper,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(avatar/* default */.A,{size:30,icon:/*#__PURE__*/(0,jsx_runtime.jsx)(UserOutlined/* default */.A,{}),className:Notes_styles_module.notes_form_avatar,src:"".concat(constants/* RESOURCE_BASE_URL */.to).concat(loggedInUserData===null||loggedInUserData===void 0?void 0:(_loggedInUserData$dat=loggedInUserData.data)===null||_loggedInUserData$dat===void 0?void 0:_loggedInUserData$dat.profile),alt:"".concat(loggedInUserData===null||loggedInUserData===void 0?void 0:(_loggedInUserData$dat2=loggedInUserData.data)===null||_loggedInUserData$dat2===void 0?void 0:_loggedInUserData$dat2.firstName," ").concat(loggedInUserData===null||loggedInUserData===void 0?void 0:(_loggedInUserData$dat3=loggedInUserData.data)===null||_loggedInUserData$dat3===void 0?void 0:_loggedInUserData$dat3.lastName)}),/*#__PURE__*/(0,jsx_runtime.jsx)(TextArea,{placeholder:"Add a note...",className:Notes_styles_module.notes_form_input,autoSize:{minRows:1,maxRows:4},value:notes.content,onChange:e=>setNotes(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{content:e.target.value}))}),notes.loading?/*#__PURE__*/(0,jsx_runtime.jsx)(spin/* default */.A,{indicator:/*#__PURE__*/(0,jsx_runtime.jsx)(LoadingOutlined/* default */.A,{style:{fontSize:20},spin:true}),className:Notes_styles_module.notes_form_send_loader}):/*#__PURE__*/(0,jsx_runtime.jsx)(Icons/* SendIcon */.qx,{width:30,height:30,className:Notes_styles_module.notes_form_send,onClick:()=>onAddNote(notes.content,notes.isConcern)})]})]}):null,children:/*#__PURE__*/(0,jsx_runtime.jsxs)(tabs/* default */.A,{type:"card",defaultActiveKey:"addNote",onChange:key=>{setActiveTab(key);key==="logs"&&onRefreshNoteLogs();},children:[/*#__PURE__*/(0,jsx_runtime.jsx)(tabs/* default */.A.TabPane,{tab:"Notes",children:/*#__PURE__*/(0,jsx_runtime.jsx)(ProCard/* default */.A,{headStyle:{display:'unset',padding:0},bodyStyle:{padding:0},className:Notes_styles_module.notes,children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:Notes_styles_module.notes_wrapper,children:[notesLoading&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:Notes_styles_module.notes_loader,children:/*#__PURE__*/(0,jsx_runtime.jsx)(skeleton/* default */.A,{active:true})}),(allNotes===null||allNotes===void 0?void 0:allNotes.length)===0&&!notesLoading&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:Notes_styles_module.notes_empty,children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomEmpty */.ZX,{description:"No notes found"})}),allNotes===null||allNotes===void 0?void 0:allNotes.map((note,index)=>/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:Notes_styles_module.note,onMouseEnter:()=>setShowDelete({[note.id]:true}),onMouseLeave:()=>setShowDelete({}),children:[/*#__PURE__*/(0,jsx_runtime.jsx)(avatar/* default */.A,{size:40,icon:/*#__PURE__*/(0,jsx_runtime.jsx)(UserOutlined/* default */.A,{}),className:Notes_styles_module.note_user_avatar,src:"".concat(constants/* RESOURCE_BASE_URL */.to).concat(note.AddedBy.profile),alt:"".concat(note.AddedBy.firstName," ").concat(note.AddedBy.lastName)}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:Notes_styles_module.note_content_wrapper,children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:Notes_styles_module.note_header,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{weight:"bold",color:"dark-main",children:"".concat(note.AddedBy.firstName," ").concat(note.AddedBy.lastName)}),/*#__PURE__*/(0,jsx_runtime.jsxs)("p",{className:Notes_styles_module.note_header_date,title:moment_default()(note.addedDate).format("DD MMM, YYYY hh:mm A"),children:[moment_default()(note.addedDate).fromNow(),note.isConcern&&/*#__PURE__*/(0,jsx_runtime.jsx)(tag/* default */.A,{color:"warning",className:"ml-2",children:"Concern"}),note.isResolved&&/*#__PURE__*/(0,jsx_runtime.jsx)(tag/* default */.A,{color:"green",className:"ml-2",children:"Resolved"}),note.isConcern&&!note.isResolved&&/*#__PURE__*/(0,jsx_runtime.jsx)(popconfirm/* default */.A,{title:"Are you sure to mark this concern as resolved?",okText:"Yes",cancelText:"No",placement:"bottomRight",open:concernResolved.visible,onOpenChange:open=>setConcernResolved(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{visible:open})),onCancel:()=>setConcernResolved(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{visible:false})),okButtonProps:{loading:concernResolved.confirmLoading},onConfirm:()=>{if(updateEnquiry===true){module.markConcernAsResolved(note.id).then(res=>{var _res$data3;message/* default */.Ay.success((res===null||res===void 0?void 0:(_res$data3=res.data)===null||_res$data3===void 0?void 0:_res$data3.message)||'Concern resolved successfully');onRefresh();onRefreshNotes();setConcernResolved(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{visible:false}));}).catch(err=>{const errorMessage=(0,common/* handleError */.H4)(err);message/* default */.Ay.error(errorMessage||'Something went wrong');});}else{message/* default */.Ay.error('You do not have permission to resolve concerns');}},children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_checkbox/* default */.A,{checked:false,onChange:e=>setConcernResolved(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{visible:e.target.checked})),children:"Mark as resolved"})})]}),showDelete[note.id]&&/*#__PURE__*/(0,jsx_runtime.jsx)(popconfirm/* default */.A,{title:"Are you sure to delete this note?",onConfirm:()=>onRemoveNote(note.id),okText:"Yes",cancelText:"No",placement:"left",children:/*#__PURE__*/(0,jsx_runtime.jsx)(DeleteOutlined/* default */.A,{className:Notes_styles_module.note_header_delete})})]}),/*#__PURE__*/(0,jsx_runtime.jsx)("p",{className:Notes_styles_module.note_content,children:note.note})]})]},"note-".concat(index)))]})})},"addNote"),/*#__PURE__*/(0,jsx_runtime.jsx)(tabs/* default */.A.TabPane,{tab:"Logs",children:/*#__PURE__*/(0,jsx_runtime.jsx)(logs_table,{data:noteLogs,loading:logsLoading})},"logs")]})});};/* harmony default export */ const Notes = (EnquiryNotes);
;// ./src/Components/Organisms/Enquiries/index.tsx
const breadCrumbsData=[{text:"Home",isLink:true,path:"/"},{isLink:false,text:"Enquiries"}];const Enquiries=()=>{var _assignedTo$data;// available permissions for the properties page
const permissionSlug=(0,common/* getPermissionSlugs */.AH)(Enquiry_permissions/* EnquiryPermissionsEnum */.V);const{userPermissions}=(0,es/* useSelector */.d4)(state=>state.usersReducer);const permissions=userPermissions;const{readEnquiry,createEnquiry,updateEnquiry}=permissions;const module=(0,react.useMemo)(()=>new Enquiry/* EnquiryModule */.y(),[]);const userModule=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const projectTypeModule=(0,react.useMemo)(()=>new ProjectType/* ProjectTypeModule */.g(),[]);const{data:projectTypeData}=(0,hooks/* useFetchData */.Gs)({method:projectTypeModule.getPublishRecords,initialQuery:{perPage:100}});const{data,onRefresh,meta,loading}=(0,hooks/* useFetchData */.Gs)({method:module.getAllRecords,initialQuery:{status:commonEnums/* EnquiryStatus */.aQ.Active}});// Status Counts
const{data:statusCounts,onRefresh:onRefreshStatusCount}=(0,hooks/* useFetchData */.Gs)({method:module.getCounts});const[modalOpen,setModalOpen]=(0,react.useState)({type:"new",recordId:0,open:false});const[openNotesModal,setOpenNotesModal]=(0,react.useState)({type:"notes",recordId:0,open:false});const[selectedFilters,setSelectedFilters]=(0,react.useState)({status:commonEnums/* EnquiryStatus */.aQ.Active,dateRange:[""]});const[moreFilters,setMoreFilters]=(0,react.useState)([]);const[reset,setReset]=(0,react.useState)(false);const[excelData,setExcelData]=(0,react.useState)([]);// Name search
const[searchTerm,setSearchTerm]=(0,react.useState)();// Search Debounce
const debouncedSearchTerm=(0,useDebounce/* useDebounce */.d)(searchTerm,500);// assigned to search term
const[assignedToTerm,setAssignedToTerm]=(0,react.useState)("");// Search Debounce
const debouncedAssignedToTerm=(0,useDebounce/* useDebounce */.d)(assignedToTerm,500);const[assignedTo,setAssignedTo]=(0,react.useState)({data:[],loading:false});// headers for the excel export
const headers=[{label:"Name",key:"name"},{label:"Email",key:"email"}];const onSelected=event=>{const{name,value}=event===null||event===void 0?void 0:event.target;// set the selected value in the state
setSelectedFilters(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{[name]:value}));};const onReset=(0,react.useCallback)((name,value)=>{if(name){setReset(true);setSelectedFilters((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},selectedFilters),{},{[name]:value}));}},[selectedFilters]);const onModalOpen=_ref=>{let{type,recordId,open}=_ref;return setModalOpen({type,recordId,open});};const onAddNewClick=()=>{if(createEnquiry===false){message/* default */.Ay.error("You don't have permission to create new record");return;}onModalOpen({type:"new",open:true,recordId:0});};const onEditIconClick=record=>{if(updateEnquiry===false){message/* default */.Ay.error("You don't have permission to update record");return;}onModalOpen({type:"edit",open:true,recordId:record===null||record===void 0?void 0:record.id});};const onAddNoteClick=record=>{if(updateEnquiry===false){message/* default */.Ay.error("You don't have permission to add notes");return;}setOpenNotesModal({type:"notes",open:true,recordId:record===null||record===void 0?void 0:record.id});};const onUpdate=(0,react.useCallback)(query=>{var _selectedFilters$date,_selectedFilters$date2;const fromDateString=((_selectedFilters$date=selectedFilters.dateRange)===null||_selectedFilters$date===void 0?void 0:_selectedFilters$date[0])||"";const toDateString=((_selectedFilters$date2=selectedFilters.dateRange)===null||_selectedFilters$date2===void 0?void 0:_selectedFilters$date2[1])||"";const fromDate=fromDateString?(0,dateHandler/* convertDate */.ic)(fromDateString,"yy-mm-dd"):undefined;const toDate=toDateString?(0,dateHandler/* convertDate */.ic)(toDateString,"yy-mm-dd"):undefined;const data=(0,objectSpread2/* default */.A)({status:selectedFilters.status||undefined,email:selectedFilters.email||undefined,phone:selectedFilters.phone||undefined,fromDate:fromDate,toDate:toDate,name:selectedFilters.name||undefined,source:selectedFilters.source||undefined,userAgent:selectedFilters.userAgent||undefined,userIP:selectedFilters.userIP||undefined,hasConcerns:selectedFilters.hasConcerns||undefined,assignedToId:selectedFilters.assignedToId||undefined},query);// get the data from the api
onRefresh(data);// get the status counts
onRefreshStatusCount();},[selectedFilters]);const onPaginationChange=(page,pageSize)=>onUpdate({page,perPage:pageSize});const moreFiltersOptions=[{label:"Email",value:"email"},{label:"Phone",value:"phone"},{label:"User IP",value:"userIP"},{label:"User Agent",value:"userAgent"}];const moreComponents={email:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"email",label:"Email",name:"email",value:selectedFilters===null||selectedFilters===void 0?void 0:selectedFilters.email,onChange:onSelected,onReset:()=>onReset("email",""),onUpdate:onUpdate,defaultVisible:moreFilters.includes("email")}),phone:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"input",label:"Phone",name:"phone",value:selectedFilters===null||selectedFilters===void 0?void 0:selectedFilters.phone,onChange:onSelected,onReset:()=>onReset("phone",""),onUpdate:onUpdate,defaultVisible:moreFilters.includes("phone")}),userIP:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"input",label:"User IP",name:"userIP",value:selectedFilters===null||selectedFilters===void 0?void 0:selectedFilters.userIP,onChange:onSelected,onReset:()=>onReset("userIP",""),onUpdate:onUpdate,defaultVisible:moreFilters.includes("userIP")}),userAgent:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"input",label:"User Agent",name:"userAgent",value:selectedFilters===null||selectedFilters===void 0?void 0:selectedFilters.userAgent,onChange:onSelected,onReset:()=>onReset("userAgent",""),onUpdate:onUpdate,defaultVisible:moreFilters.includes("userAgent")})};const onSearchChange=event=>{const{value}=event.currentTarget;setSearchTerm(value);onSelected(event);};/** Get the search result for the assigned to */const GetSearchAssignedTo=(0,react.useCallback)(()=>{if(debouncedAssignedToTerm){setAssignedTo(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:true}));userModule.getAllRecords({name:debouncedAssignedToTerm}).then(res=>{var _res$data;const data=res===null||res===void 0?void 0:(_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.data;setAssignedTo(prev=>{// if the data is already present in the state, then don't add it again
const filteredData=data===null||data===void 0?void 0:data.filter(item=>{var _prev$data;return!(prev!==null&&prev!==void 0&&(_prev$data=prev.data)!==null&&_prev$data!==void 0&&_prev$data.find(prevItem=>prevItem.id===item.id));});// add the new data to the existing data
return{data:[...prev.data,...filteredData],loading:false};});}).catch(err=>{const errorMessage=(0,common/* handleError */.H4)(err);message/* default */.Ay.error(errorMessage||"Something went wrong, please try again later.");setAssignedTo(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:false}));});}},[debouncedAssignedToTerm]);const otherOptions=[];Object.entries(commonEnums/* EnquiryStatus */.aQ).forEach(_ref2=>{let[key,value]=_ref2;if(!(0,common/* isNumber */.Et)(key)){otherOptions.push({label:"".concat(key," (").concat((statusCounts===null||statusCounts===void 0?void 0:statusCounts[key===null||key===void 0?void 0:key.toLowerCase()])||0,")"),value:value});}});const segmentedOptions=[{label:"All (".concat((statusCounts===null||statusCounts===void 0?void 0:statusCounts.all)||0,")"),value:"all"},...otherOptions,{label:"Has Concerns (".concat((statusCounts===null||statusCounts===void 0?void 0:statusCounts.hasConcerns)||0,")"),value:"hasConcerns"}];(0,react.useEffect)(()=>{if(reset){onUpdate();}// after 2 seconds set reset clicked state to false
const timer=setTimeout(()=>{setReset(false);},2000);return()=>clearTimeout(timer);},[reset,selectedFilters,onUpdate]);(0,react.useEffect)(()=>{if(debouncedSearchTerm!==undefined){onUpdate({name:debouncedSearchTerm});}else if(debouncedSearchTerm===""){onUpdate({name:undefined});}},[debouncedSearchTerm]);(0,react.useEffect)(()=>{GetSearchAssignedTo();},[GetSearchAssignedTo]);const getExcelData=(0,react.useCallback)(()=>{if(data&&data.length>0){const _data=data===null||data===void 0?void 0:data.map(item=>{return{};});setExcelData(_data);}},[data]);(0,react.useEffect)(()=>{getExcelData();},[getExcelData]);return/*#__PURE__*/(0,jsx_runtime.jsxs)(Layout/* default */.A,{permissionSlug:permissionSlug,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* PageHeader */.zY,{heading:"Enquiries",breadCrumbData:breadCrumbsData,showAdd:!!createEnquiry,buttonText:"Add Enquiry",onButtonClick:onAddNewClick,filters:readEnquiry?/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{name:"name",placeHolder:"Search by name",onChange:onSearchChange,value:searchTerm,style:{maxWidth:200}})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{overflow:"auto"},children:/*#__PURE__*/(0,jsx_runtime.jsx)(segmented/* default */.A,{size:"middle",options:segmentedOptions.map(item=>{return (0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},item),{},{title:item.label,value:item.value});}),style:{fontSize:"var(--font-size-sm)"},value:(selectedFilters===null||selectedFilters===void 0?void 0:selectedFilters.status)||"all",onChange:value=>{setSelectedFilters((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},selectedFilters),{},{status:value}));if(value==="all"){onReset("status","");}else if(value==="hasConcerns"){onUpdate({hasConcerns:true,status:undefined});}else{onUpdate({status:value});}}})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"radio",label:"Source",name:"source",options:Object.entries(commonEnums/* EnquirySource */.L4).map(_ref3=>{let[key,value]=_ref3;return{label:value,value:key};}),value:String(selectedFilters===null||selectedFilters===void 0?void 0:selectedFilters.source),onChange:onSelected,onReset:()=>onReset("source",""),onUpdate:onUpdate})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"radio",label:"Assigned To",name:"assignedToId",withSearch:true,options:assignedTo===null||assignedTo===void 0?void 0:(_assignedTo$data=assignedTo.data)===null||_assignedTo$data===void 0?void 0:_assignedTo$data.map(item=>{return{label:"".concat(item.firstName," ").concat(item.lastName),value:"".concat(item.id)};}),onChange:onSelected,value:Number(selectedFilters===null||selectedFilters===void 0?void 0:selectedFilters.assignedToId)>0?String(selectedFilters===null||selectedFilters===void 0?void 0:selectedFilters.assignedToId):"",onReset:()=>{onReset("assignedToId",0);// reset the search term
setAssignedToTerm("");},onUpdate:onUpdate// START: For search
,loading:assignedTo===null||assignedTo===void 0?void 0:assignedTo.loading,searchTerm:assignedToTerm,onSearch:event=>setAssignedToTerm(event.currentTarget.value)// END: For search
})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"datepicker",label:"Date",name:"dateRange",onChange:value=>setSelectedFilters(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{dateRange:value})),onReset:()=>onReset("dateRange",[]),onUpdate:onUpdate})}),/**  Find the selected filter and render the component based on the name of the filter */Object.keys(moreComponents).map(key=>{const _key=key;return moreFilters!==null&&moreFilters!==void 0&&moreFilters.includes(_key)?moreComponents[_key]:null;}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(more/* default */.A,{options:moreFiltersOptions===null||moreFiltersOptions===void 0?void 0:moreFiltersOptions.map(option=>({label:option.label,value:option.value})),onChange:value=>setMoreFilters(value),value:moreFilters})})]}):null}),readEnquiry===true&&/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:styles_module/* default */.A.antdTableWrapper,children:/*#__PURE__*/(0,jsx_runtime.jsx)(Enquiries_table,{tableData:data,tableLoading:loading,permissions:permissions,projectTypeData:projectTypeData,reloadTableData:()=>{onRefresh();onRefreshStatusCount();},onEditIconClick:onEditIconClick,onAddNoteClick:onAddNoteClick,onAttachmentClick:record=>onModalOpen({type:"attachments",open:true,recordId:record===null||record===void 0?void 0:record.id}),meta:meta})}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Pagination */.dK,{total:meta===null||meta===void 0?void 0:meta.total,current:meta===null||meta===void 0?void 0:meta.page,defaultPageSize:meta!==null&&meta!==void 0&&meta.perPage?meta===null||meta===void 0?void 0:meta.perPage:10,pageSizeOptions:[10,20,50,100],onChange:onPaginationChange})]}),readEnquiry===false&&/*#__PURE__*/(0,jsx_runtime.jsx)(ErrorCodes/* ErrorCode403 */.$t,{mainMessage:"You don't have permission to view this data"}),modalOpen.open&&/*#__PURE__*/(0,jsx_runtime.jsx)(Enquiries_drawer,{projectTypeData:projectTypeData,visible:modalOpen.open,type:modalOpen.type,recordId:modalOpen.recordId,permissions:permissions,onCancel:()=>onModalOpen({type:"new",recordId:0,open:false}),onRefresh:()=>{if(modalOpen.type==="new"){setSelectedFilters({status:commonEnums/* EnquiryStatus */.aQ.Active});onUpdate({status:commonEnums/* EnquiryStatus */.aQ.Active});}else{onUpdate();}onRefreshStatusCount();}}),openNotesModal.open&&/*#__PURE__*/(0,jsx_runtime.jsx)(Notes,{open:openNotesModal.open,permissions:permissions,enquiryId:openNotesModal.recordId// refresh enquiry data
,onRefresh:()=>{onRefresh();onRefreshStatusCount();},onCancel:()=>{setOpenNotesModal({type:"new",recordId:0,open:false});}})]});};/* harmony default export */ const Organisms_Enquiries = (Enquiries);

/***/ }),

/***/ 42361:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   I: () => (/* binding */ OrganizationModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
/* harmony import */ var _modules_Common_config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(21073);
class OrganizationModule{constructor(){this.endPoint="organization";/**Get all organization records
     * @param query - query params
     */this.getAllRecords=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint,{params:query});};/**Get all organization records
     * @param query - query params
     */this.findPublished=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint+"/find-published",{params:query});};/**Get organization record by id
     * @param id - organization id
     */this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/").concat(id));};/**Delete organization record
    * @param id - organization id
    */this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete("".concat(this.endPoint,"/").concat(id));};/**Create new organization record
     * @param data - organization data
     */this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint,data,{headers:_modules_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};/**Update organization record
    * @param data - organization data
    * @param id - organization id
    */this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch("".concat(this.endPoint,"/").concat(id),data,{headers:_modules_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};this.getTenants=()=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("xero/getTenants");};}}

/***/ }),

/***/ 40841:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {


// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  A: () => (/* binding */ icons_CloudDownloadOutlined)
});

// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/extends.js
var esm_extends = __webpack_require__(58168);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(9950);
;// ./node_modules/@ant-design/icons-svg/es/asn/CloudDownloadOutlined.js
// This icon file is generated automatically.
var CloudDownloadOutlined = {
  "icon": {
    "tag": "svg",
    "attrs": {
      "viewBox": "64 64 896 896",
      "focusable": "false"
    },
    "children": [{
      "tag": "path",
      "attrs": {
        "d": "M624 706.3h-74.1V464c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v242.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.7a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9z"
      }
    }, {
      "tag": "path",
      "attrs": {
        "d": "M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"
      }
    }]
  },
  "name": "cloud-download",
  "theme": "outlined"
};
/* harmony default export */ const asn_CloudDownloadOutlined = (CloudDownloadOutlined);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/components/AntdIcon.js + 5 modules
var AntdIcon = __webpack_require__(61187);
;// ./node_modules/@ant-design/icons/es/icons/CloudDownloadOutlined.js

// GENERATE BY ./scripts/generate.ts
// DON NOT EDIT IT MANUALLY




var CloudDownloadOutlined_CloudDownloadOutlined = function CloudDownloadOutlined(props, ref) {
  return /*#__PURE__*/react.createElement(AntdIcon/* default */.A, (0,esm_extends/* default */.A)({}, props, {
    ref: ref,
    icon: asn_CloudDownloadOutlined
  }));
};
if (false) {}
/* harmony default export */ const icons_CloudDownloadOutlined = (/*#__PURE__*/react.forwardRef(CloudDownloadOutlined_CloudDownloadOutlined));

/***/ })

}]);