"use strict";
(self["webpackChunkdat_projects"] = self["webpackChunkdat_projects"] || []).push([[8994],{

/***/ 44394:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   d: () => (/* binding */ Switch)
/* harmony export */ });
/* harmony import */ var C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(89379);
/* harmony import */ var C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(80045);
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(92759);
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(25933);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(9950);
/* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(38266);
/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(44414);
const _excluded=["onChange","checked","recordId","allowChange"];const Switch=_ref=>{let{onChange,checked,recordId,allowChange=true}=_ref,rest=(0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectWithoutProperties_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .A)(_ref,_excluded);const[buttonState,setButtonState]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({loading:false,checked:false});const onSwitchChange=checked=>{if(allowChange===true){setButtonState((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A)((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A)({},buttonState),{},{loading:true}));onChange(checked,recordId,rest).then(res=>{setButtonState((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A)((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A)({},buttonState),{},{checked:checked,loading:false}));antd__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Ay.success(res.data.message);}).catch(err=>{setButtonState((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A)((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A)({},buttonState),{},{loading:false}));let serverErrors=(0,_helpers__WEBPACK_IMPORTED_MODULE_5__/* .errorHandler */ .r)(err);if(typeof serverErrors.message==="string"){antd__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Ay.error(serverErrors.message);}else{antd__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Ay.error("Something went wrong");}});}else{antd__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Ay.error("You don't have permission to change this record, please contact your admin.");}};(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{setButtonState((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A)((0,C_Users_Developer_datportal_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A)({},buttonState),{},{checked:checked}));},[checked]);return/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(antd__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .A,{checked:buttonState.checked,onChange:onSwitchChange,loading:buttonState.loading});};

/***/ }),

/***/ 78994:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ SiteSettings_OrganizationSettings)
});

// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js
var objectSpread2 = __webpack_require__(89379);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(9950);
// EXTERNAL MODULE: ./src/Components/Atoms/index.tsx + 12 modules
var Atoms = __webpack_require__(9394);
// EXTERNAL MODULE: ./src/Components/Templates/SiteSettings/index.tsx
var SiteSettings = __webpack_require__(16181);
// EXTERNAL MODULE: ./node_modules/antd/es/form/index.js + 18 modules
var es_form = __webpack_require__(10678);
// EXTERNAL MODULE: ./node_modules/antd/es/message/index.js + 1 modules
var message = __webpack_require__(92759);
// EXTERNAL MODULE: ./node_modules/antd/es/space/index.js + 1 modules
var space = __webpack_require__(80737);
// EXTERNAL MODULE: ./src/Components/Organisms/SiteSettings/Common/styles.module.scss
var styles_module = __webpack_require__(41394);
// EXTERNAL MODULE: ./src/Components/Organisms/Skeletons/index.tsx
var Skeletons = __webpack_require__(70619);
// EXTERNAL MODULE: ./src/Components/Atoms/ServerErrorHandler/index.tsx
var ServerErrorHandler = __webpack_require__(13321);
// EXTERNAL MODULE: ./src/helpers/error-handler.ts
var error_handler = __webpack_require__(38266);
// EXTERNAL MODULE: ./src/Modules/Organization/index.ts
var Organization = __webpack_require__(42361);
// EXTERNAL MODULE: ./src/helpers/commonEnums.ts
var commonEnums = __webpack_require__(2360);
// EXTERNAL MODULE: ./src/helpers/useDebounce.ts
var useDebounce = __webpack_require__(28173);
// EXTERNAL MODULE: ./src/helpers/constants.ts
var constants = __webpack_require__(65944);
// EXTERNAL MODULE: ./src/Modules/WorkingHours/index.ts
var WorkingHours = __webpack_require__(19384);
// EXTERNAL MODULE: ./src/helpers/common.ts
var common = __webpack_require__(88132);
// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js
var jsx_runtime = __webpack_require__(44414);
;// ./src/Components/Organisms/SiteSettings/OrganizationSettings/organizationModal.tsx
const OrganizationModal=props=>{var _Object$entries,_recordData$data,_recordData$data2,_recordData$data3,_recordData$data4,_recordData$data5,_recordData$data6,_recordData$data7,_recordData$data8;const{openModal,onCancel,type,record,reloadTableData,permissions:{createOrganization,updateOrganization}}=props;const[form]=es_form/* default */.A.useForm();const module=new Organization/* OrganizationModule */.I();const workingHourModule=new WorkingHours/* WorkingHoursModule */.x();const[recordData,setRecordData]=(0,react.useState)();const[workingHours,setWorkingHours]=(0,react.useState)({isLoading:true,data:[]});const[isBranch,setIsBranch]=(0,react.useState)(false);// Organization Search Term
const[searchTermOrganization,setSearchTermOrganization]=(0,react.useState)("");const debouncedSearchTermOrganization=(0,useDebounce/* useDebounce */.d)(searchTermOrganization,500);const[organizationOptions,setOrganizationOptions]=(0,react.useState)([]);// Organization Search
const onOrganizationSearch=()=>{if(debouncedSearchTermOrganization){module.getAllRecords({name:debouncedSearchTermOrganization,fetchParentOnly:true}).then(res=>{const{data}=res;setOrganizationOptions(prev=>{var _data$data;// if the data is already present in the state, then don't add it again
const filteredData=data===null||data===void 0?void 0:(_data$data=data.data)===null||_data$data===void 0?void 0:_data$data.filter(item=>{return!(prev!==null&&prev!==void 0&&prev.find(prevItem=>prevItem.id===item.id));});// add the new data to the existing data
return[...prev,...filteredData];});}).catch(err=>{message/* default */.Ay.error(err.response.data.message);});}};(0,react.useEffect)(()=>{onOrganizationSearch();},[debouncedSearchTermOrganization]);const handleErrors=err=>{const error=(0,error_handler/* errorHandler */.r)(err);if(typeof error.message=="string"){setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:error.message}));}else{let errData=(0,ServerErrorHandler/* HandleServerErrors */.p)(error.message,[]);form.setFields(errData);setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));}};const handleAlertClose=()=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));};const getDataBySlug=(0,react.useCallback)(()=>{module.getRecordById(record).then(res=>{if(res.data&&res.data.data){form.setFieldsValue((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data.data),{},{type:String(res.data.data.type),isPublished:res.data.data.isPublished}));setIsBranch(Number(res.data.data.type)===2);setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data),{},{loading:false}));}}).catch(err=>{handleErrors(err);});},[form,record,module]);(0,react.useEffect)(()=>{if(type==="edit"){setRecordData({loading:true});getDataBySlug();}else{form.resetFields();}},[openModal,type,form]);(0,react.useEffect)(()=>{workingHourModule.getAllRecords().then(res=>{let data=res.data;setWorkingHours((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},workingHours),{},{data:data===null||data===void 0?void 0:data.data,isLoading:false}));}).catch(err=>{let error=(0,common/* handleError */.H4)(err);message/* default */.Ay.error(error);setWorkingHours((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},workingHours),{},{isLoading:false}));});},[]);const onFinish=formValues=>{const formData=new FormData();const excludeFields=["logo","digitalStamp"];Object.entries(formValues).forEach(ele=>{if(!excludeFields.includes(ele[0])){if(ele[1]&&ele[1]!==null){formData.append(ele[0],ele[1]);}}});if(formValues["logo"]&&typeof formValues["logo"]!=="string"&&formValues["logo"]["fileList"].length>0){formData.append("logo",formValues["logo"]["fileList"][0]["originFileObj"]);}if(formValues["digitalStamp"]&&typeof formValues["digitalStamp"]!=="string"&&formValues["digitalStamp"]["fileList"].length>0){formData.append("digitalStamp",formValues["digitalStamp"]["fileList"][0]["originFileObj"]);}setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{buttonLoading:true}));switch(type){case"edit":{if(updateOrganization===true){module.updateRecord(formData,record).then(res=>{reloadTableData();onCancel();setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to update this record");}break;}case"new":{if(createOrganization===true){module.createRecord(formData).then(res=>{reloadTableData();onCancel();setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to create this record");}break;}}};return/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomModal */.jo,{visible:openModal,closable:true,onCancel:onCancel,titleText:type==="edit"?"Edit Organization":"Add New Organization",showFooter:false,children:recordData!==null&&recordData!==void 0&&recordData.loading?/*#__PURE__*/(0,jsx_runtime.jsx)(Skeletons/* default */.A,{items:10}):/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{className:styles_module/* default */.A.form,onFinish:onFinish,form:form,children:[(recordData===null||recordData===void 0?void 0:recordData.error)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomErrorAlert */.WZ,{description:recordData===null||recordData===void 0?void 0:recordData.error,isClosable:true,onClose:handleAlertClose}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"name",rules:[{required:true,message:"Please add a name"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Name",asterisk:true,type:"text",placeHolder:"Enter organization name"})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"organizationCode",rules:[{required:true,message:"Please add a code"}],help:/*#__PURE__*/(0,jsx_runtime.jsx)("small",{children:"This code will be used as a prefix to quotation, invoices. Eg: INV-DATP3400, INV-LUX2300, QU-DATP3400"}),children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Organization Code",asterisk:true,type:"text",placeHolder:"Enter organization code"})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"description",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Description",type:"text",placeHolder:"Enter description"})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"taxRegistrationNumber",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Tax Registration Number",type:"text",placeHolder:"Enter tax registration number"})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"bankAccountNumber",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Bank Account Number",type:"text",placeHolder:"Enter bank account number"})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"bankIBAN",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Bank IBAN Number",type:"text",placeHolder:"Enter bank IBAN number"})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"bankAccountHolderName",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Bank Account Holder Name",type:"text",placeHolder:"Bank Account Holder Name"})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"bankName",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Bank Name",type:"text",placeHolder:"Enter name"})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"bankSwiftCode",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Bank Swift Code",type:"text",placeHolder:"Enter Bank Swift Code"})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"email",rules:[{required:true,message:"Please add a email",type:"email"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Email",asterisk:true,type:"text",placeHolder:"Enter email"})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)(space/* default */.A.Compact,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{style:{width:'15%'},name:"phoneCode",rules:[{required:true,message:"Please add phone code",max:3}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Phone code",asterisk:true,type:"text",placeHolder:"Enter code",defaultValue:"971"})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{style:{width:'85%'},name:"phone",rules:[{required:true,message:"Please add phone number"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Phone",asterisk:true,type:"text",placeHolder:"Enter phone"})})]})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"whatsapp",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Whatsapp",type:"text",placeHolder:"Enter whatsapp"})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"address",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Address",type:"text",placeHolder:"Enter address"})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"locationMap",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Location map",type:"text",placeHolder:"Enter Location map"})})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"type",rules:[{required:true,message:"Please select a type"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* SelectWithSearch */.fd,{label:"Select Organization Type",notFoundDescription:"No organization type found., Please search for organization type.",onSearch:()=>{},options:(_Object$entries=Object.entries(commonEnums/* OrganizationTypes */.NV))===null||_Object$entries===void 0?void 0:_Object$entries.map(_ref=>{let[key,value]=_ref;return{label:value,value:key};}),onChange:value=>{form.setFieldsValue({type:value});setIsBranch(Number(value)===2);}})}),isBranch&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"parentId",rules:[{required:true,message:"Please select a organization"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* SelectWithSearch */.fd,{label:"Select Organization",notFoundDescription:"No Organizations found., Please search for Organizations.",onSearch:value=>setSearchTermOrganization(value),options:organizationOptions===null||organizationOptions===void 0?void 0:organizationOptions.map(item=>({label:item.name,value:item.id})),onChange:value=>form.setFieldsValue({parentId:value})})})})]}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"workingHoursId",rules:[{required:true,message:"Please select a working hour for the company"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomSelect */.Ae,{label:"Choose working hour",asterisk:true,style:{borderWidth:"2px"},placeholder:"Select Working Hour",options:workingHours===null||workingHours===void 0?void 0:workingHours.data.map(ele=>({label:ele.title,value:ele.id}))})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* ImageUploader */.GA,{name:"logo",customLabel:"Upload logo here",defaultFileList:type==="edit"&&recordData&&((_recordData$data=recordData.data)===null||_recordData$data===void 0?void 0:_recordData$data.logo)&&[{uid:(_recordData$data2=recordData.data)===null||_recordData$data2===void 0?void 0:_recordData$data2.id,name:(_recordData$data3=recordData.data)===null||_recordData$data3===void 0?void 0:_recordData$data3.logo,status:"done",url:constants/* RESOURCE_BASE_URL */.to+((_recordData$data4=recordData.data)===null||_recordData$data4===void 0?void 0:_recordData$data4.logo)}]})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* ImageUploader */.GA,{name:"digitalStamp",customLabel:"Upload digital stamp here",defaultFileList:type==="edit"&&recordData&&((_recordData$data5=recordData.data)===null||_recordData$data5===void 0?void 0:_recordData$data5.digitalStamp)&&[{uid:(_recordData$data6=recordData.data)===null||_recordData$data6===void 0?void 0:_recordData$data6.id,name:(_recordData$data7=recordData.data)===null||_recordData$data7===void 0?void 0:_recordData$data7.digitalStamp,status:"done",url:constants/* RESOURCE_BASE_URL */.to+((_recordData$data8=recordData.data)===null||_recordData$data8===void 0?void 0:_recordData$data8.digitalStamp)}]})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex justify-end",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{size:"normal",fontSize:"sm",onClick:onCancel,type:"plain",children:"Cancel"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:recordData===null||recordData===void 0?void 0:recordData.buttonLoading,children:type==="edit"?"Submit":"Add Organization"})]})]})});};
// EXTERNAL MODULE: ./node_modules/antd/es/popconfirm/index.js + 1 modules
var popconfirm = __webpack_require__(56231);
// EXTERNAL MODULE: ./node_modules/antd/es/table/index.js + 96 modules
var table = __webpack_require__(41821);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/DeleteOutlined.js
var DeleteOutlined = __webpack_require__(78433);
// EXTERNAL MODULE: ./src/Components/Atoms/Headings/index.tsx
var Headings = __webpack_require__(35751);
// EXTERNAL MODULE: ./src/Components/Atoms/Switch/index.tsx
var Switch = __webpack_require__(44394);
// EXTERNAL MODULE: ./node_modules/react-redux/es/index.js + 21 modules
var es = __webpack_require__(98341);
;// ./src/Components/Organisms/SiteSettings/OrganizationSettings/styles.module.scss
// extracted by mini-css-extract-plugin
/* harmony default export */ const OrganizationSettings_styles_module = ({"logoImage":"styles_logoImage__5mZDn","resetWrap":"styles_resetWrap__6B6CW","freeText":"styles_freeText__wN5Eu","actions":"styles_actions__apaJ3","bg__red":"styles_bg__red__zCu-M","form":"styles_form__2ladD","addLanguagesWrap":"styles_addLanguagesWrap__sgEd3","addLanguages":"styles_addLanguages__EaiB9","upload":"styles_upload__NG0d7","footer":"styles_footer__zfS+p","dropdown":"styles_dropdown__JP1G2","overlay":"styles_overlay__+i6WR","overlay_item":"styles_overlay_item__oD1eB","overlay_card_item":"styles_overlay_card_item__wuAbE","viewIcon":"styles_viewIcon__yZuK8","overlay_popConfirm":"styles_overlay_popConfirm__oaPRy","disabledButton":"styles_disabledButton__RA2-a","freeBtn":"styles_freeBtn__iZkqc","openingHours":"styles_openingHours__I0-Wp","container":"styles_container__Tvk+B","wrapper":"styles_wrapper__f2YoZ","title":"styles_title__9qY1Y","closed":"styles_closed__SCUxS"});
;// ./src/Components/Organisms/SiteSettings/OrganizationSettings/tableColumns.tsx
const ActionComponent=props=>{const{record,onEditIconClick,reloadTableData,permissions:{deleteOrganization}}=props;const[actionState,setActionState]=(0,react.useState)({confirmLoading:false,openPopConfirm:false});const module=new Organization/* OrganizationModule */.I();const handleDelete=()=>{setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{confirmLoading:true}));if(deleteOrganization===false){message/* default */.Ay.error("You don't have permission to delete this record, please contact your admin.");setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false}));return;}module.deleteRecord(record.id).then(res=>{setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false,confirmLoading:false}));reloadTableData();}).catch(err=>{setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{confirmLoading:false}));});};const showPopconfirm=()=>{setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:true}));};return/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.actions,children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{onClick:()=>onEditIconClick(record),children:/*#__PURE__*/(0,jsx_runtime.jsx)("img",{src:"/images/editicon.svg",alt:""})}),/*#__PURE__*/(0,jsx_runtime.jsx)(popconfirm/* default */.A,{open:actionState.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:handleDelete,onCancel:()=>setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false})),okButtonProps:{loading:actionState.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:visible=>{if(!visible){setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false}));}},children:/*#__PURE__*/(0,jsx_runtime.jsx)(DeleteOutlined/* default */.A,{className:styles_module/* default */.A.bg__red,onClick:showPopconfirm})})]});};function TableComponent(props){const{tableData,tableLoading,onEditIconClick,reloadTableData,meta,filters}=props;const{userPermissions}=(0,es/* useSelector */.d4)(state=>state.usersReducer);const permissions=userPermissions;const module=new Organization/* OrganizationModule */.I();const onIsPublishedChange=(checked,recordId)=>{return module.updateRecord({isPublished:checked},recordId);};const columns=[{title:"S.No",dataIndex:"index",key:"index",render:(text,record,index)=>index+1,width:"5%"},{title:"Title",dataIndex:"name",key:"name",render:(text,record)=>{var _record$WorkingHours;return/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Headings/* default */.A,{color:"dark-main",size:"sm",weight:"bold",children:"".concat(record.organizationCode," - ").concat(text)}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:OrganizationSettings_styles_module.container,children:record===null||record===void 0?void 0:(_record$WorkingHours=record.WorkingHours)===null||_record$WorkingHours===void 0?void 0:_record$WorkingHours.hours.map((ele,index)=>/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:OrganizationSettings_styles_module.wrapper,children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:OrganizationSettings_styles_module.title,children:ele.name}),ele.closed?/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:OrganizationSettings_styles_module.closed,children:"Closed"}):/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("span",{children:[ele.open," - ",ele.close]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("span",{children:[ele.totalHours," hours"]})]})]})},"opening-hours"+index+Math.random()*9999))})]});},width:"280px"},{title:"Logo",dataIndex:"logo",key:"logo",render:(text,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)("img",{width:50,height:50,src:constants/* RESOURCE_BASE_URL */.to+record.logo,style:{objectFit:'contain'}})},{title:"Type",dataIndex:"type",key:"type",render:text=>/*#__PURE__*/(0,jsx_runtime.jsx)(Headings/* default */.A,{color:"dark-main",size:"sm",weight:"bold",children:commonEnums/* OrganizationTypes */.NV[text]})},{title:"Published",dataIndex:"isPublished",key:"isPublished",render:(checked,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(Switch/* Switch */.d,{checked:checked,onChange:onIsPublishedChange,recordId:record.id,allowChange:permissions.updateOrganization})},{title:"Actions",dataIndex:"actions",key:"actions",render:(text,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(ActionComponent,{record:record,onEditIconClick:onEditIconClick,reloadTableData:reloadTableData,permissions:permissions})}];return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:styles_module/* default */.A.antdTableWrapper,children:/*#__PURE__*/(0,jsx_runtime.jsx)(table/* default */.A,{sticky:true,dataSource:tableData,columns:columns,pagination:{current:meta===null||meta===void 0?void 0:meta.page,total:meta===null||meta===void 0?void 0:meta.total,hideOnSinglePage:true,pageSize:meta===null||meta===void 0?void 0:meta.perPage,onChange(page,pageSize){reloadTableData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},filters),{},{page:page,perPage:pageSize}));}},scroll:{x:991},loading:tableLoading,rowKey:record=>"organization-".concat(record.id)})});}
// EXTERNAL MODULE: ./src/Components/Organisms/Common/styles.module.scss
var Common_styles_module = __webpack_require__(96019);
;// ./src/Modules/Organization/permissions.ts
let OrgPermissionsEnum=/*#__PURE__*/function(OrgPermissionsEnum){OrgPermissionsEnum["CREATE"]="createOrganization";OrgPermissionsEnum["UPDATE"]="updateOrganization";OrgPermissionsEnum["DELETE"]="deleteOrganization";OrgPermissionsEnum["READ"]="readOrganization";OrgPermissionsEnum["READ_ALL"]="readAllOrganization";OrgPermissionsEnum["READ_ELIGIBLE_CREDITS_REFUND"]="readEligibleCreditsRefund";OrgPermissionsEnum["REQUEST_ELIGIBLE_CREDITS_REFUND"]="requestEligibleCreditsRefund";OrgPermissionsEnum["PUBLISH"]="publishOrganization";OrgPermissionsEnum["SUSPEND"]="suspendOrganization";OrgPermissionsEnum["CREATE_COMMENTS"]="createOrganizationComments";OrgPermissionsEnum["READ_COMMENTS"]="readOrganizationComments";OrgPermissionsEnum["DELETE_COMMENTS"]="deleteOrganizationComments";OrgPermissionsEnum["READ_CREDITS_TRANSACTION_HISTORY"]="readCreditsTransactionsHistory";return OrgPermissionsEnum;}({});
// EXTERNAL MODULE: ./src/Components/Atoms/ErrorCodes/index.tsx + 1 modules
var ErrorCodes = __webpack_require__(36250);
// EXTERNAL MODULE: ./src/hooks/index.ts + 5 modules
var hooks = __webpack_require__(91970);
;// ./src/Components/Organisms/SiteSettings/OrganizationSettings/index.tsx
const breadCrumbsData=[{text:"Home",isLink:true,path:"/"},{isLink:true,text:"Site Settings",path:"/siteSettings"},{isLink:false,text:"Organization Settings"}];function OrganizationSettings(){// available permissions for this module
const permissionSlug=(0,common/* getPermissionSlugs */.AH)(OrgPermissionsEnum);const{userPermissions}=(0,es/* useSelector */.d4)(state=>state.usersReducer);const permissions=userPermissions;const{readAllOrganization,createOrganization,updateOrganization}=permissions;const[currentEditType,setcurrentEditType]=(0,react.useState)({editType:"new",recordId:0,openModal:false});const module=new Organization/* OrganizationModule */.I();const[filters,setFilters]=(0,react.useState)({page:1,perPage:10});const{data,onRefresh,setData,loading,meta}=(0,hooks/* useFetchData */.Gs)({method:module.getAllRecords,initialQuery:(0,objectSpread2/* default */.A)({},filters)});const onCancelClick=()=>{if(createOrganization===false){message/* default */.Ay.error("You don't have permission to create new record");return;}setcurrentEditType((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},currentEditType),{},{openModal:!currentEditType.openModal,editType:"new"}));};const onEditIconClick=record=>{if(updateOrganization===false){message/* default */.Ay.error("You don't have permission to update this record");return;}setcurrentEditType((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},currentEditType),{},{editType:"edit",recordId:record.id,openModal:true}));};return/*#__PURE__*/(0,jsx_runtime.jsxs)(SiteSettings["default"],{permissionSlug:[...permissionSlug,"topupCredits"],children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* PageHeader */.zY,{heading:"Organizations",buttonText:"New Organization",onButtonClick:onCancelClick,breadCrumbData:breadCrumbsData,showAdd:createOrganization===true?true:false}),readAllOrganization===true&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:Common_styles_module/* default */.A.antdTableWrapper,children:/*#__PURE__*/(0,jsx_runtime.jsx)(TableComponent,{tableData:data,tableLoading:loading,onEditIconClick:onEditIconClick,reloadTableData:onRefresh,meta:meta,filters:filters})}),readAllOrganization===false&&/*#__PURE__*/(0,jsx_runtime.jsx)(ErrorCodes/* ErrorCode403 */.$t,{mainMessage:"You don't have permission to view this data"}),/*#__PURE__*/(0,jsx_runtime.jsx)(OrganizationModal,{record:currentEditType.recordId,type:currentEditType.editType,reloadTableData:onRefresh,onCancel:onCancelClick,openModal:currentEditType.openModal,permissions:permissions})]});}/* harmony default export */ const SiteSettings_OrganizationSettings = (OrganizationSettings);

/***/ }),

/***/ 42361:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   I: () => (/* binding */ OrganizationModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
/* harmony import */ var _modules_Common_config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(21073);
class OrganizationModule{constructor(){this.endPoint="organization";/**Get all organization records
     * @param query - query params
     */this.getAllRecords=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint,{params:query});};/**Get all organization records
     * @param query - query params
     */this.findPublished=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint+"/find-published",{params:query});};/**Get organization record by id
     * @param id - organization id
     */this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/").concat(id));};/**Delete organization record
    * @param id - organization id
    */this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete("".concat(this.endPoint,"/").concat(id));};/**Create new organization record
     * @param data - organization data
     */this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint,data,{headers:_modules_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};/**Update organization record
    * @param data - organization data
    * @param id - organization id
    */this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch("".concat(this.endPoint,"/").concat(id),data,{headers:_modules_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};this.getTenants=()=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("xero/getTenants");};}}

/***/ })

}]);