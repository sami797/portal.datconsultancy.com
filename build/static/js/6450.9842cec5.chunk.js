"use strict";
(self["webpackChunkdat_projects"] = self["webpackChunkdat_projects"] || []).push([[6450],{

/***/ 62390:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ Dashboard_SupportBoard)
});

// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js
var objectSpread2 = __webpack_require__(89379);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(9950);
// EXTERNAL MODULE: ./node_modules/antd/es/input/index.js + 5 modules
var input = __webpack_require__(16330);
// EXTERNAL MODULE: ./node_modules/antd/es/avatar/index.js + 3 modules
var avatar = __webpack_require__(75871);
// EXTERNAL MODULE: ./node_modules/antd/es/tooltip/index.js
var tooltip = __webpack_require__(81541);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/UserOutlined.js + 1 modules
var UserOutlined = __webpack_require__(79378);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/SearchOutlined.js
var SearchOutlined = __webpack_require__(52786);
// EXTERNAL MODULE: ./src/Components/Atoms/index.tsx + 12 modules
var Atoms = __webpack_require__(9394);
// EXTERNAL MODULE: ./src/Components/Templates/Layout/index.tsx + 28 modules
var Layout = __webpack_require__(81168);
// EXTERNAL MODULE: ./src/helpers/commonEnums.ts
var commonEnums = __webpack_require__(2360);
// EXTERNAL MODULE: ./src/Modules/Task/permissions.ts
var permissions = __webpack_require__(15659);
// EXTERNAL MODULE: ./src/Modules/Task/index.ts
var Task = __webpack_require__(12671);
// EXTERNAL MODULE: ./src/Components/Organisms/Dashboard/SupportBoard/TaskDetailsModal/index.tsx + 2 modules
var TaskDetailsModal = __webpack_require__(73656);
// EXTERNAL MODULE: ./node_modules/react-redux/es/index.js + 21 modules
var es = __webpack_require__(98341);
// EXTERNAL MODULE: ./node_modules/react-router-dom/dist/index.js
var dist = __webpack_require__(42074);
// EXTERNAL MODULE: ./node_modules/antd/es/message/index.js + 1 modules
var message = __webpack_require__(92759);
// EXTERNAL MODULE: ./node_modules/antd/es/skeleton/index.js + 11 modules
var skeleton = __webpack_require__(46005);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/FileOutlined.js
var FileOutlined = __webpack_require__(56272);
;// ./src/Components/Organisms/Dashboard/SupportBoard/KanbanBoard/styles.module.scss
// extracted by mini-css-extract-plugin
/* harmony default export */ const styles_module = ({"board":"styles_board__Ly6Pv","column":"styles_column__hXDAu","columnHead":"styles_columnHead__71OxV","kanbanItem":"styles_kanbanItem__5ehO2","kanbanItemBottom":"styles_kanbanItemBottom__V1Ki4","priorityPill":"styles_priorityPill__1L2Do","kanbanItemBottomBottom":"styles_kanbanItemBottomBottom__y6qTa","file":"styles_file__JqW7v"});
// EXTERNAL MODULE: ./node_modules/react-dnd/dist/core/DndProvider.js + 33 modules
var DndProvider = __webpack_require__(59767);
// EXTERNAL MODULE: ./node_modules/react-dnd/dist/hooks/useDrop/useDrop.js + 9 modules
var useDrop = __webpack_require__(89135);
// EXTERNAL MODULE: ./node_modules/react-dnd/dist/hooks/useDrag/useDrag.js + 9 modules
var useDrag = __webpack_require__(65325);
// EXTERNAL MODULE: ./node_modules/react-dnd-html5-backend/dist/index.js + 12 modules
var react_dnd_html5_backend_dist = __webpack_require__(72500);
// EXTERNAL MODULE: ./node_modules/immutability-helper/index.js
var immutability_helper = __webpack_require__(25984);
var immutability_helper_default = /*#__PURE__*/__webpack_require__.n(immutability_helper);
// EXTERNAL MODULE: ./src/helpers/constants.ts
var constants = __webpack_require__(65944);
// EXTERNAL MODULE: ./src/helpers/dateHandler.ts
var dateHandler = __webpack_require__(98933);
// EXTERNAL MODULE: ./node_modules/react-infinite-scroll-component/dist/index.es.js
var index_es = __webpack_require__(50416);
// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js
var jsx_runtime = __webpack_require__(44414);
;// ./src/Components/Organisms/Dashboard/SupportBoard/KanbanBoard/index.tsx
const KanbanBoard=props=>{const{searchParams,setSearchParams,tasks,setTasks,meta,setMeta,searchTerm,openDetailModal,setOpenDetailModal,setSelectedTask,module,isLoading}=props;const columns=[1,2,3];const moveTask=(0,react.useCallback)((dragIndex,hoverIndex)=>{const dragRow=tasks[dragIndex];setTasks(immutability_helper_default()(tasks,{$splice:[[dragIndex,1],[hoverIndex,0,dragRow]]}));module.updateOrder({order:dragIndex},dragRow.id).catch(err=>{if(err.message){message/* default */.Ay.error(err.message);}else{message/* default */.Ay.error('Something went wrong');}});},[tasks]);const changeTaskStatus=(0,react.useCallback)((index,status)=>{const task=tasks[index];if(task.status===status)return;let newTasks=[...tasks];newTasks[index].status=status;setTasks(newTasks);module.updateRecord({status:status},task.id).then(res=>{}).catch(err=>{if(err.message){message/* default */.Ay.error(err.message);}else{message/* default */.Ay.error('Something went wrong');}});},[tasks]);return/*#__PURE__*/(0,jsx_runtime.jsx)(DndProvider/* DndProvider */.Q,{backend:react_dnd_html5_backend_dist/* HTML5Backend */.t2,children:/*#__PURE__*/(0,jsx_runtime.jsx)("section",{className:styles_module.board,children:columns.map(column=>{var _meta,_meta2,_meta4,_meta5;return/*#__PURE__*/(0,jsx_runtime.jsx)(KanbanColumn,{status:column,changeTaskStatus:changeTaskStatus,children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module.column,children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module.columnHead,children:[commonEnums/* techSupportColumnLabels */.V8[column]," (",Number((_meta=meta[column-1])===null||_meta===void 0?void 0:_meta.total)?Number((_meta2=meta[column-1])===null||_meta2===void 0?void 0:_meta2.total):"",")"]}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(index_es/* default */.A,{dataLength:tasks.filter(item=>item.status===column).length,next:()=>{var _meta3;module.getAllRecords({status:column,page:Number((_meta3=meta[column-1])===null||_meta3===void 0?void 0:_meta3.page)+1}).then(res=>{setTasks([...tasks,...res.data.data]);const _temp=meta;_temp[column-1]=res.data.meta;setMeta(_temp);});},hasMore:Number((_meta4=meta[column-1])===null||_meta4===void 0?void 0:_meta4.pageCount)>Number((_meta5=meta[column-1])===null||_meta5===void 0?void 0:_meta5.page),loader:/*#__PURE__*/(0,jsx_runtime.jsx)(skeleton/* default */.A,{active:true}),height:'70vh',scrollThreshold:0.75,className:"infinite-scroll-wrap",children:isLoading?/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{display:'flex',flexDirection:'column',gap:'0.5rem'},children:Array(3).fill(0).map((_,index)=>/*#__PURE__*/(0,jsx_runtime.jsx)(skeleton/* default */.A.Input,{size:"large",active:true,style:{height:'3.5vw',width:'100%',borderRadius:'0.25rem'}},index))}):tasks===null||tasks===void 0?void 0:tasks.filter(item=>item.status===column).filter(task=>{var _task$title,_task$title$toLowerCa;return searchTerm?task===null||task===void 0?void 0:(_task$title=task.title)===null||_task$title===void 0?void 0:(_task$title$toLowerCa=_task$title.toLowerCase())===null||_task$title$toLowerCa===void 0?void 0:_task$title$toLowerCa.includes(searchTerm===null||searchTerm===void 0?void 0:searchTerm.toLowerCase()):true;}).map(item=>{var _item$_count,_item$AddedBy,_item$AddedBy2,_item$AddedBy3,_item$AddedBy4;return/*#__PURE__*/(0,jsx_runtime.jsx)(KanbanItem,{item:item,items:tasks,moveTask:moveTask,children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module.kanbanItem,onClick:()=>{setSelectedTask(item.id);setOpenDetailModal(!openDetailModal);searchParams.set("taskId",item.id.toString());setSearchParams(searchParams);},children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:item.title}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module.kanbanItemBottom,children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{style:{display:'flex',gap:6,alignItems:'flex-end'},children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:styles_module.cardBodyEnd,children:/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{color:'var(--color-light-300)',fontSize:'var(--font-size-xs)'},children:(0,dateHandler/* convertDate */.ic)(item.addedDate,"dd M,yy")})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{color:'var(--color-light-300)',fontSize:'var(--font-size-xs)'},children:(0,dateHandler/* convertDate */.ic)((item===null||item===void 0?void 0:item.taskEndOn)||"","dd MM,yy")}),(item===null||item===void 0?void 0:(_item$_count=item._count)===null||_item$_count===void 0?void 0:_item$_count.Resources)>0&&/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module.file,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(FileOutlined/* default */.A,{}),"\xA0",item._count.Resources]})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module.kanbanItemBottomBottom,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(avatar/* default.Group */.A.Group,{children:item.TaskMembers.map(member=>/*#__PURE__*/(0,jsx_runtime.jsx)(tooltip/* default */.A,{overlayInnerStyle:{borderRadius:'0.25rem',fontSize:'var(--font-size-sm)'},placement:item.status===3?"left":"bottom",title:member.User.firstName+" "+member.User.lastName,children:/*#__PURE__*/(0,jsx_runtime.jsx)(avatar/* default */.A,{size:25,style:{border:'0.5px solid var(--color-light-200)'},src:constants/* RESOURCE_BASE_URL */.to+member.User.profile,icon:/*#__PURE__*/(0,jsx_runtime.jsx)(UserOutlined/* default */.A,{})})},member.User.uuid))}),item.AddedBy&&/*#__PURE__*/(0,jsx_runtime.jsx)(tooltip/* default */.A,{overlayInnerStyle:{borderRadius:'0.25rem',fontSize:'var(--font-size-sm)'},placement:item.status===3?"left":"bottom",title:"Added by: "+((_item$AddedBy2=item.AddedBy)===null||_item$AddedBy2===void 0?void 0:_item$AddedBy2.firstName)+" "+((_item$AddedBy3=item.AddedBy)===null||_item$AddedBy3===void 0?void 0:_item$AddedBy3.lastName),children:/*#__PURE__*/(0,jsx_runtime.jsx)(avatar/* default */.A,{size:25,style:{border:'0.5px solid var(--color-light-200)'},src:constants/* RESOURCE_BASE_URL */.to+((_item$AddedBy4=item.AddedBy)===null||_item$AddedBy4===void 0?void 0:_item$AddedBy4.profile),icon:/*#__PURE__*/(0,jsx_runtime.jsx)(UserOutlined/* default */.A,{})})},(_item$AddedBy=item.AddedBy)===null||_item$AddedBy===void 0?void 0:_item$AddedBy.uuid)]})]})]})},item.id);})})})]})},column);})})});};/* harmony default export */ const SupportBoard_KanbanBoard = (KanbanBoard);const KanbanColumn=_ref=>{let{status,changeTaskStatus,children}=_ref;const ref=(0,react.useRef)(null);const[,drop]=(0,useDrop/* useDrop */.H)({accept:"card",drop(item){changeTaskStatus(item.index,status);}});drop(ref);return/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{style:{flexGrow:1},ref:ref,children:[" ",children]});};const KanbanItem=_ref2=>{let{children,item,items,moveTask}=_ref2;const ref=(0,react.useRef)(null);const index=items.indexOf(item);const[,drop]=(0,useDrop/* useDrop */.H)({accept:"card",collect:monitor=>{const{index:dragIndex}=monitor.getItem()||{};if(dragIndex===index){return{};}return{isOver:monitor.isOver(),dropClassName:dragIndex<index?' drop-over-downward':' drop-over-upward'};},drop:item=>{moveTask(item.index,index);}});const[{isDragging},drag]=(0,useDrag/* useDrag */.i)({type:"card",item:{index},collect:monitor=>({isDragging:monitor.isDragging()})});const opacity=isDragging?0:1;drop(drag(ref));return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{ref:ref,style:{opacity},children:children});};
// EXTERNAL MODULE: ./src/Components/Organisms/Dashboard/MyServices/TechSupport/create.tsx
var create = __webpack_require__(51550);
// EXTERNAL MODULE: ./src/helpers/common.ts
var common = __webpack_require__(88132);
;// ./src/Components/Organisms/Dashboard/SupportBoard/styles.module.scss
// extracted by mini-css-extract-plugin
/* harmony default export */ const SupportBoard_styles_module = ({"onlyMyTask":"styles_onlyMyTask__LTP5H","sortBy":"styles_sortBy__VX5QL"});
;// ./src/Components/Organisms/Dashboard/SupportBoard/index.tsx
const breadCrumbsData=[{text:"Home",isLink:true,path:"/"},{isLink:false,text:"Tech Support"}];const SupportBoard=()=>{const[isLoading,setIsLoading]=(0,react.useState)(false);const taskModule=new Task/* TaskModule */._();// get the saved searches id from the url 
const[searchParams,setSearchParams]=(0,dist/* useSearchParams */.ok)();const[isFirstRender,setIsFirstRender]=(0,react.useState)(true);const[openDetailModal,setOpenDetailModal]=(0,react.useState)(false);const[openTaskModal,setOpenTaskModal]=(0,react.useState)(false);const[selectedTask,setSelectedTask]=(0,react.useState)();const[taskMembers,setTaskMembers]=(0,react.useState)([]);const[tasks,setTasks]=(0,react.useState)([]);const[meta,setMeta]=(0,react.useState)(Array(3).fill({}));const[taskFilters,setTaskFilters]=(0,react.useState)({sortByField:'order',sortOrder:'asc',userIds:searchParams!==null&&searchParams!==void 0&&searchParams.get("userIds")?JSON.parse((searchParams===null||searchParams===void 0?void 0:searchParams.get("userIds"))||""):[]});const[searchTerm,setSearchTerm]=(0,react.useState)(searchParams.get("searchTerm"));const{userPermissions}=(0,es/* useSelector */.d4)(state=>state.usersReducer);// available permissions for the properties page
const permissionSlug=(0,common/* getPermissionSlugs */.AH)(permissions/* TaskPermissionsEnum */.X);const taskPermissions=userPermissions;const fetchData=async query=>{setIsLoading(true);try{const statuses=[1,2,3];const requests=statuses.map(status=>taskModule.getTechSupportRequest((0,objectSpread2/* default */.A)({status},query)));const results=await Promise.allSettled(requests);const tasks=[];const meta=Array(3).fill({});results.forEach((result,index)=>{if(result.status==='fulfilled'){tasks.push(...result.value.data.data);meta[index]=result.value.data.meta;}});setTasks(tasks);setMeta(meta);}catch(error){console.error(error,'Error fetching tasks');}finally{setIsLoading(false);}};(0,react.useEffect)(()=>{if(isFirstRender){if(searchParams.get("taskId")){setOpenDetailModal(!openDetailModal);setSelectedTask(Number(searchParams.get("taskId")));}setIsFirstRender(false);}},[]);(0,react.useEffect)(()=>{fetchData((0,objectSpread2/* default */.A)({},taskFilters));},[]);(0,react.useEffect)(()=>{const allUsers=[];tasks.forEach(task=>{task.TaskMembers.forEach(member=>{if(!allUsers.some(user=>user.User.id===member.User.id)){allUsers.push(member);}});});setTaskMembers(allUsers);},[tasks]);return/*#__PURE__*/(0,jsx_runtime.jsxs)(Layout/* default */.A,{permissionSlug:permissionSlug,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* PageHeader */.zY,{heading:"Tech Support",breadCrumbData:breadCrumbsData,showAdd:taskPermissions.createTask,buttonText:"Add New Request",onButtonClick:()=>setOpenTaskModal(!openTaskModal),filters:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(input/* default */.A,{allowClear:true,value:searchTerm||"",placeholder:"Search this board",onChange:event=>{var _event$target;setSearchTerm(event===null||event===void 0?void 0:(_event$target=event.target)===null||_event$target===void 0?void 0:_event$target.value);if(event.target.value){var _event$target2;searchParams.set("searchTerm",event===null||event===void 0?void 0:(_event$target2=event.target)===null||_event$target2===void 0?void 0:_event$target2.value.toLowerCase());setSearchParams(searchParams);}else{searchParams.delete("searchTerm");setSearchParams(searchParams);}},style:{width:220,borderRadius:'0.25rem'},suffix:/*#__PURE__*/(0,jsx_runtime.jsx)(SearchOutlined/* default */.A,{})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(avatar/* default.Group */.A.Group,{maxCount:5,children:taskMembers.map(member=>{var _taskFilters$userIds;return/*#__PURE__*/(0,jsx_runtime.jsx)(tooltip/* default */.A,{overlayInnerStyle:{borderRadius:'0.25rem',fontSize:'var(--font-size-sm)'},title:"".concat(member.User.firstName," ").concat(member.User.lastName),children:/*#__PURE__*/(0,jsx_runtime.jsx)(avatar/* default */.A,{size:32,onClick:()=>{var _userIds,_userIds4;let userIds=taskFilters.userIds;if(!((_userIds=userIds)!==null&&_userIds!==void 0&&_userIds.some(user=>user===member.User.id))){var _userIds2;(_userIds2=userIds)===null||_userIds2===void 0?void 0:_userIds2.push(member.User.id);}else{var _userIds3;userIds=(_userIds3=userIds)===null||_userIds3===void 0?void 0:_userIds3.filter(item=>item!==member.User.id);}if((_userIds4=userIds)!==null&&_userIds4!==void 0&&_userIds4.length){searchParams.set("userIds",JSON.stringify(userIds));}else{searchParams.delete("userIds");}setSearchParams(searchParams);fetchData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},taskFilters),{},{userIds}));setTaskFilters((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},taskFilters),{},{userIds}));},style:{border:(_taskFilters$userIds=taskFilters.userIds)!==null&&_taskFilters$userIds!==void 0&&_taskFilters$userIds.includes(member.User.id)?'2px solid var(--color-primary-main)':'0.5px solid var(--color-light-200)',cursor:'pointer'},src:constants/* RESOURCE_BASE_URL */.to+member.User.profile,icon:/*#__PURE__*/(0,jsx_runtime.jsx)(UserOutlined/* default */.A,{})})},member.User.uuid);})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:SupportBoard_styles_module.sortBy,children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"radio",label:"Sort By",name:"sortBy",options:Object.entries(commonEnums/* TaskSort */.ms).map(_ref=>{let[key,value]=_ref;return{label:key,value:value};}),value:taskFilters===null||taskFilters===void 0?void 0:taskFilters.sortByField,onChange:e=>setTaskFilters((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},taskFilters),{},{sortByField:e.target.value})),onReset:()=>{const _temp=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},taskFilters),{},{sortByField:undefined});setTaskFilters(_temp);fetchData(_temp);},onUpdate:function(){let taskFilter=arguments.length>0&&arguments[0]!==undefined?arguments[0]:taskFilters;fetchData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},taskFilter),{},{sortByField:taskFilters.sortByField,sortOrder:taskFilter.sortOrder}));},withSort:true})})]})}),/*#__PURE__*/(0,jsx_runtime.jsx)(SupportBoard_KanbanBoard,{tasks:tasks,setTasks:setTasks,searchParams:searchParams,setSearchParams:setSearchParams,searchTerm:searchTerm,meta:meta,setMeta:setMeta,openDetailModal:openDetailModal,setOpenDetailModal:setOpenDetailModal,setSelectedTask:setSelectedTask,isLoading:isLoading,module:taskModule}),selectedTask&&/*#__PURE__*/(0,jsx_runtime.jsx)(TaskDetailsModal/* TaskDetailsModal */.H,{openModal:openDetailModal,onCancel:()=>{setOpenDetailModal(!openDetailModal);searchParams.delete("taskId");setSearchParams(searchParams);},id:selectedTask,onUpdate:fetchData}),openTaskModal&&/*#__PURE__*/(0,jsx_runtime.jsx)(create/* TechSupportModal */.n,{reloadTableData:fetchData,onCancel:()=>setOpenTaskModal(!openTaskModal),openModal:openTaskModal,permissions:taskPermissions})]});};/* harmony default export */ const Dashboard_SupportBoard = (SupportBoard);

/***/ })

}]);