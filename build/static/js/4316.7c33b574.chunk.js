"use strict";
(self["webpackChunkdat_projects"] = self["webpackChunkdat_projects"] || []).push([[4316],{

/***/ 54316:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {


// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  C: () => (/* binding */ EmployeeModal)
});

// EXTERNAL MODULE: ./node_modules/antd/es/drawer/index.js + 6 modules
var drawer = __webpack_require__(73780);
// EXTERNAL MODULE: ./node_modules/antd/es/tabs/index.js + 22 modules
var tabs = __webpack_require__(92555);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js
var objectSpread2 = __webpack_require__(89379);
// EXTERNAL MODULE: ./node_modules/antd/es/select/index.js + 30 modules
var es_select = __webpack_require__(97554);
// EXTERNAL MODULE: ./node_modules/antd/es/form/index.js + 18 modules
var es_form = __webpack_require__(10678);
// EXTERNAL MODULE: ./node_modules/antd/es/message/index.js + 1 modules
var message = __webpack_require__(92759);
// EXTERNAL MODULE: ./node_modules/antd/es/input-number/index.js + 10 modules
var input_number = __webpack_require__(40202);
// EXTERNAL MODULE: ./node_modules/antd/es/empty/index.js + 2 modules
var empty = __webpack_require__(90247);
// EXTERNAL MODULE: ./node_modules/antd/es/date-picker/index.js + 56 modules
var date_picker = __webpack_require__(4132);
// EXTERNAL MODULE: ./src/Components/Atoms/index.tsx + 12 modules
var Atoms = __webpack_require__(9394);
// EXTERNAL MODULE: ./src/Components/Organisms/Common/styles.module.scss
var styles_module = __webpack_require__(96019);
;// ./src/Components/Organisms/Dashboard/Employees/Form/styles.module.scss
// extracted by mini-css-extract-plugin
/* harmony default export */ const Form_styles_module = ({"Tasktitle":"styles_Tasktitle__vTJxC","resourceWrap":"styles_resourceWrap__F4Mm+","deleteWrap":"styles_deleteWrap__rqqA4","image":"styles_image__OeA5O","date_picker":"styles_date_picker__ab70w"});
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(9950);
// EXTERNAL MODULE: ./src/helpers/constants.ts
var constants = __webpack_require__(65944);
// EXTERNAL MODULE: ./src/Components/Atoms/ServerErrorHandler/index.tsx
var ServerErrorHandler = __webpack_require__(13321);
// EXTERNAL MODULE: ./src/helpers/error-handler.ts
var error_handler = __webpack_require__(38266);
// EXTERNAL MODULE: ./src/Modules/User/index.ts
var User = __webpack_require__(47645);
// EXTERNAL MODULE: ./src/Modules/Country/index.ts
var Country = __webpack_require__(83584);
// EXTERNAL MODULE: ./src/helpers/useDebounce.ts
var useDebounce = __webpack_require__(28173);
// EXTERNAL MODULE: ./src/Modules/Organization/index.ts
var Organization = __webpack_require__(42361);
// EXTERNAL MODULE: ./src/Modules/Roles/index.ts
var Roles = __webpack_require__(32027);
// EXTERNAL MODULE: ./src/Modules/Department/index.ts
var Department = __webpack_require__(98924);
// EXTERNAL MODULE: ./src/helpers/commonEnums.ts
var commonEnums = __webpack_require__(2360);
// EXTERNAL MODULE: ./src/Components/Organisms/Skeletons/index.tsx
var Skeletons = __webpack_require__(70619);
// EXTERNAL MODULE: ./src/helpers/common.ts
var common = __webpack_require__(88132);
// EXTERNAL MODULE: ./node_modules/moment/moment.js
var moment = __webpack_require__(59051);
var moment_default = /*#__PURE__*/__webpack_require__.n(moment);
// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js
var jsx_runtime = __webpack_require__(44414);
;// ./src/Components/Organisms/Dashboard/Employees/Form/Basic.tsx
const{Option}=es_select/* default */.A;const EmployeeBasicForm=props=>{var _recordData$data2,_recordData$data3,_recordData$data4,_recordData$data4$Dep,_recordData$data5,_recordData$data5$Org,_recordData$data6,_recordData$data6$Man,_recordData$data7,_recordData$data8,_recordData$data9,_recordData$data10,_recordData$data11;const{type,record,openModal,onCancel,createUser,updateUser,manageAllUser,reloadTableData}=props;const[form]=es_form/* default */.A.useForm();const module=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const[organizations,setOrganizations]=(0,react.useState)([]);const[searchTermManager,setSearchTermManager]=(0,react.useState)("");const debouncedSearchTermManager=(0,useDebounce/* useDebounce */.d)(searchTermManager,500);const[managers,setManagers]=(0,react.useState)([]);const[searchTermDepartment,setSearchTermDepartment]=(0,react.useState)("");const debouncedSearchTermDepartment=(0,useDebounce/* useDebounce */.d)(searchTermDepartment,500);const[departments,setDepartments]=(0,react.useState)([]);const[isFirstRender,setIsFirstRnder]=(0,react.useState)(true);const orgModule=(0,react.useMemo)(()=>new Organization/* OrganizationModule */.I(),[]);const userModule=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const departmentModule=(0,react.useMemo)(()=>new Department/* DepartmentModule */.d(),[]);const countryModule=(0,react.useMemo)(()=>new Country/* CountryModule */.j(),[]);const rolesModule=(0,react.useMemo)(()=>new Roles/* RolesModule */.C(),[]);const[recordData,setRecordData]=(0,react.useState)();const[countries,setCountries]=(0,react.useState)([]);const[roles,setRoles]=(0,react.useState)([]);const onOrgSearch=()=>{orgModule.findPublished().then(res=>{setOrganizations(prev=>{var _res$data,_res$data$data;// if the data is already present in the state, then don't add it again
const filteredData=res===null||res===void 0?void 0:(_res$data=res.data)===null||_res$data===void 0?void 0:(_res$data$data=_res$data.data)===null||_res$data$data===void 0?void 0:_res$data$data.filter(item=>{return!(prev!==null&&prev!==void 0&&prev.find(prevItem=>prevItem.id===item.id));});// add the new data to the existing data
return[...prev,...filteredData];});}).catch(err=>{const errorMessage=(0,common/* handleError */.H4)(err);message/* default */.Ay.error(errorMessage||"Something went wrong");});};(0,react.useEffect)(()=>{onOrgSearch();},[]);const onManagerSearch=(0,react.useCallback)(()=>{if(debouncedSearchTermManager){userModule.getAllRecords({name:debouncedSearchTermManager}).then(res=>{setManagers(prev=>{var _res$data2,_res$data2$data;// if the data is already present in the state, then don't add it again
const filteredData=res===null||res===void 0?void 0:(_res$data2=res.data)===null||_res$data2===void 0?void 0:(_res$data2$data=_res$data2.data)===null||_res$data2$data===void 0?void 0:_res$data2$data.filter(item=>{return!(prev!==null&&prev!==void 0&&prev.find(prevItem=>prevItem.id===item.id));});// add the new data to the existing data
return[...prev,...filteredData];});}).catch(err=>{message/* default */.Ay.error(err.response.data.message);});}},[orgModule,debouncedSearchTermManager]);(0,react.useEffect)(()=>{onManagerSearch();},[onManagerSearch]);const onDepartmentSearch=(0,react.useCallback)(()=>{if(debouncedSearchTermDepartment||isFirstRender){departmentModule.getAllPublishedRecords({title:debouncedSearchTermDepartment}).then(res=>{setDepartments(prev=>{var _res$data3,_res$data3$data;// if the data is already present in the state, then don't add it again
const filteredData=res===null||res===void 0?void 0:(_res$data3=res.data)===null||_res$data3===void 0?void 0:(_res$data3$data=_res$data3.data)===null||_res$data3$data===void 0?void 0:_res$data3$data.filter(item=>{return!(prev!==null&&prev!==void 0&&prev.find(prevItem=>prevItem.id===item.id));});// add the new data to the existing data
return[...prev,...filteredData];});setIsFirstRnder(false);}).catch(err=>{message/* default */.Ay.error(err.response.data.message);setIsFirstRnder(false);});}},[orgModule,debouncedSearchTermDepartment]);(0,react.useEffect)(()=>{onDepartmentSearch();},[onDepartmentSearch]);const handleErrors=err=>{const error=(0,error_handler/* errorHandler */.r)(err);if(typeof error.message=="string"){setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:error.message}));}else{let errData=(0,ServerErrorHandler/* HandleServerErrors */.p)(error.message,[]);form.setFields(errData);setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));}};const handleAlertClose=()=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));};// Get data for the selected record from the api and set it in the form
const getDataBySlug=(0,react.useCallback)(()=>{module.getRecordById(record).then(res=>{var _res$data4,_res$data5,_res$data5$data,_res$data6,_res$data6$data;const data=res===null||res===void 0?void 0:(_res$data4=res.data)===null||_res$data4===void 0?void 0:_res$data4.data;const organization=data===null||data===void 0?void 0:data.Organization;const manager=res===null||res===void 0?void 0:(_res$data5=res.data)===null||_res$data5===void 0?void 0:(_res$data5$data=_res$data5.data)===null||_res$data5$data===void 0?void 0:_res$data5$data.Manager;const department=res===null||res===void 0?void 0:(_res$data6=res.data)===null||_res$data6===void 0?void 0:(_res$data6$data=_res$data6.data)===null||_res$data6$data===void 0?void 0:_res$data6$data.Department;const{dateOfJoining,lastWorkingDate}=data;if(data){Object.keys(data).forEach(key=>data[key]===undefined||data[key]===null||data[key]==="undefined"?delete data[key]:{});form.setFieldsValue((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},data),{},{isPublished:data.isPublished,organizationId:organization===null||organization===void 0?void 0:organization.id,managerId:manager===null||manager===void 0?void 0:manager.id,departmentId:department===null||department===void 0?void 0:department.id,status:String(data.status),dateOfJoining:dateOfJoining?moment_default()(data.dateOfJoining):null,lastWorkingDate:lastWorkingDate?moment_default()(data.lastWorkingDate):null}));setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data),{},{loading:false}));}if(manager){userModule.getRecordById(manager.id).then(res=>{var _res$data7;setManagers([res===null||res===void 0?void 0:(_res$data7=res.data)===null||_res$data7===void 0?void 0:_res$data7.data]);}).catch(err=>{message/* default */.Ay.error(err.response.data.message);});}}).catch(err=>{handleErrors(err);});},[form,record,module,orgModule]);const getRoles=(0,react.useCallback)(()=>{if(type==="edit")return;rolesModule.getAllRecords().then(res=>{var _res$data8;if(res.data&&(_res$data8=res.data)!==null&&_res$data8!==void 0&&_res$data8.data){var _res$data9;setRoles((_res$data9=res.data)===null||_res$data9===void 0?void 0:_res$data9.data);}}).catch(err=>{handleErrors(err);});},[rolesModule,type]);const getCountryList=(0,react.useCallback)(()=>{countryModule.getAvailableRecords().then(res=>{if(res.data&&res.data.data){setCountries(res.data.data);}});},[countryModule]);(0,react.useEffect)(()=>{if(type==="edit"){setRecordData({loading:true});// fetch data by slug or id
getDataBySlug();// fetch the countries
getCountryList();}else{// fetch the countries
getCountryList();form.resetFields();getRoles();}setSearchTermDepartment("");},[openModal,type,form,getDataBySlug,getCountryList,getRoles]);const onFinish=formValues=>{/** 
    * save the role ids in a variable and delete it from the formValues
    * so that it doesn't get sent to the server as a part of the form 
    * data when creating a new user
    * */const roleIds=formValues.roleIds;delete formValues.roleIds;// set default value for displayOrgContact
if(formValues.displayOrgContact===undefined){formValues.displayOrgContact=false;}setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{buttonLoading:true}));const formData=new FormData();const excludeFields=["profile","translations"];Object.entries(formValues).forEach(ele=>{if(!excludeFields.includes(ele[0])&&ele[1]){formData.append(ele[0],ele[1]);}});if(formValues["profile"]&&typeof formValues["profile"]!=="string"&&formValues["profile"]["fileList"].length>0){formData.append("profile",formValues["profile"]["fileList"][0]["originFileObj"]);}if(formValues.translations){formValues.translations.forEach((item,index)=>{formData.append("translations[".concat(index+1,"][language]"),item.language);formData.append("translations[".concat(index+1,"][title]"),item.title);});}if(formValues.allDataAccessRestrictedTo&&formValues.allDataAccessRestrictedTo.length>0){formValues.allDataAccessRestrictedTo.forEach((orgId,index)=>{formData.append("dataAccessRestrictedTo[".concat(index,"]"),String(orgId));});}else{formData.append("dataAccessRestrictedTo[]",'');}//TODO: Fix phone and phone code input group
formData.append('phoneCode',"971");switch(type){case"edit":{if(updateUser===true){var _recordData$data;module.updateRecord(formData,recordData===null||recordData===void 0?void 0:(_recordData$data=recordData.data)===null||_recordData$data===void 0?void 0:_recordData$data.id).then(()=>{reloadTableData();setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.success("User updated successfully");}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to update this user");}break;}case"new":{if(createUser===true){module.createRecord(formData).then(async res=>{var _res$data10,_res$data10$data;// user id
const id=(_res$data10=res.data)===null||_res$data10===void 0?void 0:(_res$data10$data=_res$data10.data)===null||_res$data10$data===void 0?void 0:_res$data10$data.id;await module.addRoles({roleIds:roleIds},id).then(()=>{reloadTableData();setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.success("User created successfully");}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to create a new user");}break;}}};return recordData!==null&&recordData!==void 0&&recordData.loading?/*#__PURE__*/(0,jsx_runtime.jsx)(Skeletons/* default */.A,{items:10}):/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{className:styles_module/* default */.A.form,onFinish:onFinish,form:form,children:[(recordData===null||recordData===void 0?void 0:recordData.error)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomErrorAlert */.WZ,{description:recordData===null||recordData===void 0?void 0:recordData.error,isClosable:true,onClose:handleAlertClose}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"firstName",rules:[{required:type==="new"?true:false,message:"Please add first name"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"First Name",asterisk:type==="new",type:"text"})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"lastName",rules:[{required:type==="new"?true:false,message:"Please add last name"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Last Name",asterisk:type==="new",type:"text"})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"email",rules:[{required:type==="new"?true:false,message:"Please add email"},{type:"email",message:"Please add valid email"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{disabled:!manageAllUser,size:"w100",label:"Email",asterisk:type==="new",type:"email"})}),type==="new"&&/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"password",rules:[{required:true,message:"Please add password"},{min:6,message:"Password must be at least 6 characters"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Password",asterisk:true,type:"password"})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{className:"font-size-sm",children:["Phone  ",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"color-red-yp",children:"*"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"phone",rules:[{required:true,message:"Please add phone"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(input_number/* default */.A,{style:{width:'100%'},type:"number",addonBefore:/*#__PURE__*/(0,jsx_runtime.jsx)(es_select/* default */.A,{style:{width:98},placeholder:"Select phone code",defaultValue:type==="new"?"971":(recordData===null||recordData===void 0?void 0:(_recordData$data2=recordData.data)===null||_recordData$data2===void 0?void 0:_recordData$data2.phoneCode)||"971",children:countries===null||countries===void 0?void 0:countries.map(item=>/*#__PURE__*/(0,jsx_runtime.jsxs)(Option,{value:item.phoneCode,children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:item.flag}),/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"ml-1",children:"".concat(item.phoneCode)})]},item.id))}),placeholder:"Enter phone number",defaultValue:type==="new"?"":recordData===null||recordData===void 0?void 0:(_recordData$data3=recordData.data)===null||_recordData$data3===void 0?void 0:_recordData$data3.phone,controls:false})})]})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"address",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Address",type:"text"})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"designation",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{disabled:!manageAllUser,size:"w100",label:"Designation",type:"text"})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{className:"font-size-sm",children:["Department  ",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"color-red-yp",children:"*"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"departmentId",rules:[{required:true,message:"Please select a department"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_select/* default */.A,{disabled:!manageAllUser,allowClear:true,style:{width:"100%"},defaultValue:recordData===null||recordData===void 0?void 0:(_recordData$data4=recordData.data)===null||_recordData$data4===void 0?void 0:(_recordData$data4$Dep=_recordData$data4.Department)===null||_recordData$data4$Dep===void 0?void 0:_recordData$data4$Dep.id,placeholder:"Search for the department",className:"selectAntdCustom",onChange:value=>form.setFieldsValue({departmentId:value}),showSearch:true,onSearch:value=>setSearchTermDepartment(value),optionFilterProp:"label",options:departments===null||departments===void 0?void 0:departments.map(item=>{return{label:item.title,value:item.id};}),notFoundContent:/*#__PURE__*/(0,jsx_runtime.jsx)(empty/* default */.A,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:"No data found, Please search for the department"})})})})]})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"whatsapp",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{label:"WhatsApp Number",placeHolder:"Enter WhatsApp Number",size:"w100"})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"status",initialValue:form.getFieldValue("status")||commonEnums/* UserStatus */._O.active,children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomSelect */.Ae,{label:"User Status",disabled:!manageAllUser,options:[{value:commonEnums/* UserStatus */._O.active,label:"Active"},{value:commonEnums/* UserStatus */._O.suspended,label:"Suspended"}],placeholder:"Select User Status"})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{className:"font-size-sm",children:["Organization  ",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"color-red-yp",children:"*"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"organizationId",rules:[{required:true,message:"Please select an organization"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_select/* default */.A,{disabled:!manageAllUser,allowClear:true,style:{width:"100%"},defaultValue:recordData===null||recordData===void 0?void 0:(_recordData$data5=recordData.data)===null||_recordData$data5===void 0?void 0:(_recordData$data5$Org=_recordData$data5.Organization)===null||_recordData$data5$Org===void 0?void 0:_recordData$data5$Org.id,placeholder:"Search for the organization",className:"selectAntdCustom",onChange:value=>form.setFieldsValue({organizationId:value}),showSearch:true,optionFilterProp:"label",options:organizations===null||organizations===void 0?void 0:organizations.map(item=>{return{label:item.name,value:item.id};}),notFoundContent:/*#__PURE__*/(0,jsx_runtime.jsx)(empty/* default */.A,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:"No data found, Please search for the organization"})})})})]})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{className:"font-size-sm",children:["Manager  ",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"color-red-yp",children:"*"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"managerId",rules:[{required:true,message:"Please select a manager"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_select/* default */.A,{disabled:!manageAllUser,allowClear:true,style:{width:"100%"},defaultValue:recordData===null||recordData===void 0?void 0:(_recordData$data6=recordData.data)===null||_recordData$data6===void 0?void 0:(_recordData$data6$Man=_recordData$data6.Manager)===null||_recordData$data6$Man===void 0?void 0:_recordData$data6$Man.id,placeholder:"Search for the manager",className:"selectAntdCustom",onChange:value=>value?form.setFieldsValue({managerId:value}):{},showSearch:true,onSearch:value=>setSearchTermManager(value),optionFilterProp:"label",options:managers===null||managers===void 0?void 0:managers.map(item=>{return{label:item.firstName+" "+item.lastName,value:item.id};}),notFoundContent:/*#__PURE__*/(0,jsx_runtime.jsx)(empty/* default */.A,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:"No data found, Please search for the manager"})})})})]})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"mb-4",children:[type==="new"&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{className:"font-size-sm",children:["Select Roles ",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"color-red-yp",children:"*"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"roleIds",rules:[{required:true,message:"Please select at least one role"}],help:/*#__PURE__*/(0,jsx_runtime.jsx)("small",{className:"color-dark-main",children:"Select roles for this user!. You can select multiple roles."}),children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_select/* default */.A,{disabled:!manageAllUser,mode:"multiple",allowClear:true,style:{width:"100%"},placeholder:"Please select at least one role",className:"selectAntdCustom",onChange:value=>form.setFieldsValue({roleIds:value}),showSearch:true,optionFilterProp:"label",options:roles.map(role=>({label:role===null||role===void 0?void 0:role.title,value:role===null||role===void 0?void 0:role.id}))})})]})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{className:"font-size-sm",children:["Date of Joining  ",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"color-red-yp",children:"*"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"dateOfJoining",children:/*#__PURE__*/(0,jsx_runtime.jsx)(date_picker/* default */.A,{className:Form_styles_module.date_picker})})]})}),type==="edit"&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{className:"font-size-sm",children:["Last Working Date",/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"lastWorkingDate",children:/*#__PURE__*/(0,jsx_runtime.jsx)(date_picker/* default */.A,{className:Form_styles_module.date_picker})})]})})]}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{className:"font-size-sm",children:["Limit Data Access to",/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"allDataAccessRestrictedTo",help:"If any organization/branch is chosen then the data will be restricted to the chosen organization. Empty meaning no restriction",children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_select/* default */.A,{mode:"multiple",disabled:!manageAllUser,allowClear:true,style:{width:"100%"},defaultValue:recordData===null||recordData===void 0?void 0:(_recordData$data7=recordData.data)===null||_recordData$data7===void 0?void 0:_recordData$data7.dataAccessRestrictedTo,placeholder:"Search for the organization",className:"selectAntdCustom",onChange:value=>form.setFieldsValue({dataAccessRestrictedTo:value}),showSearch:true,optionFilterProp:"label",options:organizations===null||organizations===void 0?void 0:organizations.map(item=>{return{label:item.name,value:item.id};}),notFoundContent:/*#__PURE__*/(0,jsx_runtime.jsx)(empty/* default */.A,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:"No data found, Please search for the organization"})})})})]})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"mt-5",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* ImageUploader */.GA,{name:"profile",defaultFileList:type==="edit"&&recordData&&((_recordData$data8=recordData.data)===null||_recordData$data8===void 0?void 0:_recordData$data8.profile)&&[{uid:(_recordData$data9=recordData.data)===null||_recordData$data9===void 0?void 0:_recordData$data9.id,name:(_recordData$data10=recordData.data)===null||_recordData$data10===void 0?void 0:_recordData$data10.profile,status:"done",url:constants/* RESOURCE_BASE_URL */.to+((_recordData$data11=recordData.data)===null||_recordData$data11===void 0?void 0:_recordData$data11.profile)}]})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.footer,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{size:"normal",fontSize:"sm",onClick:onCancel,type:"plain",children:"Cancel"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:recordData===null||recordData===void 0?void 0:recordData.buttonLoading,children:"Submit"})]})]});};
;// ./src/Components/Organisms/Dashboard/Employees/Form/Additional.tsx
const{Option: Additional_Option}=es_select/* default */.A;const Relationship=["Spouse","Mother","Father","Child","Brother","Sister","Friend","Neighbor","Coworker","Aunt","Uncle","Cousin","Niece","Nephew"];const Gender=["Male","Female","Other"];const MaritalStatus=["Single","Married","Divorced","Widowed","Separated"];const Additional=props=>{const{type,record,openModal,onCancel,updateUser,reloadTableData,manageAllUser}=props;const[form]=es_form/* default */.A.useForm();const module=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const orgModule=(0,react.useMemo)(()=>new Organization/* OrganizationModule */.I(),[]);const countryModule=(0,react.useMemo)(()=>new Country/* CountryModule */.j(),[]);const[recordData,setRecordData]=(0,react.useState)();const[countries,setCountries]=(0,react.useState)([]);const[nationalityOptions,setNationalityOptions]=(0,react.useState)(constants/* NATIONALITIES */.Dl);const[religionOptions,setReligionOptions]=(0,react.useState)(constants/* RELIGIONS */.XQ);const[relationshipOptions,setRelationshipOptions]=(0,react.useState)(Relationship);const[genderOptions,setGenderOptions]=(0,react.useState)(Gender);const[maritalStatusOptions,setMaritalStatusOptions]=(0,react.useState)(MaritalStatus);const[searchedValues,setSearchedValues]=(0,react.useState)({nationality:"",religion:"",emergencyContactRelationship:"",gender:"",maritalStatus:""});const handleErrors=err=>{const error=(0,error_handler/* errorHandler */.r)(err);if(typeof error.message=="string"){setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:error.message}));}else{let errData=(0,ServerErrorHandler/* HandleServerErrors */.p)(error.message,[]);form.setFields(errData);setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));}};const handleAlertClose=()=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));};// Get data for the selected record from the api and set it in the form
const getDataBySlug=(0,react.useCallback)(()=>{module.getRecordById(record).then(res=>{if(res.data&&res.data.data){res.data.data.UserMeta.forEach(item=>{form.setFieldValue(item.key,item.value);const states={nationality:[nationalityOptions,setNationalityOptions],religion:[religionOptions,setReligionOptions],maritalStatus:[maritalStatusOptions,setMaritalStatusOptions],gender:[genderOptions,setGenderOptions],emergencyContactRelationship:[relationshipOptions,setRelationshipOptions]};// add the value to the options list if it doesn't exist in the list already but is present in the database
Object.entries(states).forEach(_ref=>{let[key,value]=_ref;const[options,setOptions]=value;if(item.key===key&&item.value&&!options.includes(item.value)){setOptions([...options,item.value]);}});});setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data),{},{loading:false}));}}).catch(err=>{handleErrors(err);});},[form,record,module,orgModule]);const getCountryList=(0,react.useCallback)(()=>{countryModule.getAvailableRecords().then(res=>{if(res.data&&res.data.data){setCountries(res.data.data);}});},[countryModule]);(0,react.useEffect)(()=>{if(type==="edit"){setRecordData({loading:true});getDataBySlug();getCountryList();}else{// fetch the countries
getCountryList();form.resetFields();}},[openModal,type,form,getDataBySlug,getCountryList]);const onFinish=formValues=>{const processedValues=[];Object.entries(formValues).forEach(_ref2=>{let[key,value]=_ref2;if(value){processedValues.push({key,value:value.toString()});}});setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{buttonLoading:true}));if(updateUser===true){var _recordData$data;module.updateUserMeta({userMeta:processedValues},recordData===null||recordData===void 0?void 0:(_recordData$data=recordData.data)===null||_recordData$data===void 0?void 0:_recordData$data.id).then(res=>{reloadTableData();// setCurrentForm("3");
setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to update this user");}};/**This function will save the searched value in the state
   * @param value searched value
   * @param name name of the field
   */const handleSearch=(value,name)=>{if(!value)return;value&&setSearchedValues(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{[name]:value}));form.setFieldValue(name,value);};/**This function will add the searched value to the options list
   * when the user clicks outside the select input field
   * @param name name of the field 
   */const handleOnBlur=name=>{const states={nationality:[nationalityOptions,setNationalityOptions],religion:[religionOptions,setReligionOptions],maritalStatus:[maritalStatusOptions,setMaritalStatusOptions],gender:[genderOptions,setGenderOptions],emergencyContactRelationship:[relationshipOptions,setRelationshipOptions]};const[options,setOptions]=states[name];const value=searchedValues[name];if(value&&!options.includes(value)){setOptions([...options,value]);}};return recordData!==null&&recordData!==void 0&&recordData.loading?/*#__PURE__*/(0,jsx_runtime.jsx)(Skeletons/* default */.A,{items:10}):/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{className:styles_module/* default */.A.form,onFinish:onFinish,form:form,children:[(recordData===null||recordData===void 0?void 0:recordData.error)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomErrorAlert */.WZ,{description:recordData===null||recordData===void 0?void 0:recordData.error,isClosable:true,onClose:handleAlertClose}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{style:{width:'100%',fontSize:'var(--font-size-sm)'},children:["Date Of Birth",/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"dateOfBirth",valuePropName:'dateOfBirth',children:/*#__PURE__*/(0,jsx_runtime.jsx)(date_picker/* default */.A,{defaultValue:form.getFieldValue("dateOfBirth")?moment_default()(form.getFieldValue("dateOfBirth")):undefined,clearIcon:true,style:{width:'100%',border:'2px solid var(--color-border)',borderRadius:'0.25rem'}})})]}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"nationality",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* SelectWithSearch */.fd,{asterisk:false,label:"Nationality",options:nationalityOptions.map(item=>({label:item,value:item})),onSearch:value=>handleSearch(value,"nationality"),onBlur:()=>handleOnBlur("nationality"),notFoundDescription:"Pro Tip: If nationality is not available in the list, continue typing it will be added automatically"})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"personalEmail",rules:[{type:"email",message:"Please add valid email"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Personal Email",type:"email"})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{className:"font-size-sm",children:["Personal Phone",/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"personalNumber",children:/*#__PURE__*/(0,jsx_runtime.jsx)(input_number/* default */.A,{type:"text",style:{width:'100%'},addonBefore:/*#__PURE__*/(0,jsx_runtime.jsx)(es_select/* default */.A,{style:{width:98},placeholder:"Select phone code",defaultValue:"971",children:countries===null||countries===void 0?void 0:countries.map(item=>/*#__PURE__*/(0,jsx_runtime.jsxs)(Additional_Option,{value:item.phoneCode,children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:item.flag}),/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"ml-1",children:"".concat(item.phoneCode)})]},"country-".concat(item.id)))}),placeholder:"Enter phone number",controls:false})})]})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"religion",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* SelectWithSearch */.fd,{asterisk:false,label:"Religion",options:religionOptions.map(item=>({label:item,value:item})),onSearch:value=>handleSearch(value,"religion"),onBlur:()=>handleOnBlur("religion"),notFoundDescription:"Pro Tip: If religion is not available in the list, continue typing it will be added automatically"})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"maritalStatus",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* SelectWithSearch */.fd,{asterisk:false,label:"Marital Status",options:maritalStatusOptions.map(item=>({label:item,value:item})),onSearch:value=>handleSearch(value,"maritalStatus"),onBlur:()=>handleOnBlur("maritalStatus"),notFoundDescription:"Pro Tip: If marital status is not available in the list, continue typing it will be added automatically"})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"gender",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* SelectWithSearch */.fd,{asterisk:false,label:"Gender",options:genderOptions.map(item=>({label:item,value:item})),onSearch:value=>handleSearch(value,"gender"),onBlur:()=>handleOnBlur("gender"),notFoundDescription:"Pro Tip: If gender is not available in the list, continue typing it will be added automatically"})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"currentProfession",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{label:"Current Profession",type:"text",size:"w100"})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"passportNumber",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{label:"Passport Number",placeHolder:"Enter Passport Number",size:"w100"})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{style:{width:'100%',fontSize:'var(--font-size-sm)'},children:["Passport Expiry Date",/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"passportExpiryDate",valuePropName:'passportExpiryDate',children:/*#__PURE__*/(0,jsx_runtime.jsx)(date_picker/* default */.A,{defaultValue:form.getFieldValue("passportExpiryDate")?moment_default()(form.getFieldValue("passportExpiryDate")):undefined,clearIcon:true,style:{width:'100%',border:'2px solid var(--color-border)',borderRadius:'0.25rem'}})})]})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"emergencyContactName",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{label:"Emergency Contact Name",placeHolder:"Enter Emergency Contact Name",size:"w100"})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"emergencyContactRelationship",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* SelectWithSearch */.fd,{asterisk:false,label:"Emergency Contact Relationship",options:relationshipOptions.map(item=>({label:item,value:item})),onSearch:value=>handleSearch(value,"emergencyContactRelationship"),onBlur:()=>handleOnBlur("emergencyContactRelationship"),notFoundDescription:"Pro Tip: If relationship is not available in the list, continue typing it will be added automatically"})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"emergencyContactAddress",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{label:"Emergency Contact Address",placeHolder:"Enter Emergency Contact Address",size:"w100"})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"emergencyContactNumber",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{label:"Emergency Contact Number",placeHolder:"Enter Emergency Contact Number",size:"w100"})})]}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"labourCardNumber",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{label:"Labour Card Number",placeHolder:"Enter Labour Card Number",size:"w100",disabled:!manageAllUser})})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.footer,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{size:"normal",fontSize:"sm",onClick:onCancel,type:"plain",children:"Cancel"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:recordData===null||recordData===void 0?void 0:recordData.buttonLoading,children:"Submit"})]})]});};
// EXTERNAL MODULE: ./node_modules/antd/es/upload/index.js + 19 modules
var upload = __webpack_require__(28013);
// EXTERNAL MODULE: ./node_modules/antd/es/button/index.js
var es_button = __webpack_require__(48538);
// EXTERNAL MODULE: ./node_modules/antd/es/image/index.js + 13 modules
var es_image = __webpack_require__(9206);
// EXTERNAL MODULE: ./node_modules/antd/es/popconfirm/index.js + 1 modules
var popconfirm = __webpack_require__(56231);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/UploadOutlined.js + 1 modules
var UploadOutlined = __webpack_require__(51598);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/DeleteOutlined.js
var DeleteOutlined = __webpack_require__(78433);
// EXTERNAL MODULE: ./node_modules/pdfjs-dist/build/pdf.js
var pdf = __webpack_require__(73114);
// EXTERNAL MODULE: ./node_modules/react-pdf/dist/esm/Document.js + 1 modules
var Document = __webpack_require__(39087);
// EXTERNAL MODULE: ./node_modules/react-pdf/dist/esm/Page.js + 12 modules
var Page = __webpack_require__(93852);
// EXTERNAL MODULE: ./src/services/axiosInstance.ts
var axiosInstance = __webpack_require__(83365);
// EXTERNAL MODULE: ./src/services/tokenService.ts
var tokenService = __webpack_require__(92966);
;// ./src/Components/Organisms/Dashboard/Employees/Form/Files.tsx
const Files=_ref=>{var _recordData$data;let{type,record,openModal,onCancel,updateUser,reloadTableData}=_ref;const[form]=es_form/* default */.A.useForm();const module=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const[recordData,setRecordData]=(0,react.useState)();const[isUpdate,setIsUpdate]=(0,react.useState)([]);pdf.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(pdf.version,"/pdf.worker.js");const access_token=tokenService/* default */.A.getLocalAccessToken();const handleErrors=err=>{const error=(0,error_handler/* errorHandler */.r)(err);if(typeof error.message=="string"){setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:error.message}));}else{let errData=(0,ServerErrorHandler/* HandleServerErrors */.p)(error.message,[]);form.setFields(errData);setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));}};const handleAlertClose=()=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));};// Get data for the selected record from the api and set it in the form
const getDataBySlug=(0,react.useCallback)(()=>{module.getRecordById(record).then(res=>{if(res.data&&res.data.data){setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data),{},{loading:false}));const _temp=[];res.data.data.UserDocuments.forEach(item=>{_temp.push({title:item.title,documentId:item.id,documentType:item.documentType,show:false});});setIsUpdate(_temp);}}).catch(err=>{handleErrors(err);});},[form,record,module]);(0,react.useEffect)(()=>{if(type==="edit"){setRecordData({loading:true});getDataBySlug();}else{// fetch the countries
form.resetFields();}},[openModal,type,form,getDataBySlug]);const onFinish=formValues=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{buttonLoading:true}));const formData=new FormData();const excludeFields=["file"];Object.entries(formValues).forEach(ele=>{if(!excludeFields.includes(ele[0])){formData.append(ele[0],ele[1]);}});if(formValues["file"]&&typeof formValues["file"]!=="string"&&formValues["file"]["fileList"].length>0){formData.append("file",formValues["file"]["fileList"][0]["originFileObj"]);}formData.append('userId',record.toString());if(updateUser===true){module.uploadUserDocuments(formData).then(res=>{// reloadTableData();
getDataBySlug();form.resetFields();setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to update this user");}};return/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[recordData!==null&&recordData!==void 0&&recordData.loading?/*#__PURE__*/(0,jsx_runtime.jsx)(Skeletons/* default */.A,{items:10}):/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{className:styles_module/* default */.A.form,onFinish:onFinish,form:form,children:[(recordData===null||recordData===void 0?void 0:recordData.error)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomErrorAlert */.WZ,{description:recordData===null||recordData===void 0?void 0:recordData.error,isClosable:true,onClose:handleAlertClose}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"title",rules:[{required:true,message:"Please add title."}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Title",asterisk:true,type:"text"})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"documentType",rules:[{required:true,message:"Please add document type."}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomSelect */.Ae,{label:"Document Type",options:commonEnums/* UserDocumentsTypes */.xW,placeholder:"Select Document Type",asterisk:true})})]}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"file",rules:[{required:true,message:"Please add file."}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(upload/* default */.A,{multiple:false,beforeUpload:()=>false,children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{icon:/*#__PURE__*/(0,jsx_runtime.jsx)(UploadOutlined/* default */.A,{}),children:"Click to Upload"})})})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.footer,style:{marginBottom:'1rem'},children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{size:"normal",fontSize:"sm",onClick:onCancel,type:"plain",children:"Cancel"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:recordData===null||recordData===void 0?void 0:recordData.buttonLoading,children:"Submit"})]})]}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{display:'flex',flexDirection:'column',gap:'1rem'},children:recordData===null||recordData===void 0?void 0:(_recordData$data=recordData.data)===null||_recordData$data===void 0?void 0:_recordData$data.UserDocuments.map((file,index)=>{var _isUpdate$find;return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:styles_module/* default */.A.resourceWrap,children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{style:{display:'flex',gap:'1rem'},children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:Form_styles_module.resourceWrap,children:[file.documentType.includes("pdf")?/*#__PURE__*/(0,jsx_runtime.jsx)("a",{href:"".concat(axiosInstance/* BASE_URL */.C,"resources/task-resources/").concat(file===null||file===void 0?void 0:file.file,"?authKey=").concat(access_token),target:"_blank",rel:"noreferrer",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Document/* default */.A,{file:"".concat(axiosInstance/* BASE_URL */.C,"resources/task-resources/").concat(file.file,"?authKey=").concat(access_token)// onLoadSuccess={onDocumentLoadSuccess}
,children:/*#__PURE__*/(0,jsx_runtime.jsx)(Page/* default */.A,{renderTextLayer:false,pageNumber:1})})}):/*#__PURE__*/(0,jsx_runtime.jsx)(es_image/* default */.A,{className:Form_styles_module.image,width:120,height:100,src:"".concat(axiosInstance/* BASE_URL */.C,"resources/task-resources/").concat(file===null||file===void 0?void 0:file.file,"?authKey=").concat(access_token)}),/*#__PURE__*/(0,jsx_runtime.jsx)(popconfirm/* default */.A,{title:"Are you sure you want to delete this document?",onConfirm:()=>{module.deleteUserDocument(file.id).then(()=>{getDataBySlug();}).catch(err=>{message/* default */.Ay.error("Something bad happened");});},okText:"Yes",cancelText:"No",overlayInnerStyle:{borderRadius:'0.25rem'},children:/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:Form_styles_module.deleteWrap,children:/*#__PURE__*/(0,jsx_runtime.jsx)(DeleteOutlined/* default */.A,{style:{fontSize:14,color:'var(--color-light)'}})})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{style:{display:'flex',flexDirection:'column',gap:'0.25rem'},children:[(_isUpdate$find=isUpdate.find(item=>item.documentId===file.id))!==null&&_isUpdate$find!==void 0&&_isUpdate$find.show?/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* EditableInput */.jc,{onBlur:()=>{var _recordData$data2,_recordData$data2$Use;const _temp=[...isUpdate];_temp[index]=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},isUpdate[index]),{},{title:recordData===null||recordData===void 0?void 0:(_recordData$data2=recordData.data)===null||_recordData$data2===void 0?void 0:(_recordData$data2$Use=_recordData$data2.UserDocuments[index])===null||_recordData$data2$Use===void 0?void 0:_recordData$data2$Use.title,show:false});setIsUpdate(_temp);},onChange:e=>{const _temp=[...isUpdate];_temp[index]=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},isUpdate[index]),{},{title:e.target.value});setIsUpdate(_temp);},style:{fontSize:'var(--font-size-normal)'},onMouseDown:()=>{module.updateUserDocument({title:isUpdate[index].title,documentId:isUpdate[index].documentId,documentType:isUpdate[index].documentType}).then(res=>{if(res){getDataBySlug();}});},defaultValue:file===null||file===void 0?void 0:file.title}):/*#__PURE__*/(0,jsx_runtime.jsx)("div",{onClick:()=>{const _temp=[...isUpdate];_temp[index]=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},isUpdate[index]),{},{show:true});setIsUpdate(_temp);},className:Form_styles_module.Tasktitle,children:/*#__PURE__*/(0,jsx_runtime.jsx)("b",{children:file===null||file===void 0?void 0:file.title})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{minWidth:'12rem'},children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomSelect */.Ae,{value:isUpdate[index].documentType,options:commonEnums/* UserDocumentsTypes */.xW,placeholder:"Select Document Type",onChange:value=>module.updateUserDocument({title:isUpdate[index].title,documentId:isUpdate[index].documentId,documentType:value}).then(res=>{if(res){getDataBySlug();}})})})]})]})});})})]});};
// EXTERNAL MODULE: ./node_modules/antd/es/table/index.js + 96 modules
var table = __webpack_require__(41821);
// EXTERNAL MODULE: ./src/Modules/CompanyAsset/index.ts
var CompanyAsset = __webpack_require__(23803);
;// ./src/Components/Organisms/Dashboard/Employees/Form/Resources.tsx
const Resources=_ref=>{var _recordData$data,_Object$entries,_recordData$data2,_recordData$data3,_recordData$data4;let{type,record,openModal,onCancel,updateUser,manageAllUser,reloadTableData}=_ref;const[form]=es_form/* default */.A.useForm();const module=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const[recordData,setRecordData]=(0,react.useState)();const[assetType,setAssetType]=(0,react.useState)();const assetModule=new CompanyAsset/* CompanyAssetModule */.q();const[searchTermAssets,setSearchTermAssets]=(0,react.useState)("");const debouncedSearchTermAssets=(0,useDebounce/* useDebounce */.d)(searchTermAssets,500);const[companyAssets,setCompanyAssets]=(0,react.useState)([]);const onAssetsSearch=(0,react.useCallback)(()=>{if(debouncedSearchTermAssets||assetType){assetModule.getAllRecords({type:assetType}).then(res=>{setCompanyAssets(res.data.data);}).catch(err=>{message/* default */.Ay.error(err.response.data.message);});}},[assetModule,debouncedSearchTermAssets]);(0,react.useEffect)(()=>{onAssetsSearch();},[debouncedSearchTermAssets,assetType]);const handleErrors=err=>{const error=(0,error_handler/* errorHandler */.r)(err);if(typeof error.message=="string"){setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:error.message}));}else{let errData=(0,ServerErrorHandler/* HandleServerErrors */.p)(error.message,[]);form.setFields(errData);setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));}};const handleAlertClose=()=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));};// Get data for the selected record from the api and set it in the form
const getDataBySlug=(0,react.useCallback)(()=>{module.getRecordById(record).then(res=>{if(res.data&&res.data.data){setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data),{},{loading:false}));}}).catch(err=>{handleErrors(err);});},[form,record,module]);(0,react.useEffect)(()=>{if(type==="edit"){setRecordData({loading:true});getDataBySlug();}else{// fetch the countries
form.resetFields();}},[openModal,type,form,getDataBySlug]);const onFinish=formValues=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{buttonLoading:true}));if(updateUser===true){assetModule.allocateResources((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},formValues),{},{userId:record.toString()})).then(res=>{// reloadTableData();
getDataBySlug();form.resetFields();setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to update this user");}};const columns=[{title:'Resource',dataIndex:'assetName',key:'assetName',render:(text,record)=>{var _record$CompanyAsset;return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:record===null||record===void 0?void 0:(_record$CompanyAsset=record.CompanyAsset)===null||_record$CompanyAsset===void 0?void 0:_record$CompanyAsset.assetName});}},{title:'Label',dataIndex:'label',key:'label'},{title:'Code',dataIndex:'code',key:'code',render:(text,record)=>{var _record$CompanyAsset2;return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:record===null||record===void 0?void 0:(_record$CompanyAsset2=record.CompanyAsset)===null||_record$CompanyAsset2===void 0?void 0:_record$CompanyAsset2.code});}},manageAllUser?{title:'Action',key:'action',render:(text,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(popconfirm/* default */.A,{placement:"top",title:"Are you sure?",onConfirm:()=>assetModule.revokeResources(record===null||record===void 0?void 0:record.id).then(()=>{getDataBySlug();}),okText:"Yes",cancelText:"No",children:/*#__PURE__*/(0,jsx_runtime.jsx)(DeleteOutlined/* default */.A,{className:styles_module/* default */.A.bg__red})})}:{}];return/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[recordData!==null&&recordData!==void 0&&recordData.loading?/*#__PURE__*/(0,jsx_runtime.jsx)(Skeletons/* default */.A,{items:10}):manageAllUser&&/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{className:styles_module/* default */.A.form,onFinish:onFinish,form:form,children:[(recordData===null||recordData===void 0?void 0:recordData.error)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomErrorAlert */.WZ,{description:recordData===null||recordData===void 0?void 0:recordData.error,isClosable:true,onClose:handleAlertClose}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{className:"font-size-sm",children:["Type  ",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"color-red-yp",children:"*"})]}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_select/* default */.A,{allowClear:true,style:{width:"100%",height:'unset'},defaultValue:recordData===null||recordData===void 0?void 0:(_recordData$data=recordData.data)===null||_recordData$data===void 0?void 0:_recordData$data.type,placeholder:"Search for the asset type",className:"selectAntdCustom",onChange:value=>setAssetType(value),showSearch:true,onSearch:value=>{},optionFilterProp:"label",options:(_Object$entries=Object.entries(commonEnums/* CompanyAssetTypeEnum */.$H))===null||_Object$entries===void 0?void 0:_Object$entries.map(_ref2=>{let[key,value]=_ref2;return{label:(0,common/* capitalize */.ZH)(key.replace("_"," ")),value:Number(value)};}),notFoundContent:/*#__PURE__*/(0,jsx_runtime.jsx)(empty/* default */.A,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:"No data found, Please search for the type"})})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A.Item,{name:"companyAssetId",rules:[{required:true,message:"Please select a resource"}],children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{className:"font-size-sm color-dark-main",children:["Company Resource  ",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"color-red-yp",children:"*"})]}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_select/* default */.A,{allowClear:true,style:{width:"100%"},defaultValue:recordData===null||recordData===void 0?void 0:(_recordData$data2=recordData.data)===null||_recordData$data2===void 0?void 0:_recordData$data2.companyAssetId,placeholder:"Search for the resource",className:"selectAntdCustom",onChange:value=>form.setFieldsValue({companyAssetId:value}),showSearch:true,onSearch:value=>setSearchTermAssets(value),optionFilterProp:"label",options:companyAssets===null||companyAssets===void 0?void 0:companyAssets.map(item=>{return{label:item.assetName,value:item.id};}),notFoundContent:/*#__PURE__*/(0,jsx_runtime.jsx)(empty/* default */.A,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:"No data found, Please search for the resource"})})})]}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"label",rules:[{required:true,message:"Please add label."}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Label",asterisk:true,type:"text"})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"quantity",rules:[{required:true,message:"Please add quantity."}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Quantity",asterisk:true,type:"number"})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{alignSelf:'center'},children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:recordData===null||recordData===void 0?void 0:recordData.buttonLoading,children:"Submit"})})]})]}),(recordData===null||recordData===void 0?void 0:(_recordData$data3=recordData.data)===null||_recordData$data3===void 0?void 0:_recordData$data3.AssetAllocation.length)>0&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{display:'flex',flexDirection:'column',gap:'1rem'},children:/*#__PURE__*/(0,jsx_runtime.jsx)(table/* default */.A,{columns:columns,dataSource:recordData===null||recordData===void 0?void 0:(_recordData$data4=recordData.data)===null||_recordData$data4===void 0?void 0:_recordData$data4.AssetAllocation,pagination:false})})]});};
// EXTERNAL MODULE: ./node_modules/antd/es/tag/index.js + 1 modules
var tag = __webpack_require__(12916);
// EXTERNAL MODULE: ./src/helpers/dateHandler.ts
var dateHandler = __webpack_require__(98933);
;// ./src/Components/Organisms/Dashboard/Employees/Form/Salary.tsx
const{MonthPicker}=date_picker/* default */.A;const Salary=_ref=>{var _recordData$data,_recordData$data$Sala,_recordData$data2,_recordData$data3;let{type,record,openModal,manageAllUser}=_ref;const[form]=es_form/* default */.A.useForm();const module=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const[recordData,setRecordData]=(0,react.useState)();const[showTable,setShowTable]=(0,react.useState)(false);const handleErrors=err=>{const error=(0,error_handler/* errorHandler */.r)(err);if(typeof error.message=="string"){setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:error.message}));}else{let errData=(0,ServerErrorHandler/* HandleServerErrors */.p)(error.message,[]);form.setFields(errData);setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));}};const handleAlertClose=()=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));};// Get data for the selected record from the api and set it in the form
const getDataBySlug=(0,react.useCallback)(()=>{module.getRecordById(record).then(res=>{if(res.data&&res.data.data){setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data),{},{loading:false}));}}).catch(err=>{handleErrors(err);});},[form,record,module]);(0,react.useEffect)(()=>{if(type==="edit"){setRecordData({loading:true});getDataBySlug();}else{// fetch the countries
form.resetFields();}},[openModal,type,form,getDataBySlug]);const onFinish=formValues=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{buttonLoading:true}));if(manageAllUser===true){module.updateSalary({amount:formValues.amount,startDate:moment_default()(formValues.startDate._d.toISOString()).set('D',1).toISOString()},record).then(res=>{// reloadTableData();
getDataBySlug();form.resetFields();setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to update this user");}};const columns=[{title:"S.No",dataIndex:"index",key:"index",render:(text,record,index)=>index+1,width:"5%"},{title:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("b",{children:"Start Date"})," ",manageAllUser?/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{onClick:()=>setShowTable(!showTable),size:"small",children:"Promote"}):null]}),dataIndex:'startDate',key:'startDate',render:(text,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:(0,dateHandler/* convertDate */.ic)(record.startDate,"MM dd,yy")})},{title:"End Date",dataIndex:'endDate',key:'endDate',render:(text,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:(0,dateHandler/* convertDate */.ic)(record.endDate,"MM dd,yy")})},{title:'Amount',dataIndex:'amount',key:'amount',render:(text,record)=>/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[text," AED\xA0\xA0\xA0",record.isActive?/*#__PURE__*/(0,jsx_runtime.jsx)(tag/* default */.A,{color:"green",children:"Current"}):null]})}];return/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[manageAllUser&&/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{className:styles_module/* default */.A.form,onFinish:onFinish,form:form,children:[(recordData===null||recordData===void 0?void 0:recordData.error)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomErrorAlert */.WZ,{description:recordData===null||recordData===void 0?void 0:recordData.error,isClosable:true,onClose:handleAlertClose}),(recordData===null||recordData===void 0?void 0:(_recordData$data=recordData.data)===null||_recordData$data===void 0?void 0:(_recordData$data$Sala=_recordData$data.Salary)===null||_recordData$data$Sala===void 0?void 0:_recordData$data$Sala.length)===0||showTable?/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{style:{fontSize:'var(--font-size-sm)',color:'var(--color-dark-main)'},children:["Start Date ",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"color-red-yp",children:"*"})]}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"startDate",rules:[{required:true,message:"Please add start date."}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(MonthPicker,{style:{borderRadius:'0.25rem',borderWidth:2,width:'100%',borderColor:'var(--color-border)'}})})]}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"amount",rules:[{required:true,message:"Please add amount."}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Amount",asterisk:true,type:"number"})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{alignSelf:'center'},children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:recordData===null||recordData===void 0?void 0:recordData.buttonLoading,children:"Submit"})})]}):null]}),recordData!==null&&recordData!==void 0&&recordData.loading?/*#__PURE__*/(0,jsx_runtime.jsx)(Skeletons/* default */.A,{items:2}):/*#__PURE__*/(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(recordData===null||recordData===void 0?void 0:(_recordData$data2=recordData.data)===null||_recordData$data2===void 0?void 0:_recordData$data2.Salary.length)>0?/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{display:'flex',flexDirection:'column',gap:'1rem'},children:/*#__PURE__*/(0,jsx_runtime.jsx)(table/* default */.A,{columns:columns,dataSource:recordData===null||recordData===void 0?void 0:(_recordData$data3=recordData.data)===null||_recordData$data3===void 0?void 0:_recordData$data3.Salary,pagination:false})}):/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomEmpty */.ZX,{description:"No Salary Data found"})})]});};
// EXTERNAL MODULE: ./src/Modules/LeaveRequest/index.ts
var LeaveRequest = __webpack_require__(50982);
// EXTERNAL MODULE: ./node_modules/recharts/es6/chart/PieChart.js + 3 modules
var PieChart = __webpack_require__(67360);
// EXTERNAL MODULE: ./node_modules/recharts/es6/polar/Pie.js
var Pie = __webpack_require__(54203);
// EXTERNAL MODULE: ./node_modules/recharts/es6/component/Cell.js
var Cell = __webpack_require__(72528);
// EXTERNAL MODULE: ./node_modules/recharts/es6/component/Label.js
var Label = __webpack_require__(71876);
;// ./src/Modules/LeaveCredit/index.ts
class LeaveCreditModule{constructor(){this.endPoint="leave-credit";this.deleteRecord=id=>{return axiosInstance/* default */.A.delete(axiosInstance/* BASE_URL */.C+this.endPoint+"/"+id);};this.createRecord=data=>{return axiosInstance/* default */.A.post(axiosInstance/* BASE_URL */.C+this.endPoint,data);};this.updateRecord=(data,id)=>{return axiosInstance/* default */.A.patch(axiosInstance/* BASE_URL */.C+this.endPoint+"/"+id,data);};}}
;// ./src/Components/Organisms/Dashboard/Employees/Form/LeavesReport.tsx
const{MonthPicker: LeavesReport_MonthPicker}=date_picker/* default */.A;const LeavesReport=_ref=>{var _recordData$data,_recordData$data2,_recordData$data3;let{type,record,openModal,onCancel,manageAllUser,reloadTableData}=_ref;const COLORS=['var(--color-primary-main)','var(--color-primary-main-200)'];const[form]=es_form/* default */.A.useForm();const module=(0,react.useMemo)(()=>new LeaveRequest/* LeaveRequestModule */.j(),[]);const leaveCreditModule=(0,react.useMemo)(()=>new LeaveCreditModule(),[]);const[recordData,setRecordData]=(0,react.useState)();const[showTable,setShowTable]=(0,react.useState)(false);const handleErrors=err=>{const error=(0,error_handler/* errorHandler */.r)(err);if(typeof error.message=="string"){setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:error.message}));}else{let errData=(0,ServerErrorHandler/* HandleServerErrors */.p)(error.message,[]);form.setFields(errData);setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));}};const handleAlertClose=()=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));};// Get data for the selected record from the api and set it in the form
const getDataBySlug=(0,react.useCallback)(()=>{module.getLeavesRecordById(record).then(res=>{if(res.data&&res.data.data){const _temp=[{name:"paidLeaves",value:Number(res.data.data.paidLeaves)},{name:"remainingLeaves",value:Number(res.data.data.remainingLeaves)},{name:"totalLeaveCredits",value:Number(res.data.data.totalLeaveCredits)},{name:"unpaidLeaves",value:Number(res.data.data.unpaidLeaves)}];setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data),{},{loading:false,data:_temp}));}}).catch(err=>{handleErrors(err);});},[form,record,module]);(0,react.useEffect)(()=>{if(type==="edit"){setRecordData({loading:true});getDataBySlug();}else{// fetch the countries
form.resetFields();}},[openModal,type,form,getDataBySlug]);const onFinish=formValues=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{buttonLoading:true}));if(manageAllUser===true){leaveCreditModule.createRecord({userId:record,daysCount:formValues.daysCount,note:formValues.note}).then(res=>{// reloadTableData();
getDataBySlug();form.resetFields();setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to update this user");}};// console.log(recordData?.data, 'asd')
return/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[recordData!==null&&recordData!==void 0&&recordData.loading?/*#__PURE__*/(0,jsx_runtime.jsx)(Skeletons/* default */.A,{items:10}):manageAllUser&&/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{className:styles_module/* default */.A.form,onFinish:onFinish,form:form,children:[(recordData===null||recordData===void 0?void 0:recordData.error)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomErrorAlert */.WZ,{description:recordData===null||recordData===void 0?void 0:recordData.error,isClosable:true,onClose:handleAlertClose}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"daysCount",rules:[{required:true,message:"Please add days count."}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Days Count",asterisk:true,type:"number"})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"note",rules:[{required:true,message:"Please add note."}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Note",asterisk:true,type:"text"})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{alignSelf:'center'},children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:recordData===null||recordData===void 0?void 0:recordData.buttonLoading,children:"Submit"})})]})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(PieChart/* PieChart */.r,{width:200,height:250,children:/*#__PURE__*/(0,jsx_runtime.jsxs)(Pie/* Pie */.F,{data:recordData===null||recordData===void 0?void 0:(_recordData$data=recordData.data)===null||_recordData$data===void 0?void 0:_recordData$data.slice(0,2),cx:"50%",cy:"50%",labelLine:false// label={renderCustomizedLabel}
,outerRadius:90,innerRadius:70,fill:"#8884d8",dataKey:"value",children:[recordData===null||recordData===void 0?void 0:(_recordData$data2=recordData.data)===null||_recordData$data2===void 0?void 0:_recordData$data2.map((entry,index)=>/*#__PURE__*/(0,jsx_runtime.jsx)(Cell/* Cell */.f,{fill:COLORS[index%COLORS.length]},"cell-".concat(index))),/*#__PURE__*/(0,jsx_runtime.jsx)(Label/* Label */.J,{value:(recordData!==null&&recordData!==void 0&&recordData.data?recordData===null||recordData===void 0?void 0:recordData.data[0].value:0)+" of "+(recordData!==null&&recordData!==void 0&&recordData.data?recordData===null||recordData===void 0?void 0:recordData.data[2].value:0)+" used",fontSize:16,position:"center"})]})}),recordData===null||recordData===void 0?void 0:(_recordData$data3=recordData.data)===null||_recordData$data3===void 0?void 0:_recordData$data3.slice(1).map((item,index)=>/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{style:{display:'flex',gap:'0.5rem',fontSize:'var(--font-size-sm)',color:'var(--color-dark-main)'},children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("p",{children:[item.name.replace(/([A-Z])/g," $1").charAt(0).toUpperCase()+item.name.replace(/([A-Z])/g," $1").slice(1),":"]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("p",{children:[item.value," days"]})]},index))]})]});};
;// ./src/Components/Organisms/Dashboard/Employees/modal.tsx
const EmployeeModal=props=>{const{openModal,onCancel,type,record,reloadTableData,permissions:{createUser,updateUser,manageAllUser}}=props;const[currentForm,setCurrentForm]=(0,react.useState)(props.currentForm);const formTabs=[{key:'1',label:"Basic Information"},{key:'2',label:"Additional Information",disabled:type==="edit"?false:true},{key:'3',label:"Files",disabled:type==="edit"?false:true},{key:'4',label:"Allocated Resources",disabled:type==="edit"?false:true},{key:'5',label:"Salary",disabled:type==="edit"?false:true},{key:'6',label:"Leaves Report",disabled:type==="edit"?false:true}];const formComponents={"1":EmployeeBasicForm,"2":Additional,"3":Files,"4":Resources,"5":Salary,"6":LeavesReport};const FormComponent=formComponents[currentForm];return/*#__PURE__*/(0,jsx_runtime.jsxs)(drawer/* default */.A,{title:type==="edit"?"Edit User":"Add New User",placement:"right",width:window.innerWidth>768?"60%":"100%",onClose:()=>onCancel(),open:openModal,bodyStyle:{padding:'0rem 2rem 1rem 2rem'},children:[/*#__PURE__*/(0,jsx_runtime.jsx)(tabs/* default */.A,{defaultActiveKey:currentForm,items:formTabs,onChange:e=>setCurrentForm(e)}),/*#__PURE__*/(0,jsx_runtime.jsx)(FormComponent,{type:type,openModal:openModal,record:record,onCancel:onCancel,createUser:createUser,updateUser:updateUser,manageAllUser:manageAllUser,setCurrentForm:setCurrentForm,reloadTableData:reloadTableData})]});};

/***/ }),

/***/ 23803:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   q: () => (/* binding */ CompanyAssetModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
class CompanyAssetModule{constructor(){this.endPoint="company-asset";/**Get all CompanyAsset records
     * @param query - query params
     */this.getAllRecords=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint,{params:query});};/**Get all CompanyAsset records
     * @param query - query params
     */this.getCars=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint+"/findCompanyCars",{params:query});};/**Get CompanyAsset record by id
     * @param id - CompanyAsset id
     */this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/").concat(id));};/**Delete CompanyAsset record
    * @param id - CompanyAsset id
    */this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete("".concat(this.endPoint,"/").concat(id));};/**Create new CompanyAsset record
     * @param data - CompanyAsset data
     */this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint,data);};/**Update CompanyAsset record
    * @param data - CompanyAsset data
    * @param id - CompanyAsset id
    */this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch("".concat(this.endPoint,"/").concat(id),data);};this.allocateResources=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post("".concat(this.endPoint,"/allocate"),data);};this.revokeResources=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete("".concat(this.endPoint,"/revoke/").concat(id));};}}

/***/ }),

/***/ 83584:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   j: () => (/* binding */ CountryModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
/* harmony import */ var _Common_config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(21073);
class CountryModule{constructor(){this.endPoint="country";this.allEndpoint="country/all";this.getAllRecords=()=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.allEndpoint);};this.getAvailableRecords=()=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/available-country"));};this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/").concat(id));};this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete("".concat(this.endPoint,"/").concat(id));};this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint+"/",data,{headers:_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch("".concat(this.endPoint,"/").concat(id),data,{headers:_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};}}

/***/ }),

/***/ 98924:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   d: () => (/* binding */ DepartmentModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
class DepartmentModule{constructor(){this.endPoint="department";this.getAllRecords=queryData=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint,{params:queryData});};this.getAllPublishedRecords=queryData=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint+"/find-published",{params:queryData});};this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint+"/"+id);};this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete(this.endPoint+"/"+id);};this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint,data);};this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch(this.endPoint+"/"+id,data);};}}

/***/ }),

/***/ 42361:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   I: () => (/* binding */ OrganizationModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
/* harmony import */ var _modules_Common_config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(21073);
class OrganizationModule{constructor(){this.endPoint="organization";/**Get all organization records
     * @param query - query params
     */this.getAllRecords=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint,{params:query});};/**Get all organization records
     * @param query - query params
     */this.findPublished=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint+"/find-published",{params:query});};/**Get organization record by id
     * @param id - organization id
     */this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/").concat(id));};/**Delete organization record
    * @param id - organization id
    */this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete("".concat(this.endPoint,"/").concat(id));};/**Create new organization record
     * @param data - organization data
     */this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint,data,{headers:_modules_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};/**Update organization record
    * @param data - organization data
    * @param id - organization id
    */this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch("".concat(this.endPoint,"/").concat(id),data,{headers:_modules_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};this.getTenants=()=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("xero/getTenants");};}}

/***/ }),

/***/ 32027:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   C: () => (/* binding */ RolesModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
class RolesModule{constructor(){this.endPoint="role";this.getAllRecords=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint,{params:query});};this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/").concat(id,"?all=true"));};this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete("".concat(this.endPoint,"/").concat(id));};this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint+"/",data);};this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch("".concat(this.endPoint,"/").concat(id),data);};/** Add Elements to Role
 * @param {number} id - The id of the Role
 * @param {number[]} data.elementIds - The ids of the Elements
 */this.addElements=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post("".concat(this.endPoint,"/addDashboardElement/").concat(id),data);};/**
	 * Remove Elements from Role
	 * @param {number} id - The id of the Role
	 * @param {number[]} data.elementIds - The ids of the Elements
	 */this.removeElements=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post("".concat(this.endPoint,"/removeDashboardElement/").concat(id),data);};}}

/***/ })

}]);