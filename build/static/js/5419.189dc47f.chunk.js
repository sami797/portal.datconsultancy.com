"use strict";
(self["webpackChunkdat_projects"] = self["webpackChunkdat_projects"] || []).push([[5419],{

/***/ 15419:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ SiteSettings_User)
});

// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js
var objectSpread2 = __webpack_require__(89379);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(9950);
// EXTERNAL MODULE: ./src/Components/Templates/SiteSettings/index.tsx
var SiteSettings = __webpack_require__(16181);
// EXTERNAL MODULE: ./node_modules/antd/es/select/index.js + 30 modules
var es_select = __webpack_require__(97554);
// EXTERNAL MODULE: ./node_modules/antd/es/form/index.js + 18 modules
var es_form = __webpack_require__(10678);
// EXTERNAL MODULE: ./node_modules/antd/es/message/index.js + 1 modules
var message = __webpack_require__(92759);
// EXTERNAL MODULE: ./node_modules/antd/es/empty/index.js + 2 modules
var empty = __webpack_require__(90247);
// EXTERNAL MODULE: ./node_modules/antd/es/input-number/index.js + 10 modules
var input_number = __webpack_require__(40202);
// EXTERNAL MODULE: ./src/Components/Atoms/index.tsx + 12 modules
var Atoms = __webpack_require__(9394);
// EXTERNAL MODULE: ./src/Components/Organisms/SiteSettings/Common/styles.module.scss
var styles_module = __webpack_require__(41394);
// EXTERNAL MODULE: ./src/Components/Organisms/Skeletons/index.tsx
var Skeletons = __webpack_require__(70619);
// EXTERNAL MODULE: ./src/helpers/constants.ts
var constants = __webpack_require__(65944);
// EXTERNAL MODULE: ./src/Components/Atoms/ServerErrorHandler/index.tsx
var ServerErrorHandler = __webpack_require__(13321);
// EXTERNAL MODULE: ./src/helpers/error-handler.ts
var error_handler = __webpack_require__(38266);
// EXTERNAL MODULE: ./src/Modules/User/index.ts
var User = __webpack_require__(47645);
// EXTERNAL MODULE: ./src/Modules/Country/index.ts
var Country = __webpack_require__(83584);
// EXTERNAL MODULE: ./src/helpers/useDebounce.ts
var useDebounce = __webpack_require__(28173);
// EXTERNAL MODULE: ./src/Modules/Organization/index.ts
var Organization = __webpack_require__(42361);
// EXTERNAL MODULE: ./src/Modules/Roles/index.ts
var Roles = __webpack_require__(32027);
// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js
var jsx_runtime = __webpack_require__(44414);
;// ./src/Components/Organisms/SiteSettings/User/modal.tsx
const{Option}=es_select/* default */.A;const SiteUserModal=props=>{var _recordData$data2,_recordData$data2$Org,_recordData$data3,_recordData$data4,_recordData$data5,_recordData$data6,_recordData$data7,_recordData$data8;const{openModal,onCancel,type,record,reloadTableData,permissions:{createUser,updateUser}}=props;const[form]=es_form/* default */.A.useForm();const module=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const[searchTerm,setSearchTerm]=(0,react.useState)("");const debouncedSearchTerm=(0,useDebounce/* useDebounce */.d)(searchTerm,500);const[organization,setOrganization]=(0,react.useState)([]);const orgModule=(0,react.useMemo)(()=>new Organization/* OrganizationModule */.I(),[]);const countryModule=(0,react.useMemo)(()=>new Country/* CountryModule */.j(),[]);const rolesModule=(0,react.useMemo)(()=>new Roles/* RolesModule */.C(),[]);const[recordData,setRecordData]=(0,react.useState)();const[countries,setCountries]=(0,react.useState)([]);const[roles,setRoles]=(0,react.useState)([]);const handleErrors=err=>{const error=(0,error_handler/* errorHandler */.r)(err);if(typeof error.message=="string"){setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:error.message}));}else{let errData=(0,ServerErrorHandler/* HandleServerErrors */.p)(error.message,[]);form.setFields(errData);setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));}};// Get the locations data from the api when the user searches for a location
const onOrgSearch=(0,react.useCallback)(()=>{if(debouncedSearchTerm){orgModule.findPublished({name:debouncedSearchTerm}).then(res=>{setOrganization(prev=>{var _res$data,_res$data$data;// if the data is already present in the state, then don't add it again
const filteredData=res===null||res===void 0?void 0:(_res$data=res.data)===null||_res$data===void 0?void 0:(_res$data$data=_res$data.data)===null||_res$data$data===void 0?void 0:_res$data$data.filter(item=>{return!(prev!==null&&prev!==void 0&&prev.find(prevItem=>prevItem.id===item.id));});// add the new data to the existing data
return[...prev,...filteredData];});}).catch(err=>{message/* default */.Ay.error(err.response.data.message);});}},[orgModule,debouncedSearchTerm]);(0,react.useEffect)(()=>{onOrgSearch();},[onOrgSearch]);const handleAlertClose=()=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));};// Get data for the selected record from the api and set it in the form
const getDataBySlug=(0,react.useCallback)(()=>{module.getRecordById(record).then(res=>{var _res$data2,_res$data2$data;const organization=res===null||res===void 0?void 0:(_res$data2=res.data)===null||_res$data2===void 0?void 0:(_res$data2$data=_res$data2.data)===null||_res$data2$data===void 0?void 0:_res$data2$data.organization;if(res.data&&res.data.data){var _res$data$data2,_res$data$data2$userC;form.setFieldsValue((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data.data),{},{translations:res.data.data.localization,isPublished:res.data.data.isPublished,userCountryList:(_res$data$data2=res.data.data)===null||_res$data$data2===void 0?void 0:(_res$data$data2$userC=_res$data$data2.userCountryList)===null||_res$data$data2$userC===void 0?void 0:_res$data$data2$userC.map(item=>item.countryId).join(","),organizationId:organization===null||organization===void 0?void 0:organization.id}));setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data),{},{loading:false}));}// get the organization data from the api
if(organization){orgModule.getRecordById(organization.id).then(res=>{var _res$data3;setOrganization([res===null||res===void 0?void 0:(_res$data3=res.data)===null||_res$data3===void 0?void 0:_res$data3.data]);}).catch(err=>{message/* default */.Ay.error(err.response.data.message);});}}).catch(err=>{handleErrors(err);});},[form,record,module,orgModule]);const getRoles=(0,react.useCallback)(()=>{if(type==="edit"||type==="seo")return;rolesModule.getAllRecords().then(res=>{var _res$data4;if(res.data&&(_res$data4=res.data)!==null&&_res$data4!==void 0&&_res$data4.data){var _res$data5;setRoles((_res$data5=res.data)===null||_res$data5===void 0?void 0:_res$data5.data);}}).catch(err=>{handleErrors(err);});},[rolesModule,type]);const getCountryList=(0,react.useCallback)(()=>{countryModule.getAvailableRecords().then(res=>{if(res.data&&res.data.data){setCountries(res.data.data);}});},[countryModule]);(0,react.useEffect)(()=>{if(type==="edit"){setRecordData({loading:true});// fetch data by slug or id
getDataBySlug();// fetch the countries
getCountryList();}else{// fetch the countries
getCountryList();form.resetFields();getRoles();}},[openModal,type,form,getDataBySlug,getCountryList,getRoles]);const onFinish=formValues=>{/** 
		* save the role ids in a variable and delete it from the formValues
		* so that it doesn't get sent to the server as a part of the form 
		* data when creating a new user
		* */const roleIds=formValues.roleIds;delete formValues.roleIds;// set default value for displayOrgContact
if(formValues.displayOrgContact===undefined){formValues.displayOrgContact=false;}setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{buttonLoading:true}));const formData=new FormData();const excludeFields=["profile","translations"];Object.entries(formValues).forEach(ele=>{if(!excludeFields.includes(ele[0])){formData.append(ele[0],ele[1]);}});if(formValues["profile"]&&typeof formValues["profile"]!=="string"&&formValues["profile"]["fileList"].length>0){formData.append("profile",formValues["profile"]["fileList"][0]["originFileObj"]);}if(formValues.translations){formValues.translations.forEach((item,index)=>{formData.append("translations[".concat(index+1,"][language]"),item.language);formData.append("translations[".concat(index+1,"][title]"),item.title);});}//TODO: Fix phone and phone code input group
formData.append('phoneCode',"971");switch(type){case"edit":{if(updateUser===true){var _recordData$data;module.updateRecord(formData,recordData===null||recordData===void 0?void 0:(_recordData$data=recordData.data)===null||_recordData$data===void 0?void 0:_recordData$data.id).then(res=>{reloadTableData();onCancel();setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to update this user");}break;}case"new":{if(createUser===true){module.createRecord(formData).then(async res=>{var _res$data6,_res$data6$data;// user id
const id=(_res$data6=res.data)===null||_res$data6===void 0?void 0:(_res$data6$data=_res$data6.data)===null||_res$data6$data===void 0?void 0:_res$data6$data.id;await module.addRoles({roleIds:roleIds},id).then(res=>{reloadTableData();onCancel();setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to create a new user");}break;}}};return/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomModal */.jo,{visible:openModal,closable:true,onCancel:onCancel,titleText:type==="edit"?"Edit User":"Add New User",showFooter:false,children:recordData!==null&&recordData!==void 0&&recordData.loading?/*#__PURE__*/(0,jsx_runtime.jsx)(Skeletons/* default */.A,{items:10}):/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{className:styles_module/* default */.A.form,onFinish:onFinish,form:form,children:[(recordData===null||recordData===void 0?void 0:recordData.error)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomErrorAlert */.WZ,{description:recordData===null||recordData===void 0?void 0:recordData.error,isClosable:true,onClose:handleAlertClose}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A.Item,{name:"organizationId",rules:[{required:true,message:"Please select an organization"}],children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{className:"font-size-sm",children:["Organization  ",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"color-red-yp",children:"*"})]}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_select/* default */.A,{allowClear:true,style:{width:"100%"},defaultValue:recordData===null||recordData===void 0?void 0:(_recordData$data2=recordData.data)===null||_recordData$data2===void 0?void 0:(_recordData$data2$Org=_recordData$data2.Organization)===null||_recordData$data2$Org===void 0?void 0:_recordData$data2$Org.id,placeholder:"Search for the organization",className:"selectAntdCustom",onChange:value=>form.setFieldsValue({organizationId:value}),showSearch:true,onSearch:value=>setSearchTerm(value),optionFilterProp:"label",options:organization===null||organization===void 0?void 0:organization.map(item=>{return{label:item.name,value:item.id};}),notFoundContent:/*#__PURE__*/(0,jsx_runtime.jsx)(empty/* default */.A,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:"No data found, Please search for the organization"})})})]})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"firstName",rules:[{required:type==="new"?true:false,message:"Please add first name"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"First Name",asterisk:type==="new",type:"text"})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"lastName",rules:[{required:type==="new"?true:false,message:"Please add last name"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Last Name",asterisk:type==="new",type:"text"})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"email",rules:[{required:type==="new"?true:false,message:"Please add email"},{type:"email",message:"Please add valid email"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Email",asterisk:type==="new",type:"email"})}),type==="new"&&/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"password",rules:[{required:true,message:"Please add password"},{min:6,message:"Password must be at least 6 characters"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Password",asterisk:true,type:"password"})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{className:"font-size-sm",children:["Phone  ",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"color-red-yp",children:"*"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"phone",rules:[{required:true,message:"Please add phone"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(input_number/* default */.A,{type:"number",addonBefore:/*#__PURE__*/(0,jsx_runtime.jsx)(es_select/* default */.A,{style:{width:98},placeholder:"Select phone code",defaultValue:type==="new"?"971":(recordData===null||recordData===void 0?void 0:(_recordData$data3=recordData.data)===null||_recordData$data3===void 0?void 0:_recordData$data3.phoneCode)||"971",children:countries===null||countries===void 0?void 0:countries.map(item=>{return/*#__PURE__*/(0,jsx_runtime.jsxs)(Option,{value:item.phoneCode,children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:item.flag}),/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"ml-1",children:"".concat(item.phoneCode)})]});})}),placeholder:"Enter phone number",defaultValue:type==="new"?"":recordData===null||recordData===void 0?void 0:(_recordData$data4=recordData.data)===null||_recordData$data4===void 0?void 0:_recordData$data4.phone,controls:false})})]})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"address",rules:[{required:type==="new"?true:false,message:"Please add address"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{size:"w100",label:"Address",asterisk:type==="new",type:"text"})})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"isPublished",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomSelect */.Ae,{label:"Published",options:[{value:true,label:"Yes"},{value:false,label:"No"}]})}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"preferences",children:/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"pt-1",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{label:"Preferences",type:"text",size:"w100"})})})]}),type==="new"&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A.Item,{name:"roleIds",rules:[{required:true,message:"Please select at least one role"}],children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{className:"font-size-sm",children:["Select Roles ",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"color-red-yp",children:"*"})]}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_select/* default */.A,{mode:"multiple",allowClear:true,style:{width:"100%"},placeholder:"Please select at least one role",className:"selectAntdCustom",onChange:value=>form.setFieldsValue({roleIds:value}),showSearch:true,optionFilterProp:"label",options:roles.map(role=>({label:role===null||role===void 0?void 0:role.title,value:role===null||role===void 0?void 0:role.id}))}),/*#__PURE__*/(0,jsx_runtime.jsx)("p",{className:"mb-0",children:/*#__PURE__*/(0,jsx_runtime.jsx)("small",{className:"color-dark-main",children:"Select roles for this user!. You can select multiple roles."})})]})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"whatsapp",children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{label:"WhatsApp Number",placeHolder:"Enter WhatsApp Number",size:"w100"})}),/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A.Item,{name:"displayOrgContact",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomSelect */.Ae,{label:"Display Organization Contact",options:[{value:true,label:"Yes"},{value:false,label:"No"}],placeholder:"Select Display Organization Contact",defaultValue:false}),/*#__PURE__*/(0,jsx_runtime.jsx)("p",{className:"mb-0",children:/*#__PURE__*/(0,jsx_runtime.jsx)("small",{className:"color-dark-main",children:"If you select yes, your organization contact will be displayed on your profile on Yallah agent page and agent properties."})})]})]}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* ImageUploader */.GA,{name:"profile",defaultFileList:type==="edit"&&recordData&&((_recordData$data5=recordData.data)===null||_recordData$data5===void 0?void 0:_recordData$data5.profile)&&[{uid:(_recordData$data6=recordData.data)===null||_recordData$data6===void 0?void 0:_recordData$data6.id,name:(_recordData$data7=recordData.data)===null||_recordData$data7===void 0?void 0:_recordData$data7.profile,status:"done",url:constants/* RESOURCE_BASE_URL */.to+((_recordData$data8=recordData.data)===null||_recordData$data8===void 0?void 0:_recordData$data8.profile)}]})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.footer,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{size:"normal",fontSize:"sm",onClick:onCancel,type:"plain",children:"Cancel"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:recordData===null||recordData===void 0?void 0:recordData.buttonLoading,children:"Submit"})]})]})});};
// EXTERNAL MODULE: ./node_modules/antd/es/typography/index.js + 15 modules
var typography = __webpack_require__(30377);
// EXTERNAL MODULE: ./node_modules/antd/es/card/index.js + 3 modules
var card = __webpack_require__(2557);
// EXTERNAL MODULE: ./node_modules/antd/es/tooltip/index.js
var tooltip = __webpack_require__(81541);
// EXTERNAL MODULE: ./node_modules/antd/es/divider/index.js
var divider = __webpack_require__(40895);
// EXTERNAL MODULE: ./node_modules/antd/es/popconfirm/index.js + 1 modules
var popconfirm = __webpack_require__(56231);
// EXTERNAL MODULE: ./node_modules/antd/es/dropdown/index.js
var dropdown = __webpack_require__(57811);
// EXTERNAL MODULE: ./node_modules/antd/es/space/index.js + 1 modules
var space = __webpack_require__(80737);
// EXTERNAL MODULE: ./node_modules/antd/es/image/index.js + 13 modules
var es_image = __webpack_require__(9206);
// EXTERNAL MODULE: ./node_modules/antd/es/progress/index.js + 10 modules
var progress = __webpack_require__(37781);
// EXTERNAL MODULE: ./node_modules/antd/es/table/index.js + 96 modules
var table = __webpack_require__(41821);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/DeleteOutlined.js
var DeleteOutlined = __webpack_require__(78433);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/DownOutlined.js
var DownOutlined = __webpack_require__(73022);
;// ./src/Components/Organisms/SiteSettings/User/styles.module.scss
// extracted by mini-css-extract-plugin
/* harmony default export */ const User_styles_module = ({"forgotPasswordImg":"styles_forgotPasswordImg__Q1IhJ","dropdown":"styles_dropdown__Is0-e","overlay":"styles_overlay__9W7Ib","overlay_item":"styles_overlay_item__EYmVw","overlay_card_item":"styles_overlay_card_item__mgL1x","disabledButton":"styles_disabledButton__-rsw+","profileScoreWrap":"styles_profileScoreWrap__fI029","scoreOverlay":"styles_scoreOverlay__42KrI","cardWrap":"styles_cardWrap__93EyI","card":"styles_card__j0oyn","card__green":"styles_card__green__qZ7pF","card__info":"styles_card__info__jrKoi","manualActionTooltip":"styles_manualActionTooltip__pXZ39"});
// EXTERNAL MODULE: ./src/Components/Icons/index.tsx + 58 modules
var Icons = __webpack_require__(63668);
// EXTERNAL MODULE: ./node_modules/antd/es/modal/index.js + 7 modules
var modal = __webpack_require__(32645);
// EXTERNAL MODULE: ./node_modules/antd/es/button/index.js
var es_button = __webpack_require__(48538);
// EXTERNAL MODULE: ./node_modules/antd/es/radio/index.js + 4 modules
var es_radio = __webpack_require__(17811);
// EXTERNAL MODULE: ./src/helpers/common.ts
var common = __webpack_require__(88132);
;// ./src/Components/Organisms/SiteSettings/User/ResetPassword/index.tsx
const{Paragraph}=typography/* default */.A;const ResetPasswordModal=_ref=>{let{isOpen,handleCancel,record,updateUser}=_ref;const[selectedOption,setSelectedOption]=(0,react.useState)("auto");const[step,setStep]=(0,react.useState)("select");const[password,setPassword]=(0,react.useState)("");const[showPassword,setShowPassword]=(0,react.useState)(false);const userModule=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const onResetClick=()=>{if(updateUser===true){const generatedPassword=(0,common/* generatePassword */.bk)();if(selectedOption==="auto"){setPassword(generatedPassword);}setStep("next");userModule.updateRecord({password:selectedOption==="auto"?generatedPassword:password},record===null||record===void 0?void 0:record.id).then(res=>{setStep("next");}).catch(err=>{var _err$response,_err$response$data;const msg=(err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||"Something went wrong";message/* default */.Ay.error(msg);});}else{const msg="You don't have permission to reset password for\n             ".concat(record===null||record===void 0?void 0:record.firstName," ").concat(record===null||record===void 0?void 0:record.lastName,", please contact\n             your administrator");message/* default */.Ay.error(msg);}};return/*#__PURE__*/(0,jsx_runtime.jsx)(modal/* default */.A,{title:"Reset password for ".concat(record===null||record===void 0?void 0:record.firstName," ").concat(record===null||record===void 0?void 0:record.lastName),visible:isOpen,onCancel:handleCancel,footer:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{className:"rounded-5",type:"text",onClick:handleCancel,children:"Cancel"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{className:"ml-2 rounded-5",type:"primary",onClick:()=>step==="select"?onResetClick():handleCancel(),children:step==="select"?"Reset":"Done"})]}),children:step==="select"?/*#__PURE__*/(0,jsx_runtime.jsxs)(es_radio/* default.Group */.Ay.Group,{name:"password-reset-options",style:{display:"flex",flexDirection:"column"},onChange:e=>setSelectedOption(e.target.value),defaultValue:selectedOption,children:[/*#__PURE__*/(0,jsx_runtime.jsxs)(es_radio/* default */.Ay,{value:"auto",className:"font-size-md color-dark-main",children:["Automatically generate a password",/*#__PURE__*/(0,jsx_runtime.jsx)("p",{className:"font-size-sm color-dark-sub mb-0",children:"You will be able to view and copy the password in the next step."})]}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_radio/* default */.Ay,{value:"create",className:"font-size-md color-dark-main mt-2",children:"Create password"}),selectedOption==="create"&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"mt-1 ml-6",children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A,{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomInput */.wi,{label:"Password",placeHolder:"Enter password",type:"password",className:"mb-2",onChange:e=>setPassword(e.target.value)})})})]}):/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("img",{src:"/images/forgot-password.svg",className:User_styles_module.forgotPasswordImg,alt:"forgot-password"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"md",weight:"semi",className:"text-center my-4",children:"Password has been reset successfully."}),/*#__PURE__*/(0,jsx_runtime.jsxs)(Paragraph,{copyable:{text:password},className:"font-size-md color-dark-main text-center mb-0",children:["Password: ","",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"font-weight-bold",children:showPassword?password:"********"})]}),/*#__PURE__*/(0,jsx_runtime.jsx)("p",{className:"font-size-sm color-dark-sub text-center mb-0 mt-2 cursor-pointer",onClick:()=>setShowPassword(!showPassword),children:showPassword?"Hide Password":"Show Password"})]})});};/* harmony default export */ const ResetPassword = (ResetPasswordModal);
// EXTERNAL MODULE: ./src/helpers/commonEnums.ts
var commonEnums = __webpack_require__(2360);
// EXTERNAL MODULE: ./node_modules/react-redux/es/index.js + 21 modules
var es = __webpack_require__(98341);
// EXTERNAL MODULE: ./src/Modules/Auth/index.tsx
var Auth = __webpack_require__(64076);
// EXTERNAL MODULE: ./src/services/tokenService.ts
var tokenService = __webpack_require__(92966);
;// ./src/Components/Organisms/SiteSettings/User/LoginAs/index.tsx
const LoginAsModal=_ref=>{let{isOpen,handleCancel,record,loginAsOtherUser}=_ref;const authModule=(0,react.useMemo)(()=>new Auth/* AuthModule */.r(),[]);const onContinueClick=()=>{if(loginAsOtherUser===true){authModule.loginAsUser(record===null||record===void 0?void 0:record.id).then(res=>{var _res$data;const data=res===null||res===void 0?void 0:(_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.data;if(data!==null&&data!==void 0&&data.token){var _data$token,_data$token2,_res$data$data;const msg="Login as ".concat(record===null||record===void 0?void 0:record.firstName," ").concat(record===null||record===void 0?void 0:record.lastName," successfully");// Get current data from local storage
const currentUser=tokenService/* default */.A.getUserData();const currentAccessToken=tokenService/* default */.A.getLocalAccessToken()||"";const currentRefreshToken=tokenService/* default */.A.getLocalRefreshToken()||"";// Save old data in temp variable in local storage
tokenService/* default */.A.saveTempUserData(currentUser);tokenService/* default */.A.updateTempAccessToken(currentAccessToken);tokenService/* default */.A.updateTempRefreshToken(currentRefreshToken);// Update user data and token in local storage with new data
tokenService/* default */.A.updateLocalAccessToken(data===null||data===void 0?void 0:(_data$token=data.token)===null||_data$token===void 0?void 0:_data$token.access_token);tokenService/* default */.A.updateLocalRefreshToken(data===null||data===void 0?void 0:(_data$token2=data.token)===null||_data$token2===void 0?void 0:_data$token2.refresh_token);tokenService/* default */.A.saveUserData((_res$data$data=res.data.data)===null||_res$data$data===void 0?void 0:_res$data$data.userData);message/* default */.Ay.success(msg);handleCancel();// Redirect to dashboard
window.location.href='/';}}).catch(err=>{var _err$response,_err$response$data;const errorMessage=(err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||"Login as ".concat(record===null||record===void 0?void 0:record.firstName," ").concat(record===null||record===void 0?void 0:record.lastName," failed");message/* default */.Ay.error(errorMessage);});}else{const msg="You don't have permission to login as \n            ".concat(record===null||record===void 0?void 0:record.firstName," ").concat(record===null||record===void 0?void 0:record.lastName,",\n             please contact your administrator");message/* default */.Ay.error(msg);}};return/*#__PURE__*/(0,jsx_runtime.jsx)(modal/* default */.A,{title:"Login as ".concat(record===null||record===void 0?void 0:record.firstName," ").concat(record===null||record===void 0?void 0:record.lastName),visible:isOpen,onCancel:handleCancel,footer:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{className:"rounded-5",type:"text",onClick:handleCancel,children:"Cancel"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{className:"ml-2 rounded-5",type:"primary",onClick:()=>onContinueClick(),children:"Continue"})]}),children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-main",size:"normal",className:"text-center my-4",children:"When logging in as ".concat(record===null||record===void 0?void 0:record.firstName," ").concat(record===null||record===void 0?void 0:record.lastName,",\n                    we'll send them an email to let them know you've logged in\n                    as them. including your name and email address.")})});};/* harmony default export */ const LoginAs = (LoginAsModal);
;// ./src/Components/Organisms/SiteSettings/User/user-score.tsx
// import { ProfileScoringStatus } from "../../../../helpers/commonEnums";
function UserScoreModal(props){const{children,user}=props;const[open,setOpen]=(0,react.useState)(false);// Memoize userScoring to avoid re-rendering
//const userScoring = useMemo(() => user?.userScoring, [user]);
// const getStyles = (status: number) => {
//     switch (status) {
//         case ProfileScoringStatus.can_be_improved:
//             return styles.card__info;
//         case ProfileScoringStatus.success:
//             return styles.card__green;
//         case ProfileScoringStatus.error:
//             return styles.card;
//         default:
//             return '';
//     }
// }
// const getIcon = (status: number) => {
//     switch (status) {
//         case ProfileScoringStatus.can_be_improved:
//             return <InfoCircleOutlined />;
//         case ProfileScoringStatus.success:
//             return <CheckOutlined />;
//         case ProfileScoringStatus.error:
//             return <CloseOutlined />;
//         default:
//             return '';
//     }
// }
const overlay=/*#__PURE__*/(0,jsx_runtime.jsx)(card/* default */.A,{className:User_styles_module.scoreOverlay,children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex justify-space-between",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-main",size:"lg",children:"".concat(user.firstName," ").concat(user.lastName,"'s Score")}),/*#__PURE__*/(0,jsx_runtime.jsx)(Icons/* XMarkIcon */.fK,{onClick:()=>setOpen(false),style:{cursor:'pointer'}})]})});return/*#__PURE__*/(0,jsx_runtime.jsx)(dropdown/* default */.A,{dropdownRender:()=>overlay// trigger={user.profileScore > 0 ? ['click'] : []}
,open:open,onOpenChange:()=>setOpen(true),children:children});}/* harmony default export */ const user_score = (UserScoreModal);
// EXTERNAL MODULE: ./src/helpers/dateHandler.ts
var dateHandler = __webpack_require__(98933);
;// ./src/Components/Organisms/SiteSettings/User/table-columns.tsx
const{Paragraph: table_columns_Paragraph}=typography/* default */.A;const ActionComponent=props=>{const{record,onEditIconClick,reloadTableData,onCountryAccessClick,onPasswordResetClick,onLoginAsClick,permissions:{deleteUser,updateUser,loginAsOtherUser,addUserCountry}}=props;const{loggedInUserData}=(0,es/* useSelector */.d4)(state=>state.usersReducer);const userData=loggedInUserData===null||loggedInUserData===void 0?void 0:loggedInUserData.data;const[actionState,setActionState]=(0,react.useState)({confirmLoading:false,openPopConfirm:false});const[visible,setVisible]=(0,react.useState)(false);const module=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const handleDelete=()=>{setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{confirmLoading:true}));if(deleteUser===false){message/* default */.Ay.error("You don't have permission to delete this user, please contact your admin.");setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false}));return;}module.deleteRecord(record.id).then(res=>{setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false,confirmLoading:false}));reloadTableData();setVisible(false);message/* default */.Ay.success(res.data.message);}).catch(err=>{setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{confirmLoading:false}));message/* default */.Ay.error(err.message||"Something went wrong");});};// Handle Manual Action
const handleManualAction=data=>{const{value,message:actionMessage,id}=data;const _value=value.replace("_","");const finalData={value:Number(_value),message:actionMessage};module.manualAction(finalData,id).then(res=>{reloadTableData();setVisible(false);message/* default */.Ay.success(res.data.message);}).catch(err=>{message/* default */.Ay.error(err.message||"Something went wrong");});};const showPopconfirm=()=>{setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:true}));};const overlay=/*#__PURE__*/(0,jsx_runtime.jsxs)(card/* default */.A,{className:"".concat(User_styles_module.overlay," pa-2"),children:[addUserCountry===true&&/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"".concat(styles_module/* default */.A.actions," ").concat(User_styles_module.overlay_card_item),onClick:()=>{onCountryAccessClick(record);setVisible(false);},children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Icons/* FlagIcon */.iF,{width:18,height:18,color:"#fff"})}),"Country Access"]}),updateUser===true&&/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"".concat(styles_module/* default */.A.actions," ").concat(User_styles_module.overlay_card_item),onClick:()=>{onEditIconClick(record);setVisible(false);},children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:/*#__PURE__*/(0,jsx_runtime.jsx)("img",{src:"/images/editicon.svg",alt:""})}),"Edit"]}),updateUser===true&&/*#__PURE__*/(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:!(commonEnums/* SuperAdminEmails */.UI!==null&&commonEnums/* SuperAdminEmails */.UI!==void 0&&commonEnums/* SuperAdminEmails */.UI.includes(record.email))?/*#__PURE__*/(0,jsx_runtime.jsx)(tooltip/* default */.A,{title:"Reset Password for this user.",placement:"left",children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"".concat(styles_module/* default */.A.actions," ").concat(User_styles_module.overlay_card_item),onClick:()=>{onPasswordResetClick(record);setVisible(false);},children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Icons/* PasswordUnlock */.gj,{color:"#fff",width:18,height:18})}),"Reset Password"]})}):/*#__PURE__*/(0,jsx_runtime.jsx)(tooltip/* default */.A,{title:"You cannot reset password for super admin.",placement:"left",children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"".concat(styles_module/* default */.A.actions," ").concat(User_styles_module.overlay_card_item),style:{cursor:"not-allowed",opacity:"0.6"},children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Icons/* PasswordUnlock */.gj,{color:"#fff",width:18,height:18})}),"Reset Password"]})})}),loginAsOtherUser===true&&/*#__PURE__*/(0,jsx_runtime.jsx)(tooltip/* default */.A,{title:"Login as ".concat(record===null||record===void 0?void 0:record.firstName," ").concat(record===null||record===void 0?void 0:record.lastName),placement:"left",children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"".concat(styles_module/* default */.A.actions," ").concat(User_styles_module.overlay_card_item),onClick:()=>{onLoginAsClick(record);setVisible(false);},children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:/*#__PURE__*/(0,jsx_runtime.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",color:"#fff",width:20,height:20,children:/*#__PURE__*/(0,jsx_runtime.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"})})}),"Login as"]})}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* ManualAction */.RS,{onConfirm:data=>{handleManualAction({value:data.value,message:data.message,id:record.id});},children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"".concat(styles_module/* default */.A.actions," ").concat(User_styles_module.overlay_card_item),children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Icons/* FlagIcon */.iF,{width:18,height:18,color:"#fff"})}),"Manual Action"]})}),/*#__PURE__*/(0,jsx_runtime.jsx)(divider/* default */.A,{className:"my-2"}),(userData===null||userData===void 0?void 0:userData.id)===(record===null||record===void 0?void 0:record.id)?/*#__PURE__*/(0,jsx_runtime.jsx)(tooltip/* default */.A,{title:"You cannot delete yourself.",children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.actions,style:{cursor:"not-allowed",opacity:"0.2"},children:[/*#__PURE__*/(0,jsx_runtime.jsx)(DeleteOutlined/* default */.A,{className:styles_module/* default */.A.bg__red}),"Delete User"]})}):/*#__PURE__*/(0,jsx_runtime.jsx)(popconfirm/* default */.A,{open:actionState.openPopConfirm,placement:"left",title:"Are you sure?",onConfirm:handleDelete,onCancel:()=>setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false})),okButtonProps:{loading:actionState.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:visible=>{if(!visible){setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false}));}},children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.actions,style:{cursor:'pointer'},onClick:showPopconfirm,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(DeleteOutlined/* default */.A,{className:styles_module/* default */.A.bg__red}),"Delete User"]})})]});return/*#__PURE__*/(0,jsx_runtime.jsx)(dropdown/* default */.A,{trigger:["click"],dropdownRender:()=>overlay,open:visible,onOpenChange:visible=>setVisible(visible),children:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{style:{cursor:"pointer",padding:'5px'},children:/*#__PURE__*/(0,jsx_runtime.jsx)(Icons/* MoreIcon */.Z4,{height:25,width:25,color:"#7e869a"})})});};const statusColors={1:"#00A884",2:"#f50"};const StatusComponent=props=>{const{record,status,reloadTableData,permissions:{updateUser}}=props;const[messageApi,contextHolder]=message/* default */.Ay.useMessage();const module=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const openMessage=data=>{messageApi.open({key:data.key,type:data.type,content:data.content,duration:data.type==="loading"?0:2});};// controls the dropdown visibility
const[visible,setVisible]=(0,react.useState)(false);// handle dropdown menu visibility change event
const onVisibleChange=flag=>{setVisible(flag);};const onStatusChange=status=>{if(record!==null&&record!==void 0&&record.id&&updateUser===true){openMessage({key:"update",type:"loading",content:"Updating..."});module.updateRecord({status:status},record===null||record===void 0?void 0:record.id).then(res=>{var _res$data;if(res!==null&&res!==void 0&&(_res$data=res.data)!==null&&_res$data!==void 0&&_res$data.data){var _res$data2;openMessage({key:"update",type:"success",content:res===null||res===void 0?void 0:(_res$data2=res.data)===null||_res$data2===void 0?void 0:_res$data2.message});setVisible(!visible);reloadTableData();}}).catch(err=>{var _err$response,_err$response$data;openMessage({key:"update",type:"error",content:err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message});});}else{openMessage({key:"update",type:"error",content:"You don't have permission to change status"});}};const overlay=/*#__PURE__*/(0,jsx_runtime.jsxs)(card/* default */.A,{className:"".concat(User_styles_module.overlay," pa-2"),children:[contextHolder,Object.entries(commonEnums/* UserStatus */._O).map(_ref=>{let[key,value]=_ref;return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:User_styles_module.overlay_item,onClick:()=>{if(status!==Number(value)&&updateUser===true){const selectedStatus=Number(value);onStatusChange(selectedStatus);}},children:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:status===Number(value)?User_styles_module.disabledButton:"",children:(0,common/* capitalize */.ZH)(key)})},"user-status-".concat(key));})]});return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(dropdown/* default */.A,{dropdownRender:()=>overlay,trigger:updateUser===true?["click"]:[],open:updateUser===true?visible:false,onOpenChange:onVisibleChange,className:User_styles_module.dropdown,children:/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)(space/* default */.A,{style:{backgroundColor:statusColors[status],color:"#fff",padding:"0.2rem 0.5rem",borderRadius:"0.25rem",fontSize:"0.8rem",display:"flex",width:"100%",justifyContent:"space-between"},children:[Object.entries(commonEnums/* UserStatus */._O).map(_ref2=>{let[key,value]=_ref2;return value===String(status)&&(0,common/* capitalize */.ZH)(key);}),updateUser===true&&/*#__PURE__*/(0,jsx_runtime.jsx)(DownOutlined/* default */.A,{})]})})})});};function TableComponent(props){const{tableData,tableLoading,onEditIconClick,reloadTableData,onManageRolesClick,onCountryAccessClick}=props;const{userPermissions}=(0,es/* useSelector */.d4)(state=>state.usersReducer);const permissions=userPermissions;const{updateUser,loginAsOtherUser}=permissions;//TODO: show manual action in table
// controls the password reset modal visibility
const[passwordResetModal,setPasswordResetModal]=(0,react.useState)({isOpen:false,record:undefined});const onPasswordResetClick=record=>{if(updateUser===true){setPasswordResetModal({isOpen:true,record:record});}else{message/* default */.Ay.error("You don't have permission to reset password for ".concat(record===null||record===void 0?void 0:record.firstName," ").concat(record===null||record===void 0?void 0:record.lastName));return;}};// controls the login as modal visibility
const[loginAsModal,setLoginAsModal]=(0,react.useState)({isOpen:false,record:undefined});const onLoginAsClick=record=>{if(loginAsOtherUser===true){setLoginAsModal({isOpen:true,record:record});}else{message/* default */.Ay.error("You don't have permission to login as ".concat(record===null||record===void 0?void 0:record.firstName," ").concat(record===null||record===void 0?void 0:record.lastName));return;}};const columns=[{title:"S.No",dataIndex:"index",key:"index",render:(text,record,index)=>index+1,width:"5%"},{title:"ID / UUID",dataIndex:"uuid",key:"uuid",render:(uuid,record)=>/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsxs)(table_columns_Paragraph,{className:"font-size-xs color-dark-sub"//copyable={{ text: record.id.toString() }}
,title:record.id.toString(),children:["[",record.id,"]"]}),/*#__PURE__*/(0,jsx_runtime.jsxs)(table_columns_Paragraph,{title:uuid,ellipsis:{rows:1,expandable:false},copyable:{text:uuid},className:"font-size-xs color-dark-sub",children:["[",uuid,"]"]})]}),width:"120px"},{title:"Name",dataIndex:"name",key:"name",render:(_text,record)=>{var _record$Organization,_record$Organization2;//const manualAction = `_${record.manualAction}` as keyof typeof ManualActionScoreColor;
return/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-main",size:"sm",weight:"bold",className:"my-auto mr-1",children:"".concat(record.firstName," ").concat(record.lastName)})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(table_columns_Paragraph,{ellipsis:{rows:1,expandable:false},className:"my-0 color-dark-sub",children:/*#__PURE__*/(0,jsx_runtime.jsx)("a",{href:"mailto:".concat(record.email),className:"font-size-xs",children:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"color-dark-sub",children:record.email})})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:record.phone?/*#__PURE__*/(0,jsx_runtime.jsx)("a",{href:"tel:".concat(record.phone),className:"color-dark-sub font-size-xs",children:record.phone!==null&&record.phoneCode!==null?"+"+(record===null||record===void 0?void 0:record.phoneCode)+record.phone:"N/A"}):/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"xs",children:"N/A"})}),record.addedDate&&/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex mt-4",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Icons/* CalenderIcon */.e$,{className:"mr-2"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"sm",children:"".concat((0,dateHandler/* convertDate */.ic)(record.addedDate,"dd MM yy"))})]}),((_record$Organization=record.Organization)===null||_record$Organization===void 0?void 0:_record$Organization.name)&&/*#__PURE__*/(0,jsx_runtime.jsxs)(table_columns_Paragraph,{ellipsis:{rows:1,expandable:false},className:"my-0 color-dark-sub font-size-sm mt-2",children:["Org:",(_record$Organization2=record.Organization)===null||_record$Organization2===void 0?void 0:_record$Organization2.name]})]});}},{title:"Profile",dataIndex:"profile",key:"profile",render:(profile,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(es_image/* default */.A,{width:40,height:40,src:"".concat(constants/* RESOURCE_BASE_URL */.to).concat(profile),preview:false,rootClassName:"object-fit-cover",style:{borderRadius:"100%"}}),width:"200px"},{title:"Profile Score",dataIndex:"profileScore",key:"profileScore",render:(profileScore,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(user_score,{user:record,children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:User_styles_module.profileScoreWrap,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(progress/* default */.A,{type:"circle",format:()=>"",percent:profileScore,status:"success",width:25,strokeWidth:12}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"sm",children:"".concat(profileScore?"".concat(profileScore,"%"):"0%")})]})})},{title:"Stats",dataIndex:"averageReplyTime",key:"averageReplyTime",render:(averageReplyTime,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"sm",children:"Avg. Reply Time: ".concat(averageReplyTime)})})},{title:"Role",dataIndex:"role",key:"role",render:(text,record)=>/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(table_columns_Paragraph,{ellipsis:{rows:1,expandable:false},className:"my-0 color-dark-sub",children:/*#__PURE__*/(0,jsx_runtime.jsx)("ul",{style:{listStyle:"none",padding:0},children:record.userRole.map(item=>/*#__PURE__*/(0,jsx_runtime.jsx)("li",{className:"font-size-xs ml-0",children:item.Role.title}))})}),/*#__PURE__*/(0,jsx_runtime.jsx)("p",{className:"color-dark-main font-weight-bold font-size-sm mb-0 ml-1 cursor-pointer",onClick:()=>onManageRolesClick(record),children:"Manage Roles"})]})},{title:"Status",dataIndex:"status",key:"status",render:(status,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(StatusComponent,{status:status,record:record,reloadTableData:reloadTableData,permissions:permissions}),width:"150px"},{title:"Actions",dataIndex:"actions",key:"actions",render:(text,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(ActionComponent,{record:record,onEditIconClick:onEditIconClick,reloadTableData:reloadTableData,onCountryAccessClick:onCountryAccessClick,onPasswordResetClick:onPasswordResetClick,onLoginAsClick:onLoginAsClick,permissions:permissions}),className:"text-center"}];return/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:styles_module/* default */.A.antdTableWrapper,children:/*#__PURE__*/(0,jsx_runtime.jsx)(table/* default */.A,{sticky:true,dataSource:tableData,columns:columns,pagination:false,scroll:{x:991},loading:tableLoading,rowKey:record=>"site-user-".concat(record.id)})}),passwordResetModal.isOpen&&/*#__PURE__*/(0,jsx_runtime.jsx)(ResetPassword,{isOpen:passwordResetModal.isOpen,handleCancel:()=>setPasswordResetModal((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},passwordResetModal),{},{isOpen:false})),record:passwordResetModal.record,updateUser:updateUser}),loginAsModal.isOpen&&/*#__PURE__*/(0,jsx_runtime.jsx)(LoginAs,{isOpen:loginAsModal.isOpen,handleCancel:()=>setLoginAsModal((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},loginAsModal),{},{isOpen:false})),record:loginAsModal.record,loginAsOtherUser:loginAsOtherUser})]});}
// EXTERNAL MODULE: ./src/Components/Atoms/Input/index.tsx + 2 modules
var Input = __webpack_require__(58516);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js
var objectWithoutProperties = __webpack_require__(80045);
// EXTERNAL MODULE: ./node_modules/antd/es/checkbox/index.js + 2 modules
var es_checkbox = __webpack_require__(52765);
;// ./src/Components/Organisms/common___/styles.module.scss
// extracted by mini-css-extract-plugin
/* harmony default export */ const common_styles_module = ({"freeText":"styles_freeText__lwTd8","active":"styles_active__YMGVN","checkboxGroup":"styles_checkboxGroup__1MJL5","dateWrap":"styles_dateWrap__bAc5u","inputsWrap":"styles_inputsWrap__pJMGI","dropdownItem":"styles_dropdownItem__MTlJV","noOption":"styles_noOption__ihY1O","searchItems":"styles_searchItems__mS8H3","webIdFilter":"styles_webIdFilter__J7zx9","footerButtonWrap":"styles_footerButtonWrap__URK4M"});
// EXTERNAL MODULE: ./src/Components/Atoms/DropDown/index.tsx
var DropDown = __webpack_require__(44625);
;// ./src/Components/Organisms/common___/moreFilters.tsx
const _excluded=["value","onChange","data","filters","type","label","onFilter","show","filterType","getChild","showFooter","searchProps"];function MoreFilters(props){const{values,setValues,setVisible,visible,moreItems}=props;const[,setSearchVal]=(0,react.useState)("");const[filteredMoreItems,setFilteredMoreItems]=(0,react.useState)(moreItems);const handleVisibleChange=flag=>{setVisible(flag);};const onSearchChange=(0,react.useCallback)(e=>{setSearchVal(e.target.value);setFilteredMoreItems(moreItems.filter(item=>item.label.toLowerCase().includes(e.target.value)));},[moreItems]);return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"".concat(common_styles_module.freeText),children:/*#__PURE__*/(0,jsx_runtime.jsx)(DropDown/* default */.A,{onVisibleChange:handleVisibleChange,visible:visible,items:[{key:1,label:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Input/* default */.A,{size:"w100",onChange:onSearchChange,placeHolder:"Search",icon:/*#__PURE__*/(0,jsx_runtime.jsx)("img",{src:"/images/searchIcon.svg",alt:""})}),(filteredMoreItems===null||filteredMoreItems===void 0?void 0:filteredMoreItems.length)>0?/*#__PURE__*/(0,jsx_runtime.jsx)(es_checkbox/* default */.A.Group,{value:values,onChange:setValues,className:common_styles_module.checkboxGroup,options:filteredMoreItems===null||filteredMoreItems===void 0?void 0:filteredMoreItems.map(item=>({label:item.label,value:item.value}))}):/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:common_styles_module.noOption,children:"No Options"})]})}],children:"More+"})});}const MultiSelectFilter=props=>{var _filters$type,_filters$type2,_data$filter$,_filters$type3;const[visible,setVisible]=(0,react.useState)(false);const handleVisibleChange=flag=>{setVisible(flag);};const{value,onChange,data,filters,type,label,onFilter,show,filterType="multi",getChild,showFooter=true,searchProps}=props,rest=(0,objectWithoutProperties/* default */.A)(props,_excluded);const[selectedItems,setSelectedItems]=(0,react.useState)([]);(0,react.useEffect)(()=>{setVisible(show);},[show]);const onDeleteItem=id=>{let newData=value.filter(item=>item!==id);setSelectedItems(prv=>prv.filter(item=>item.value!==id));onChange(newData,type);};const onCheckChange=e=>{if(searchProps){let[difference]=new Set([...e.filter(x=>value.indexOf(x)===-1),...value.filter(x=>e.indexOf(x)===-1)]);let newData=data.filter(item=>item.value===difference);setSelectedItems(prv=>{let currentData=!prv.filter(item=>item.value===difference).length?[newData[0],...prv]:prv.filter(item=>item.value!==difference);let newIds=currentData.map(item=>item.value);onChange(newIds,type);return currentData;});}else{onChange(e,type);}};const children=/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[filterType==="multi"?/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[searchProps?/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Input/* default */.A,(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({icon:/*#__PURE__*/(0,jsx_runtime.jsx)("img",{src:"/images/searchIcon.svg",alt:""}),size:"w100",placeHolder:"Enter value"},rest),{},{allowClear:true,onChange:e=>searchProps.onSearch(e.target.value)})),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:common_styles_module.searchItems,children:selectedItems.map(item=>/*#__PURE__*/(0,jsx_runtime.jsxs)("span",{children:[item===null||item===void 0?void 0:item.name,/*#__PURE__*/(0,jsx_runtime.jsx)("h5",{onClick:()=>onDeleteItem(item.value),children:"X"})]}))})]}):null,/*#__PURE__*/(0,jsx_runtime.jsx)(es_checkbox/* default */.A.Group,{value:value,onChange:onCheckChange,className:common_styles_module.checkboxGroup,options:data})]}):filterType==="single"?/*#__PURE__*/(0,jsx_runtime.jsx)(es_radio/* default.Group */.Ay.Group,{value:value,onChange:e=>onChange(e.target.value,type),className:common_styles_module.checkboxGroup,options:data}):/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:common_styles_module.webIdFilter,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Input/* default */.A,(0,objectSpread2/* default */.A)({value:value,placeHolder:"Enter value",type:type,onChange:e=>{if(type==="number"){return onChange(e,type);}return onChange(e.target.value,type);},allowClear:true},rest)),/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{type:"primary",onClick:()=>{if(type==="email"&&!(0,common/* validateEmail */.DT)(value)){return message/* default */.Ay.error("Please enter valid email");}onFilter(setVisible);},children:"Update"})]}),showFooter?/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:common_styles_module.footerButtonWrap,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{onClick:()=>{setSelectedItems([]);onChange([],type);},children:"Reset"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{type:"primary",onClick:()=>onFilter(setVisible),children:"Update"})]}):null]});if(getChild===true){return children;}return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"".concat(common_styles_module.freeText," ").concat((_filters$type=filters[type])!==null&&_filters$type!==void 0&&_filters$type.length?common_styles_module.active:""),children:/*#__PURE__*/(0,jsx_runtime.jsxs)(DropDown/* default */.A,{visible:visible,onVisibleChange:handleVisibleChange,items:[{key:1,label:children?children:""}],children:[((_filters$type2=filters[type])===null||_filters$type2===void 0?void 0:_filters$type2.length)>0?"".concat(label,": ").concat(filterType==="single"?data.filter(item=>item.value===filters[type])[0].label:filterType==="input"?filters[type]:searchProps?(_data$filter$=data.filter(item=>item.value===filters[type][0])[0])===null||_data$filter$===void 0?void 0:_data$filter$.name:data.filter(item=>item.value===filters[type][0])[0].label):label,((_filters$type3=filters[type])===null||_filters$type3===void 0?void 0:_filters$type3.length)>1&&filterType==="multi"?/*#__PURE__*/(0,jsx_runtime.jsx)("h5",{children:"+".concat(filters[type].length-1)}):null]})});};
// EXTERNAL MODULE: ./node_modules/antd/es/date-picker/index.js + 56 modules
var date_picker = __webpack_require__(4132);
// EXTERNAL MODULE: ./src/Components/Atoms/Headings/index.tsx
var Headings = __webpack_require__(35751);
;// ./src/Components/Organisms/common___/multiInputFilters.tsx
const MultiInputFilter=props=>{var _filters$subTypes$,_ref,_filters$subTypes$2,_ref2;const[visible,setVisible]=(0,react.useState)(false);const handleVisibleChange=flag=>{setVisible(flag);};const{values,onChange,filters,labels,label,onFilter,show,subTypes,type,showFooter,children,types=["input","input"]}=props;(0,react.useEffect)(()=>{setVisible(show);},[show]);return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"".concat(common_styles_module.freeText," ").concat(filters[subTypes[0]]?common_styles_module.active:""),children:/*#__PURE__*/(0,jsx_runtime.jsxs)(DropDown/* default */.A,{visible:visible,onVisibleChange:handleVisibleChange,items:[{key:1,label:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:types[0]==="input"?common_styles_module.inputsWrap:common_styles_module.dateWrap,children:[subTypes[0]?/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:types[0]==="input"?/*#__PURE__*/(0,jsx_runtime.jsx)(Input/* default */.A,{size:"w100",value:values[0],label:labels[0],placeHolder:"",onChange:e=>onChange(e.target.value,subTypes[0])}):/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Headings/* default */.A,{color:"dark-main",size:"sm",children:labels[0]}),/*#__PURE__*/(0,jsx_runtime.jsx)(date_picker/* default */.A,{value:values[0],onChange:e=>onChange(e,subTypes[0])})]})}):null,subTypes[1]?/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:types[1]==="input"?/*#__PURE__*/(0,jsx_runtime.jsx)(Input/* default */.A,{size:"w100",value:values[1],label:labels[1],placeHolder:"",onChange:e=>onChange(e.target.value,subTypes[1])}):/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Headings/* default */.A,{color:"dark-main",size:"sm",children:labels[1]}),/*#__PURE__*/(0,jsx_runtime.jsx)(date_picker/* default */.A,{value:values[1],onChange:e=>onChange(e,subTypes[1])})]})}):null]}),children?children:null,showFooter?/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:common_styles_module.footerButtonWrap,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{onClick:()=>{onChange(null,type);},children:"Reset"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{type:"primary",onClick:()=>onFilter(setVisible),children:"Update"})]}):null]})}],children:[subTypes!==null&&subTypes!==void 0&&subTypes.length?"".concat((_filters$subTypes$=filters[subTypes[0]])!==null&&_filters$subTypes$!==void 0&&_filters$subTypes$.length?"".concat(label,":").concat(filters[subTypes[0]]):(_ref=filters[subTypes[0]]&&Object.keys(filters[subTypes[0]]))!==null&&_ref!==void 0&&_ref.length?"".concat(label,":").concat((0,dateHandler/* convertDate */.ic)(filters[subTypes[0]],"dd/mm/yy")):label):label,(subTypes===null||subTypes===void 0?void 0:subTypes.length)>1?"".concat((_filters$subTypes$2=filters[subTypes[1]])!==null&&_filters$subTypes$2!==void 0&&_filters$subTypes$2.length?" - ".concat(filters[subTypes[1]]):(_ref2=filters[subTypes[1]]&&Object.keys(filters[subTypes[1]]))!==null&&_ref2!==void 0&&_ref2.length?" - ".concat((0,dateHandler/* convertDate */.ic)(filters[subTypes[1]],"dd/mm/yy")):""):null,(subTypes===null||subTypes===void 0?void 0:subTypes.length)>2?"".concat(filters[subTypes[2]]?" ( ".concat(filters[subTypes[2]]," )"):""):null]})});};
;// ./src/Components/Organisms/SiteSettings/User/filters/index.tsx
const publishOptions=[{label:"Published",value:"true"},{label:"Not Published",value:"false"},{label:"Ascending",value:"asc"},{label:"Descending",value:"desc"}];const moreItems=[{label:"Organization",value:"organization"},{label:"Email",value:"email"},{label:"Phone",value:"phone"},{label:"Role",value:"role"}];const sortByField=[{label:"Name",value:"name"},{label:"Email",value:"email"},{label:"Date Added",value:"addedDate"}];const Filters=_ref=>{var _organizationData$dat;let{filters,setFilters}=_ref;const[searchTerm,setSearchTerm]=(0,react.useState)("");const debouncedSearchTerm=(0,useDebounce/* useDebounce */.d)(searchTerm,500);const[moreFilters,setMoreFilters]=(0,react.useState)([]);const[currentMoreFilter,setCurrentMoreFilters]=(0,react.useState)("");const[moreVisible,setMoreVisible]=(0,react.useState)(false);const[organizationData,setOrganizationData]=(0,react.useState)({data:[],loading:false});const[rolesData,setRolesData]=(0,react.useState)([]);const[reset,setReset]=(0,react.useState)(false);const[orgSearchTerm,setOrgSearchTerm]=(0,react.useState)("");const debouncedOrgSearchTerm=(0,useDebounce/* useDebounce */.d)(orgSearchTerm,500);// Modules
const module=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const orgModule=(0,react.useMemo)(()=>new Organization/* OrganizationModule */.I(),[]);const rolesModule=(0,react.useMemo)(()=>new Roles/* RolesModule */.C(),[]);const[prefilterData,setPreFilterData]=(0,react.useState)({});(0,react.useEffect)(()=>{if(debouncedSearchTerm){setFilters((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prefilterData),{},{name:debouncedSearchTerm}));}else{setFilters((0,objectSpread2/* default */.A)({},prefilterData));}},[debouncedSearchTerm]);const onFilter=(0,react.useCallback)(values=>{setFilters((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prefilterData),values));},[prefilterData,setFilters]);const onFilterValueChange=(0,react.useCallback)((data,type)=>{let filterData=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prefilterData),{},{[type]:data});if(type==="phone"){filterData.phone=data===null||data===void 0?void 0:data.replace(/[^0-9]/g,"");}if(type==="date"){filterData.fromDate=null;filterData.toDate=null;setFilters(filterData);}else if((data===null||data===void 0?void 0:data.length)===0){setFilters(filterData);}setPreFilterData(filterData);},[prefilterData,setFilters]);const onMoreFiltersUpdate=data=>{setMoreFilters(prv=>{let[difference]=new Set([...data.filter(x=>prv.indexOf(x)===-1),...prv.filter(x=>data.indexOf(x)===-1)]);setMoreVisible(false);if(prv.includes(difference)){const filterData=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prefilterData),{},{[difference]:[]});setPreFilterData(filterData);setFilters(filterData);}else{setCurrentMoreFilters(difference);}return data;});};// get the search result for the organization
const GetSearchResult=(0,react.useCallback)(()=>{if(debouncedOrgSearchTerm){setOrganizationData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:true}));orgModule.findPublished({name:debouncedOrgSearchTerm}).then(res=>{var _res$data;const data=(_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.data;if(data){// remove duplicate data
const uniqueData=data.filter((item,index)=>{return data.findIndex(ele=>ele.id===item.id)===index;});setOrganizationData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{data:uniqueData}));}}).catch(err=>{var _err$response,_err$response$data;message/* default */.Ay.error((err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||"Something went wrong");}).finally(()=>{setOrganizationData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:false}));});}},[debouncedOrgSearchTerm,orgModule]);(0,react.useEffect)(()=>{GetSearchResult();},[GetSearchResult]);(0,react.useEffect)(()=>{if(reset){onFilter();}// after 2 seconds set reset clicked state to false
const timer=setTimeout(()=>{setReset(false);},2000);return()=>clearTimeout(timer);},[reset,prefilterData.organizationId,onFilter]);(0,react.useEffect)(()=>{rolesModule.getAllRecords().then(res=>{var _res$data2;const data=(_res$data2=res.data)===null||_res$data2===void 0?void 0:_res$data2.data;if(data){setRolesData(data);}}).catch(err=>{var _err$response2,_err$response2$data;message/* default */.Ay.error((err===null||err===void 0?void 0:(_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||"Something went wrong");});},[]);// More filter components
const moreFilterComponents={email:/*#__PURE__*/(0,jsx_runtime.jsx)(MultiSelectFilter,{filterType:"input",value:prefilterData.email,onChange:onFilterValueChange,type:"email",label:"Email",filters:filters,data:[],onFilter:onFilter,show:currentMoreFilter==="email",showFooter:false}),phone:/*#__PURE__*/(0,jsx_runtime.jsx)(MultiSelectFilter,{filterType:"input",value:prefilterData.phone,onChange:onFilterValueChange,type:"phone",label:"Phone",placeHolder:"Enter phone",filters:filters,data:[],onFilter:onFilter,show:currentMoreFilter==="phone",showFooter:false}),organization:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"radio",label:"Organization",name:"organizationId",withSearch:true,options:(organizationData===null||organizationData===void 0?void 0:(_organizationData$dat=organizationData.data)===null||_organizationData$dat===void 0?void 0:_organizationData$dat.map(item=>({label:item.name,value:"".concat(item.id)})))||[],onChange:event=>{const{value}=event.target;setPreFilterData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prefilterData),{},{organizationId:value}));},value:prefilterData===null||prefilterData===void 0?void 0:prefilterData.organizationId,onReset:()=>{setReset(true);setPreFilterData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prefilterData),{},{organizationId:""}));// reset the search term
setOrgSearchTerm("");},onUpdate:()=>onFilter()// START: For search
,loading:organizationData===null||organizationData===void 0?void 0:organizationData.loading,searchTerm:orgSearchTerm,onSearch:event=>setOrgSearchTerm(event.currentTarget.value)// END: For search
}),role:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"multiSelect",label:"Role",name:"roleIds",options:rolesData===null||rolesData===void 0?void 0:rolesData.map(item=>({label:item.title,value:"".concat(item.id)})),onChange:value=>setPreFilterData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prefilterData),{},{roleIds:value})),onReset:()=>{setReset(true);setPreFilterData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prefilterData),{},{roleIds:[]}));onFilterValueChange([],"roleIds");},onUpdate:()=>onFilter()})};const onFilterReset=()=>{setSearchTerm("");setFilters({});setPreFilterData({});setMoreFilters([]);module.getAllRecords();};const showResetAll=(0,react.useMemo)(()=>{const filtersLength=Object.entries(filters).filter(_ref2=>{let[,value]=_ref2;return value&&value.length>0?true:false;}).length;return filtersLength>0||searchTerm.length>0;},[filters,searchTerm]);return/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex align-center",children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Input/* default */.A,{value:searchTerm,onChange:e=>setSearchTerm(e.target.value),size:"w100",label:"",placeHolder:"Search by Name",icon:/*#__PURE__*/(0,jsx_runtime.jsx)("img",{src:"/images/searchIcon.svg",alt:""})})}),/*#__PURE__*/(0,jsx_runtime.jsx)(MultiSelectFilter,{filterType:"single",show:false,value:prefilterData.status,onChange:onFilterValueChange,type:"status",label:"Status",filters:filters,data:Object.entries(commonEnums/* UserStatus */._O).map(_ref3=>{let[key,value]=_ref3;return{label:(0,common/* capitalize */.ZH)(key),value:value};}),onFilter:onFilter}),/*#__PURE__*/(0,jsx_runtime.jsx)(MultiInputFilter,{values:[prefilterData.fromDate,prefilterData.toDate],onChange:onFilterValueChange,subTypes:["fromDate","toDate"],label:"Registered Between",type:"date",labels:["From Date","To Date"],filters:filters,onFilter:onFilter,show:false,showFooter:true,types:["fromDate","toDate"]}),/*#__PURE__*/(0,jsx_runtime.jsx)(MultiSelectFilter,{filterType:"single",show:false,value:prefilterData.isPublished,onChange:onFilterValueChange,type:"isPublished",label:"Published",filters:filters,data:publishOptions,onFilter:onFilter}),Object.keys(moreFilterComponents).map(item=>moreFilters.includes(item)?moreFilterComponents[item]:null),/*#__PURE__*/(0,jsx_runtime.jsx)(MoreFilters,{values:moreFilters,setValues:onMoreFiltersUpdate,setVisible:setMoreVisible,visible:moreVisible,moreItems:moreItems}),showResetAll&&/*#__PURE__*/(0,jsx_runtime.jsx)("p",{onClick:onFilterReset,style:{cursor:"pointer",color:"red",marginBottom:"0"},children:"Reset All"}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{marginLeft:"auto",marginRight:"0px"},children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"radio",label:"Sort By",name:"sortByField",options:sortByField,onChange:event=>{const{value}=event.target;setPreFilterData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prefilterData),{},{sortByField:value}));},value:prefilterData===null||prefilterData===void 0?void 0:prefilterData.sortByField,onReset:()=>{setReset(true);setPreFilterData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prefilterData),{},{sortByField:""}));},onUpdate:query=>onFilter(query),withSort:true})})]});};/* harmony default export */ const User_filters = (Filters);
// EXTERNAL MODULE: ./node_modules/antd/es/transfer/index.js + 5 modules
var transfer = __webpack_require__(97579);
;// ./src/Components/Organisms/SiteSettings/User/Roles/modal.tsx
const UserRoleModal=props=>{var _rolesData$data;const{openModal,onCancel,record,reloadTableData,recordData,permissions:{addUserRole}}=props;const[form]=es_form/* default */.A.useForm();// user module
const module=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const roleModule=(0,react.useMemo)(()=>new Roles/* RolesModule */.C(),[]);const[rolesData,setRolesData]=(0,react.useState)();let selectedKeys=[];if(recordData&&recordData.userRole){var _recordData$userRole;recordData===null||recordData===void 0?void 0:(_recordData$userRole=recordData.userRole)===null||_recordData$userRole===void 0?void 0:_recordData$userRole.map(ele=>selectedKeys.push(ele.Role.id.toString()));}const[targetKeys,setTargetKeys]=(0,react.useState)(selectedKeys);const handleErrors=err=>{const error=(0,error_handler/* errorHandler */.r)(err);if(typeof error.message=="string"){setRolesData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},rolesData),{},{error:error.message}));}else{let errData=(0,ServerErrorHandler/* HandleServerErrors */.p)(error.message,[]);form.setFields(errData);setRolesData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},rolesData),{},{error:""}));}};const handleAlertClose=()=>{setRolesData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},rolesData),{},{error:""}));};const getRolesData=(0,react.useCallback)(()=>{roleModule.getAllRecords().then(res=>{var _res$data;if(res.data&&(_res$data=res.data)!==null&&_res$data!==void 0&&_res$data.data){setRolesData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data),{},{loading:false}));}}).catch(err=>{handleErrors(err);});},[form,record,module,roleModule]);const filterOption=(inputValue,option)=>{var _option$description;return(option===null||option===void 0?void 0:(_option$description=option.description)===null||_option$description===void 0?void 0:_option$description.indexOf(inputValue===null||inputValue===void 0?void 0:inputValue.toLowerCase()))>-1;};const handleChange=newTargetKeys=>{setTargetKeys(newTargetKeys);};(0,react.useEffect)(()=>{setRolesData({loading:true});getRolesData();},[openModal,form]);const onFinish=formValues=>{if(formValues.roleIds){if(addUserRole===true){var _formValues$roleIds;setRolesData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},rolesData),{},{buttonLoading:true}));const formData=formValues===null||formValues===void 0?void 0:(_formValues$roleIds=formValues.roleIds)===null||_formValues$roleIds===void 0?void 0:_formValues$roleIds.map(ele=>Number(ele));module.addRoles({roleIds:formData},record).then(res=>{reloadTableData();onCancel();setRolesData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:false}));message/* default */.Ay.success("Saved Successfully");}).catch(err=>{handleErrors(err);setRolesData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:false}));});let removedRoles=[];selectedKeys.map(ele=>!targetKeys.includes(ele)&&removedRoles.push(Number(ele)));if((removedRoles===null||removedRoles===void 0?void 0:removedRoles.length)>0){module.removeRoles({roleIds:removedRoles},record).catch(err=>{message/* default */.Ay.error(err.message);});}}else{message/* default */.Ay.error("You don't have permission to manage roles, please contact admin");}}else{message/* default */.Ay.info("No changes made");onCancel();}};return/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomModal */.jo,{visible:openModal,closable:true,onCancel:onCancel,titleText:"Manage Roles",showFooter:false,children:rolesData!==null&&rolesData!==void 0&&rolesData.loading?/*#__PURE__*/(0,jsx_runtime.jsx)(Skeletons/* default */.A,{items:10}):/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{className:styles_module/* default */.A.form,onFinish:onFinish,form:form,children:[(rolesData===null||rolesData===void 0?void 0:rolesData.error)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomErrorAlert */.WZ,{description:rolesData===null||rolesData===void 0?void 0:rolesData.error,isClosable:true,onClose:handleAlertClose}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"roleIds",rules:[{required:false}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(transfer/* default */.A,{dataSource:rolesData===null||rolesData===void 0?void 0:(_rolesData$data=rolesData.data)===null||_rolesData$data===void 0?void 0:_rolesData$data.map((ele,index)=>{var _ele$title;return{key:ele.id.toString(),title:ele.title,description:(_ele$title=ele.title)===null||_ele$title===void 0?void 0:_ele$title.toLowerCase()};}),listStyle:{width:250,height:400},showSearch:true,filterOption:filterOption,targetKeys:targetKeys,onChange:handleChange,render:item=>item.title})})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.footer,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{size:"normal",fontSize:"sm",onClick:onCancel,type:"plain",children:"Cancel"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:rolesData===null||rolesData===void 0?void 0:rolesData.buttonLoading,children:"Save"})]})]})});};
;// ./src/Components/Organisms/SiteSettings/User/CountryAccess/modal.tsx
const UserCountryAccessModal=props=>{var _countries$data;const{openModal,onCancel,record,reloadTableData,recordData,permissions:{addUserCountry,removeUserCountry}}=props;const[form]=es_form/* default */.A.useForm();// user module
const module=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const countryModule=(0,react.useMemo)(()=>new Country/* CountryModule */.j(),[]);const[userData,setUserData]=(0,react.useState)();const[countries,setCountries]=(0,react.useState)();let selectedKeys=[];// if (recordData && recordData?.userCountry) {
// 	recordData?.userCountry?.map((ele) => selectedKeys.push(ele.countryId.toString()))
// }
const[targetKeys,setTargetKeys]=(0,react.useState)(selectedKeys);const handleErrors=err=>{const error=(0,error_handler/* errorHandler */.r)(err);if(typeof error.message=="string"){setUserData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},userData),{},{error:error.message}));}else{let errData=(0,ServerErrorHandler/* HandleServerErrors */.p)(error.message,[]);form.setFields(errData);setUserData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},userData),{},{error:""}));}};const handleAlertClose=()=>{setUserData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},userData),{},{error:""}));};const getUserData=(0,react.useCallback)(()=>{module.getRecordById(record).then(res=>{if(res.data&&res.data.data){setUserData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data),{},{loading:false}));}}).catch(err=>{handleErrors(err);});countryModule.getAllRecords().then(res=>{if(res.data&&res.data.data){setCountries((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data),{},{loading:false}));}}).catch(err=>{handleErrors(err);});},[form,record,module,countryModule]);const filterOption=(inputValue,option)=>option.description.indexOf(inputValue.toLowerCase())>-1;const handleChange=newTargetKeys=>{setTargetKeys(newTargetKeys);};(0,react.useEffect)(()=>{setUserData({loading:true});getUserData();},[openModal,form]);const onFinish=async formValues=>{if(formValues.userCountryList){var _formValues$userCount;setUserData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},userData),{},{buttonLoading:true}));const formData=formValues===null||formValues===void 0?void 0:(_formValues$userCount=formValues.userCountryList)===null||_formValues$userCount===void 0?void 0:_formValues$userCount.map(ele=>Number(ele));if(addUserCountry===true){await module.addCountryAccess({userCountryList:formData,userId:record}).then(res=>{setUserData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:false}));message/* default */.Ay.success("Saved Successfully");}).catch(err=>{handleErrors(err);setUserData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{loading:false}));});}else{message/* default */.Ay.error("You don't have permission to add country access");}let removedCountries=[];selectedKeys.map(ele=>!targetKeys.includes(ele)&&removedCountries.push(Number(ele)));if((removedCountries===null||removedCountries===void 0?void 0:removedCountries.length)>0){if(removeUserCountry===true){await module.removeCountryAccess({userCountryList:removedCountries,userId:record}).catch(err=>{message/* default */.Ay.error(err.message);});}else{message/* default */.Ay.error("You don't have permission to remove country access");}}reloadTableData();onCancel();}else{message/* default */.Ay.info("No changes made");onCancel();}};return/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomModal */.jo,{visible:openModal,closable:true,onCancel:onCancel,titleText:"Manage User Country Access",showFooter:false,children:userData!==null&&userData!==void 0&&userData.loading?/*#__PURE__*/(0,jsx_runtime.jsx)(Skeletons/* default */.A,{items:10}):/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{className:styles_module/* default */.A.form,onFinish:onFinish,form:form,children:[(userData===null||userData===void 0?void 0:userData.error)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomErrorAlert */.WZ,{description:userData===null||userData===void 0?void 0:userData.error,isClosable:true,onClose:handleAlertClose}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"userCountryList",rules:[{required:false}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(transfer/* default */.A,{dataSource:countries===null||countries===void 0?void 0:(_countries$data=countries.data)===null||_countries$data===void 0?void 0:_countries$data.map((ele,index)=>{var _ele$name;return{key:ele.id.toString(),title:ele.name,description:(_ele$name=ele.name)===null||_ele$name===void 0?void 0:_ele$name.toLowerCase()};}),listStyle:{width:250,height:400},showSearch:true,filterOption:filterOption,targetKeys:targetKeys,onChange:handleChange,render:item=>item.title})})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.footer,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{size:"normal",fontSize:"sm",onClick:onCancel,type:"plain",children:"Cancel"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:userData===null||userData===void 0?void 0:userData.buttonLoading,children:"Save"})]})]})});};
// EXTERNAL MODULE: ./src/Modules/User/permissions.ts + 2 modules
var User_permissions = __webpack_require__(39905);
// EXTERNAL MODULE: ./src/Components/Atoms/ErrorCodes/index.tsx + 1 modules
var ErrorCodes = __webpack_require__(36250);
;// ./src/Components/Organisms/SiteSettings/User/index.tsx
const breadCrumbsData=[{text:"Home",isLink:true,path:"/"},{isLink:true,text:"Site Settings",path:"/siteSettings"},{isLink:false,text:"Users"}];function SiteUserSettings(){var _moduleData$meta3,_moduleData$meta4,_moduleData$meta5,_moduleData$meta6;// available permissions for this module
const permissionSlug=(0,common/* getPermissionSlugs */.AH)(User_permissions/* UserPermissionsEnum */.v);const{userPermissions}=(0,es/* useSelector */.d4)(state=>state.usersReducer);const permissions=userPermissions;const{readUser,createUser,updateUser,addUserCountry,addUserRole}=permissions;const[currentEditType,setcurrentEditType]=(0,react.useState)({editType:"new",recordId:0,openModal:false});const[editUserRoles,setEditUserRoles]=(0,react.useState)({recordId:0,openModal:false,recordData:{}});const[editUserCountryAccess,setEditCountryAccess]=(0,react.useState)({recordId:0,openModal:false,recordData:{}});const module=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const[moduleData,setModuleData]=(0,react.useState)({loading:false,error:{},data:[]});const[filters,setFilters]=(0,react.useState)({});const onCancelClick=()=>{if(createUser===false){message/* default */.Ay.error("You don't have permission to create new user");return;}setcurrentEditType((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},currentEditType),{},{openModal:!currentEditType.openModal,editType:"new"}));};const onEditIconClick=record=>{if(updateUser===false){message/* default */.Ay.error("You don't have permission to update this user");return;}setcurrentEditType((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},currentEditType),{},{editType:"edit",recordId:record.id,openModal:true}));};const onManageRolesClick=record=>{if(addUserRole===false){message/* default */.Ay.error("You don't have permission to manage roles for this user");return;}setEditUserRoles((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},editUserRoles),{},{recordId:record.id,recordData:record,openModal:true}));};const onCountryAccessClick=record=>{if(addUserCountry===false){message/* default */.Ay.error("You don't have permission to manage country access for this user");return;}setEditCountryAccess((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},editUserCountryAccess),{},{recordId:record.id,recordData:record,openModal:true}));};const reloadTableData=(0,react.useCallback)(query=>{var _moduleData$meta,_moduleData$meta2;setModuleData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},moduleData),{},{loading:true}));let __filtersData=(0,objectSpread2/* default */.A)({},filters);if(__filtersData!==null&&__filtersData!==void 0&&__filtersData.fromDate){var _filtersData$fromDat;let date=__filtersData===null||__filtersData===void 0?void 0:(_filtersData$fromDat=__filtersData.fromDate)===null||_filtersData$fromDat===void 0?void 0:_filtersData$fromDat.format("YYYY-MM-DD");__filtersData.fromDate=date;}if(__filtersData!==null&&__filtersData!==void 0&&__filtersData.toDate){var _filtersData$toDate;let date=__filtersData===null||__filtersData===void 0?void 0:(_filtersData$toDate=__filtersData.toDate)===null||_filtersData$toDate===void 0?void 0:_filtersData$toDate.format("YYYY-MM-DD");__filtersData.toDate=date;}let filteredData={};Object.entries(__filtersData).map(_ref=>{let[key,value]=_ref;return/*#__PURE__*/(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:value&&typeof value==="number"?filteredData[key]=value:value&&value.length>0?filteredData[key]=value:null});});const finalParams=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({page:moduleData===null||moduleData===void 0?void 0:(_moduleData$meta=moduleData.meta)===null||_moduleData$meta===void 0?void 0:_moduleData$meta.page,perPage:moduleData===null||moduleData===void 0?void 0:(_moduleData$meta2=moduleData.meta)===null||_moduleData$meta2===void 0?void 0:_moduleData$meta2.perPage},filteredData),query);module.getAllRecords(finalParams).then(res=>{setModuleData(res.data);}).catch(err=>{var _err$response;setModuleData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},moduleData),{},{loading:false,error:err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data}));});},[filters,module]);(0,react.useEffect)(()=>{reloadTableData();},[reloadTableData]);// Pagination change
const onPaginationChange=(page,pageSize)=>reloadTableData({page,perPage:pageSize});return/*#__PURE__*/(0,jsx_runtime.jsxs)(SiteSettings["default"],{permissionSlug:permissionSlug,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* PageHeader */.zY,{heading:"Users",buttonText:"Add New User",onButtonClick:onCancelClick,breadCrumbData:breadCrumbsData,filters:readUser===true?/*#__PURE__*/(0,jsx_runtime.jsx)(User_filters,{filters:filters,setFilters:setFilters}):null,showAdd:createUser===true?true:false}),readUser===true&&/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(TableComponent,{tableData:moduleData.data,tableLoading:moduleData.loading,onEditIconClick:onEditIconClick,reloadTableData:reloadTableData,onManageRolesClick:onManageRolesClick,onCountryAccessClick:onCountryAccessClick}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Pagination */.dK,{total:moduleData===null||moduleData===void 0?void 0:(_moduleData$meta3=moduleData.meta)===null||_moduleData$meta3===void 0?void 0:_moduleData$meta3.total,current:moduleData===null||moduleData===void 0?void 0:(_moduleData$meta4=moduleData.meta)===null||_moduleData$meta4===void 0?void 0:_moduleData$meta4.page,defaultPageSize:moduleData!==null&&moduleData!==void 0&&(_moduleData$meta5=moduleData.meta)!==null&&_moduleData$meta5!==void 0&&_moduleData$meta5.perPage?moduleData===null||moduleData===void 0?void 0:(_moduleData$meta6=moduleData.meta)===null||_moduleData$meta6===void 0?void 0:_moduleData$meta6.perPage:10,pageSizeOptions:[10,20,50,100],onChange:onPaginationChange})]}),readUser===false&&/*#__PURE__*/(0,jsx_runtime.jsx)(ErrorCodes/* ErrorCode403 */.$t,{mainMessage:"You don't have permission to view this data"}),currentEditType.openModal&&/*#__PURE__*/(0,jsx_runtime.jsx)(SiteUserModal,{record:currentEditType.recordId,type:currentEditType.editType,reloadTableData:reloadTableData,onCancel:onCancelClick,openModal:currentEditType.openModal,permissions:permissions}),editUserRoles.openModal&&/*#__PURE__*/(0,jsx_runtime.jsx)(UserRoleModal,{record:editUserRoles.recordId,recordData:editUserRoles.recordData,type:"edit",reloadTableData:reloadTableData,onCancel:()=>setEditUserRoles((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},editUserRoles),{},{openModal:false})),openModal:editUserRoles.openModal,permissions:permissions}),editUserCountryAccess.openModal&&/*#__PURE__*/(0,jsx_runtime.jsx)(UserCountryAccessModal,{record:editUserCountryAccess.recordId,recordData:editUserCountryAccess.recordData,type:"edit",reloadTableData:reloadTableData,onCancel:()=>setEditCountryAccess((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},editUserCountryAccess),{},{openModal:false})),openModal:editUserCountryAccess.openModal,permissions:permissions})]});}/* harmony default export */ const SiteSettings_User = (SiteUserSettings);

/***/ }),

/***/ 83584:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   j: () => (/* binding */ CountryModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
/* harmony import */ var _Common_config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(21073);
class CountryModule{constructor(){this.endPoint="country";this.allEndpoint="country/all";this.getAllRecords=()=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.allEndpoint);};this.getAvailableRecords=()=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/available-country"));};this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/").concat(id));};this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete("".concat(this.endPoint,"/").concat(id));};this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint+"/",data,{headers:_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch("".concat(this.endPoint,"/").concat(id),data,{headers:_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};}}

/***/ }),

/***/ 42361:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   I: () => (/* binding */ OrganizationModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
/* harmony import */ var _modules_Common_config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(21073);
class OrganizationModule{constructor(){this.endPoint="organization";/**Get all organization records
     * @param query - query params
     */this.getAllRecords=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint,{params:query});};/**Get all organization records
     * @param query - query params
     */this.findPublished=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint+"/find-published",{params:query});};/**Get organization record by id
     * @param id - organization id
     */this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/").concat(id));};/**Delete organization record
    * @param id - organization id
    */this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete("".concat(this.endPoint,"/").concat(id));};/**Create new organization record
     * @param data - organization data
     */this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint,data,{headers:_modules_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};/**Update organization record
    * @param data - organization data
    * @param id - organization id
    */this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch("".concat(this.endPoint,"/").concat(id),data,{headers:_modules_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};this.getTenants=()=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("xero/getTenants");};}}

/***/ }),

/***/ 32027:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   C: () => (/* binding */ RolesModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
class RolesModule{constructor(){this.endPoint="role";this.getAllRecords=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint,{params:query});};this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/").concat(id,"?all=true"));};this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete("".concat(this.endPoint,"/").concat(id));};this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint+"/",data);};this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch("".concat(this.endPoint,"/").concat(id),data);};/** Add Elements to Role
 * @param {number} id - The id of the Role
 * @param {number[]} data.elementIds - The ids of the Elements
 */this.addElements=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post("".concat(this.endPoint,"/addDashboardElement/").concat(id),data);};/**
	 * Remove Elements from Role
	 * @param {number} id - The id of the Role
	 * @param {number[]} data.elementIds - The ids of the Elements
	 */this.removeElements=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post("".concat(this.endPoint,"/removeDashboardElement/").concat(id),data);};}}

/***/ })

}]);