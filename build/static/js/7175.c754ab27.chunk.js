"use strict";
(self["webpackChunkdat_projects"] = self["webpackChunkdat_projects"] || []).push([[7175],{

/***/ 57175:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ Dashboard_Biometrics)
});

// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js
var objectSpread2 = __webpack_require__(89379);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(9950);
// EXTERNAL MODULE: ./node_modules/antd/es/select/index.js + 30 modules
var es_select = __webpack_require__(97554);
// EXTERNAL MODULE: ./node_modules/antd/es/form/index.js + 18 modules
var es_form = __webpack_require__(10678);
// EXTERNAL MODULE: ./node_modules/antd/es/message/index.js + 1 modules
var message = __webpack_require__(92759);
// EXTERNAL MODULE: ./node_modules/antd/es/empty/index.js + 2 modules
var empty = __webpack_require__(90247);
// EXTERNAL MODULE: ./node_modules/antd/es/date-picker/index.js + 56 modules
var date_picker = __webpack_require__(4132);
// EXTERNAL MODULE: ./src/Components/Atoms/index.tsx + 12 modules
var Atoms = __webpack_require__(9394);
// EXTERNAL MODULE: ./src/Components/Organisms/Common/styles.module.scss
var styles_module = __webpack_require__(96019);
// EXTERNAL MODULE: ./src/Components/Organisms/Skeletons/index.tsx
var Skeletons = __webpack_require__(70619);
// EXTERNAL MODULE: ./src/Components/Atoms/ServerErrorHandler/index.tsx
var ServerErrorHandler = __webpack_require__(13321);
// EXTERNAL MODULE: ./src/helpers/error-handler.ts
var error_handler = __webpack_require__(38266);
// EXTERNAL MODULE: ./src/helpers/useDebounce.ts
var useDebounce = __webpack_require__(28173);
// EXTERNAL MODULE: ./src/Modules/Biometrics/index.ts
var Biometrics = __webpack_require__(64573);
// EXTERNAL MODULE: ./src/Modules/User/index.ts
var User = __webpack_require__(47645);
// EXTERNAL MODULE: ./node_modules/moment/moment.js
var moment = __webpack_require__(59051);
var moment_default = /*#__PURE__*/__webpack_require__.n(moment);
// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js
var jsx_runtime = __webpack_require__(44414);
;// ./src/Components/Organisms/Dashboard/Biometrics/modal.tsx
const{Option}=es_select/* default */.A;const BiometricModal=props=>{var _recordData$data;const{openModal,onCancel,type,record,reloadTableData,permissions:{createBiometrics,updateBiometrics}}=props;const[form]=es_form/* default */.A.useForm();const module=new Biometrics/* BiometricModule */.H();const[recordData,setRecordData]=(0,react.useState)();//user search
const[searchTermUser,setSearchTermUser]=(0,react.useState)("");const debouncedSearchTermUser=(0,useDebounce/* useDebounce */.d)(searchTermUser,500);const[users,setUsers]=(0,react.useState)([]);const userModule=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const onUserSearch=(0,react.useCallback)(()=>{if(debouncedSearchTermUser){userModule.getAllRecords({name:debouncedSearchTermUser}).then(res=>{setUsers(prev=>{var _res$data,_res$data$data;// if the data is already present in the state, then don't add it again
const filteredData=res===null||res===void 0?void 0:(_res$data=res.data)===null||_res$data===void 0?void 0:(_res$data$data=_res$data.data)===null||_res$data$data===void 0?void 0:_res$data$data.filter(item=>{return!(prev!==null&&prev!==void 0&&prev.find(prevItem=>prevItem.id===item.id));});// add the new data to the existing data
return[...prev,...filteredData];});}).catch(err=>{message/* default */.Ay.error(err.response.data.message);});}},[debouncedSearchTermUser]);(0,react.useEffect)(()=>{onUserSearch();},[onUserSearch]);const handleErrors=err=>{const error=(0,error_handler/* errorHandler */.r)(err);if(typeof error.message=="string"){setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:error.message}));}else{let errData=(0,ServerErrorHandler/* HandleServerErrors */.p)(error.message,[]);form.setFields(errData);setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));}};const handleAlertClose=()=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{error:""}));};const getDataBySlug=(0,react.useCallback)(()=>{module.getRecordById(record).then(res=>{var _res$data2,_res$data2$data;const userId=res===null||res===void 0?void 0:(_res$data2=res.data)===null||_res$data2===void 0?void 0:(_res$data2$data=_res$data2.data)===null||_res$data2$data===void 0?void 0:_res$data2$data.userId;if(res.data&&res.data.data){form.setFieldsValue((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data.data),{},{userId:userId,checkIn:moment_default()(res.data.data.checkIn)}));setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},res.data),{},{loading:false}));// get the employee data from the api
if(userId){userModule.getRecordById(userId).then(res=>{var _res$data3;setUsers([res===null||res===void 0?void 0:(_res$data3=res.data)===null||_res$data3===void 0?void 0:_res$data3.data]);}).catch(err=>{message/* default */.Ay.error(err.response.data.message);});}}}).catch(err=>{handleErrors(err);});},[form,record,module]);(0,react.useEffect)(()=>{if(type==="edit"){setRecordData({loading:true});getDataBySlug();}else{form.resetFields();}},[]);const onFinish=formValues=>{setRecordData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},recordData),{},{buttonLoading:true}));switch(type){case"edit":{if(updateBiometrics===true){module.updateRecord((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},formValues),{},{checkIn:formValues.checkIn._d.toISOString()}),record).then(res=>{reloadTableData();onCancel();setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to update this record");}break;}case"new":{if(createBiometrics===true){module.createRecord((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},formValues),{},{checkIn:formValues.checkIn._d.toISOString()})).then(res=>{reloadTableData();onCancel();setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));}).catch(err=>{handleErrors(err);setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));});}else{setRecordData(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{buttonLoading:false}));message/* default */.Ay.error("You don't have permission to create this record");}break;}}};return/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomModal */.jo,{visible:openModal,closable:true,onCancel:onCancel,titleText:type==="edit"?"Edit Biometric":"Add New Biometric",showFooter:false,children:recordData!==null&&recordData!==void 0&&recordData.loading?/*#__PURE__*/(0,jsx_runtime.jsx)(Skeletons/* default */.A,{items:3}):/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A,{className:styles_module/* default */.A.form,onFinish:onFinish,form:form,children:[(recordData===null||recordData===void 0?void 0:recordData.error)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomErrorAlert */.WZ,{description:recordData===null||recordData===void 0?void 0:recordData.error,isClosable:true,onClose:handleAlertClose}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)(es_form/* default */.A.Item,{name:"userId",rules:[{required:true,message:"Please select an employee"}],children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{className:"font-size-sm",children:["Employee  ",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"color-red-yp",children:"*"})]}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_select/* default */.A,{allowClear:true,style:{width:"100%"},defaultValue:recordData===null||recordData===void 0?void 0:(_recordData$data=recordData.data)===null||_recordData$data===void 0?void 0:_recordData$data.userId,placeholder:"Search for the employee",className:"selectAntdCustom",onChange:value=>form.setFieldsValue({userId:value}),showSearch:true,onSearch:value=>setSearchTermUser(value),optionFilterProp:"label",options:users===null||users===void 0?void 0:users.map(item=>{return{label:item.firstName+" "+item.lastName,value:item.id};}),notFoundContent:/*#__PURE__*/(0,jsx_runtime.jsx)(empty/* default */.A,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:"No data found, Please search for the employee"})})})]})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"mode",rules:[{required:true,message:"Please select a mode"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomSelect */.Ae,{asterisk:true,label:"Mode",options:[{value:"in",label:"Check In"},{value:"out",label:"Check Out"}],placeholder:"Select Mode"})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsxs)("label",{style:{fontSize:'var(--font-size-sm)',color:'var(--color-dark-main)'},children:["Date and time",/*#__PURE__*/(0,jsx_runtime.jsx)("span",{style:{color:'var(--color-red-yp)'},children:" *"}),/*#__PURE__*/(0,jsx_runtime.jsx)(es_form/* default */.A.Item,{name:"checkIn",rules:[{required:true,message:"Please select date and time"}],children:/*#__PURE__*/(0,jsx_runtime.jsx)(date_picker/* default */.A,{dropdownClassName:"hide-disabled-hours",showTime:true,disabledTime:()=>({disabledHours:()=>[0,1,2,3,4,5,6]}),showSecond:false,style:{borderRadius:'0.25rem',borderWidth:2,width:'100%',borderColor:'var(--color-border)'}})})]})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex justify-end",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{size:"normal",fontSize:"sm",onClick:onCancel,type:"plain",children:"Cancel"}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomButton */.Sv,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:recordData===null||recordData===void 0?void 0:recordData.buttonLoading,children:type==="edit"?"Edit Biometric":"Add Biometric"})]})]})});};
// EXTERNAL MODULE: ./node_modules/antd/es/popconfirm/index.js + 1 modules
var popconfirm = __webpack_require__(56231);
// EXTERNAL MODULE: ./node_modules/antd/es/image/index.js + 13 modules
var es_image = __webpack_require__(9206);
// EXTERNAL MODULE: ./node_modules/antd/es/table/index.js + 96 modules
var table = __webpack_require__(41821);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/DeleteOutlined.js
var DeleteOutlined = __webpack_require__(78433);
// EXTERNAL MODULE: ./src/Components/Atoms/Headings/index.tsx
var Headings = __webpack_require__(35751);
// EXTERNAL MODULE: ./node_modules/react-redux/es/index.js + 21 modules
var es = __webpack_require__(98341);
// EXTERNAL MODULE: ./src/helpers/dateHandler.ts
var dateHandler = __webpack_require__(98933);
// EXTERNAL MODULE: ./src/helpers/common.ts
var common = __webpack_require__(88132);
// EXTERNAL MODULE: ./src/Components/Atoms/Pagination/index.tsx + 1 modules
var Pagination = __webpack_require__(6742);
// EXTERNAL MODULE: ./src/services/tokenService.ts
var tokenService = __webpack_require__(92966);
// EXTERNAL MODULE: ./src/services/axiosInstance.ts
var axiosInstance = __webpack_require__(83365);
// EXTERNAL MODULE: ./src/helpers/commonEnums.ts
var commonEnums = __webpack_require__(2360);
;// ./src/Components/Organisms/Dashboard/Biometrics/styles.module.scss
// extracted by mini-css-extract-plugin
/* harmony default export */ const Biometrics_styles_module = ({"selfieImage":"styles_selfieImage__GR1AU","entryTypeStyles":"styles_entryTypeStyles__ib+nB","wrapperEntryTypes":"styles_wrapperEntryTypes__uhiGi","forceStyle":"styles_forceStyle__TnPuI"});
;// ./src/Components/Organisms/Dashboard/Biometrics/table-columns.tsx
const ActionComponent=props=>{const{record,onEditIconClick,reloadTableData,permissions:{deleteBiometrics,updateBiometrics}}=props;const[actionState,setActionState]=(0,react.useState)({confirmLoading:false,openPopConfirm:false});const module=new Biometrics/* BiometricModule */.H();const handleDelete=()=>{setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{confirmLoading:true}));if(deleteBiometrics===false){message/* default */.Ay.error("You don't have permission to delete this record, please contact your admin.");setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false}));return;}module.deleteRecord(record.id).then(res=>{setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false,confirmLoading:false}));reloadTableData();}).catch(err=>{setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{confirmLoading:false}));});};const showPopconfirm=()=>{setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:true}));};return/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.actions,children:[updateBiometrics&&/*#__PURE__*/(0,jsx_runtime.jsx)("span",{onClick:()=>onEditIconClick(record),children:/*#__PURE__*/(0,jsx_runtime.jsx)("img",{src:"/images/editicon.svg",alt:""})}),deleteBiometrics&&/*#__PURE__*/(0,jsx_runtime.jsx)(popconfirm/* default */.A,{open:actionState.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:handleDelete,onCancel:()=>setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false})),okButtonProps:{loading:actionState.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:visible=>{if(!visible){setActionState((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},actionState),{},{openPopConfirm:false}));}},children:/*#__PURE__*/(0,jsx_runtime.jsx)(DeleteOutlined/* default */.A,{className:styles_module/* default */.A.bg__red,onClick:showPopconfirm})})]});};function TableComponent(props){const{tableData,tableLoading,onEditIconClick,reloadTableData,meta,filters}=props;const{userPermissions}=(0,es/* useSelector */.d4)(state=>state.usersReducer);const permissions=userPermissions;const access_token=tokenService/* default */.A.getLocalAccessToken();const module=new Biometrics/* BiometricModule */.H();const columns=[{title:"S.No",dataIndex:"index",key:"index",render:(text,record,index)=>(0,common/* getTableRowNumber */.YO)(index,meta),width:"5%"},{title:"Name",dataIndex:"name",key:"name",render:(text,record)=>{var _record$User,_record$User2;return/*#__PURE__*/(0,jsx_runtime.jsx)(Headings/* default */.A,{color:"dark-main",size:"sm",weight:"bold",children:(record===null||record===void 0?void 0:(_record$User=record.User)===null||_record$User===void 0?void 0:_record$User.firstName)+" "+(record===null||record===void 0?void 0:(_record$User2=record.User)===null||_record$User2===void 0?void 0:_record$User2.lastName)});}},{title:"Mode",dataIndex:"mode",key:"mode",render:(text,record)=>/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:Biometrics_styles_module.wrapperEntryTypes,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Headings/* default */.A,{color:"dark-main",size:"sm",type:"span",lineHeight:1,weight:"bold",children:"Check "+(0,common/* capitalize */.ZH)(record.mode)}),record.type!==Number(commonEnums/* BiometricsEntryType */.iz.auto)&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"my-auto",children:/*#__PURE__*/(0,jsx_runtime.jsxs)("span",{className:Biometrics_styles_module.entryTypeStyles+" "+(record.type===Number(commonEnums/* BiometricsEntryType */.iz.forced)?Biometrics_styles_module.forceStyle:""),children:["(",(0,common/* getEnumKeyByValue */.Hj)(commonEnums/* BiometricsEntryType */.iz,String(record.type)),")"]})})]})},{title:"Time",dataIndex:"checkIn",key:"checkIn",render:(text,record)=>{var _record$AddedBy,_record$AddedBy2,_record$ModifiedBy,_record$ModifiedBy2;return/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Headings/* default */.A,{color:"dark-main",size:"sm",weight:"bold",children:(0,dateHandler/* convertDate */.ic)(record.checkIn,"dd M,yy-t")}),record.type===Number(commonEnums/* BiometricsEntryType */.iz.manual)&&record.AddedBy&&/*#__PURE__*/(0,jsx_runtime.jsxs)("small",{style:{color:'var(--color-dark-sub)',fontSize:"0.6rem"},children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:"Added on "}),/*#__PURE__*/(0,jsx_runtime.jsxs)("span",{children:[" ",record.addedDate&&(0,dateHandler/* convertDate */.ic)(record.addedDate,"dd M,yy")]}),/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:" by "}),/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"inline-block",children:((_record$AddedBy=record.AddedBy)===null||_record$AddedBy===void 0?void 0:_record$AddedBy.firstName)+" "+((_record$AddedBy2=record.AddedBy)===null||_record$AddedBy2===void 0?void 0:_record$AddedBy2.lastName)+" "})]}),record.ModifiedBy&&/*#__PURE__*/(0,jsx_runtime.jsxs)("small",{style:{color:'var(--color-dark-sub)',fontSize:"0.6rem"},children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:"Modified on "}),/*#__PURE__*/(0,jsx_runtime.jsxs)("span",{children:[" ",record.modifiedDate&&(0,dateHandler/* convertDate */.ic)(record.modifiedDate,"dd M,yy")]}),/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:" by "}),/*#__PURE__*/(0,jsx_runtime.jsx)("span",{className:"inline-block",children:((_record$ModifiedBy=record.ModifiedBy)===null||_record$ModifiedBy===void 0?void 0:_record$ModifiedBy.firstName)+" "+((_record$ModifiedBy2=record.ModifiedBy)===null||_record$ModifiedBy2===void 0?void 0:_record$ModifiedBy2.lastName)+" "})]})]});}},{title:"Selfie",dataIndex:"selfie",key:"selfie",render:(selfie,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:selfie&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{style:{height:"60px"},children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_image/* default */.A,{style:{maxHeight:"60px",width:"auto"},src:"".concat(axiosInstance/* BASE_URL */.C,"resources/all/").concat(selfie,"?authKey=").concat(access_token)})})})},{title:"Location",dataIndex:"location",key:"location",render:(text,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:/*#__PURE__*/(0,jsx_runtime.jsx)("iframe",{width:"300",height:"100",frameBorder:"0",style:{border:0}// Corrected the style attribute
,src:"https://www.google.com/maps?q=".concat(record.latitude,",").concat(record.longitude,"&hl=es;z=14&output=embed")// Corrected the template literal syntax
,allowFullScreen:true})}),width:"30%"},permissions.updateBiometrics||permissions.deleteBiometrics?{title:"Actions",dataIndex:"actions",key:"actions",render:(text,record)=>/*#__PURE__*/(0,jsx_runtime.jsx)(ActionComponent,{record:record,onEditIconClick:onEditIconClick,reloadTableData:reloadTableData,permissions:permissions})}:{}];return/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:styles_module/* default */.A.antdTableWrapper,children:/*#__PURE__*/(0,jsx_runtime.jsx)(table/* default */.A,{sticky:true,dataSource:tableData,columns:columns,pagination:false,scroll:{x:991},loading:tableLoading,rowKey:record=>"biometric-type-".concat(record.id)})}),/*#__PURE__*/(0,jsx_runtime.jsx)(Pagination/* Pagination */.d,{total:meta===null||meta===void 0?void 0:meta.total,current:meta===null||meta===void 0?void 0:meta.page,defaultPageSize:(meta===null||meta===void 0?void 0:meta.perPage)||25,pageSizeOptions:[10,20,50,100],onChange:(page,pageSize)=>{reloadTableData((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},filters),{},{page:page,perPage:pageSize}));}})]});}
// EXTERNAL MODULE: ./node_modules/antd/es/button/index.js
var es_button = __webpack_require__(48538);
// EXTERNAL MODULE: ./src/Components/Atoms/ErrorCodes/index.tsx + 1 modules
var ErrorCodes = __webpack_require__(36250);
// EXTERNAL MODULE: ./src/Components/Templates/Layout/index.tsx + 28 modules
var Layout = __webpack_require__(81168);
// EXTERNAL MODULE: ./src/hooks/index.ts + 5 modules
var hooks = __webpack_require__(91970);
// EXTERNAL MODULE: ./src/Modules/Biometrics/permissions.ts
var Biometrics_permissions = __webpack_require__(28765);
// EXTERNAL MODULE: ./src/Modules/BulkUploadFormat/Job/permissions.ts
var Job_permissions = __webpack_require__(69064);
// EXTERNAL MODULE: ./src/Modules/Organization/index.ts
var Organization = __webpack_require__(42361);
;// ./src/Components/Organisms/Dashboard/Biometrics/index.tsx
const breadCrumbsData=[{text:"Home",isLink:true,path:"/"},{isLink:false,text:"Biometrics"}];function Biometrics_Biometrics(){var _filters$type;// available permissions for this module
const permissionSlug=(0,common/* getPermissionSlugs */.AH)(Biometrics_permissions/* BiometricsPermissionSet */.J);const{userPermissions}=(0,es/* useSelector */.d4)(state=>state.usersReducer);const permissions=userPermissions;const bulkUploadPermissions=userPermissions;const organizationModule=new Organization/* OrganizationModule */.I();const{readBiometrics,createBiometrics,updateBiometrics,readAllBiometrics}=permissions;const{createBiometricsJob}=bulkUploadPermissions;const[filters,setFilters]=(0,react.useState)({mode:undefined,type:undefined,fromDate:undefined,toDate:undefined,userId:undefined,organizationId:undefined,page:1,perPage:25});const[currentEditType,setcurrentEditType]=(0,react.useState)({editType:"new",recordId:0,openModal:false});const module=new Biometrics/* BiometricModule */.H();const{data,onRefresh,setData,loading,meta}=(0,hooks/* useFetchData */.Gs)({method:module.getAllRecords,initialQuery:filters});const{data:organization,onRefresh:refreshOrganization}=(0,hooks/* useFetchData */.Gs)({method:organizationModule.findPublished,initialQuery:{}});console.log(organization);const onCancelClick=()=>{if(createBiometrics===false){message/* default */.Ay.error("You don't have permission to create new record");return;}setcurrentEditType((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},currentEditType),{},{openModal:!currentEditType.openModal,editType:"new"}));};const onEditIconClick=record=>{if(updateBiometrics===false){message/* default */.Ay.error("You don't have permission to update this record");return;}setcurrentEditType((0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},currentEditType),{},{editType:"edit",recordId:record.id,openModal:true}));};//user search
const[searchTermUser,setSearchTermUser]=(0,react.useState)("");const debouncedSearchTermUser=(0,useDebounce/* useDebounce */.d)(searchTermUser,500);const[users,setUsers]=(0,react.useState)([]);const userModule=(0,react.useMemo)(()=>new User/* UserModule */.U(),[]);const onUserSearch=(0,react.useCallback)(()=>{if(debouncedSearchTermUser){userModule.getAllRecords({name:debouncedSearchTermUser}).then(res=>{setUsers(prev=>{var _res$data,_res$data$data;// if the data is already present in the state, then don't add it again
const filteredData=res===null||res===void 0?void 0:(_res$data=res.data)===null||_res$data===void 0?void 0:(_res$data$data=_res$data.data)===null||_res$data$data===void 0?void 0:_res$data$data.filter(item=>{return!(prev!==null&&prev!==void 0&&prev.find(prevItem=>prevItem.id===item.id));});// add the new data to the existing data
return[...prev,...filteredData];});}).catch(err=>{message/* default */.Ay.error(err.response.data.message);});}},[debouncedSearchTermUser]);(0,react.useEffect)(()=>{onUserSearch();},[onUserSearch]);return/*#__PURE__*/(0,jsx_runtime.jsxs)(Layout/* default */.A,{permissionSlug:[...permissionSlug,Job_permissions/* BulkUploadJobPermissionsEnum */.Y.CREATE],children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* PageHeader */.zY,{heading:"Biometrics",buttonText:"Add Biometric",onButtonClick:onCancelClick,breadCrumbData:breadCrumbsData,showAdd:createBiometrics===true?true:false,excelExport:createBiometricsJob&&/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{href:'/biometrics/bulk-upload-job?openModal=true',style:{background:'var(--color-light)',border:'none',height:'2.25rem',borderRadius:'0.25rem',marginRight:'0.5rem',display:'flex',alignItems:'center'},children:"Bulk Upload"}),filters:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[readAllBiometrics&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_select/* default */.A,{allowClear:true,placeholder:"Search for the employee",className:"selectAntdCustom",onChange:value=>{const _temp=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},filters),{},{userId:value});setFilters(_temp);onRefresh(_temp);},value:filters.userId?filters.userId:undefined,showSearch:true,onSearch:value=>setSearchTermUser(value),optionFilterProp:"label",options:users===null||users===void 0?void 0:users.map(item=>{return{label:item.firstName+" "+item.lastName,value:item.id};}),notFoundContent:/*#__PURE__*/(0,jsx_runtime.jsx)(empty/* default */.A,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:"No data found, Please search for the employee"})})})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"radio",label:"Type",name:"type",withSearch:false,options:Object.entries(commonEnums/* BiometricsEntryType */.iz).map(_ref=>{let[key,value]=_ref;return{label:(0,common/* capitalize */.ZH)(key),value:value};}),onChange:event=>{const _temp=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},filters),{},{type:Number(event.target.value)});setFilters(_temp);},value:(_filters$type=filters.type)===null||_filters$type===void 0?void 0:_filters$type.toString(),onReset:()=>{const _temp=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},filters),{},{type:undefined});setFilters(_temp);onRefresh(_temp);},onUpdate:()=>onRefresh(filters)})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"datepicker",label:"Date",name:"dateRange",onChange:values=>{var _values$,_values$$_d,_values$2,_values$2$_d;const _temp=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},filters),{},{fromDate:values?(_values$=values[0])===null||_values$===void 0?void 0:(_values$$_d=_values$._d)===null||_values$$_d===void 0?void 0:_values$$_d.toISOString().substring(0,10):undefined,toDate:values?(_values$2=values[1])===null||_values$2===void 0?void 0:(_values$2$_d=_values$2._d)===null||_values$2$_d===void 0?void 0:_values$2$_d.toISOString().substring(0,10):undefined});setFilters(_temp);},onReset:()=>{const _temp=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},filters),{},{fromDate:undefined,toDate:undefined});setFilters(_temp);onRefresh(_temp);},onUpdate:()=>onRefresh(filters)})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"radio",label:"Mode",name:"mode",withSearch:false,options:[{label:"Check In",value:"in"},{label:"Check Out",value:"out"}],onChange:event=>{const _temp=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},filters),{},{mode:event.target.value});setFilters(_temp);},value:filters.mode,onReset:()=>{const _temp=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},filters),{},{mode:undefined});setFilters(_temp);onRefresh(_temp);},onUpdate:()=>onRefresh(filters)})}),/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomFilter */.YH,{type:"radio",label:"Organization",name:"organizationId",withSearch:false,options:organization?organization===null||organization===void 0?void 0:organization.map(ele=>{return{label:ele.name,value:String(ele.id)};}):[],onChange:event=>{const _temp=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},filters),{},{organizationId:event.target.value});setFilters(_temp);},value:String(filters.organizationId),onReset:()=>{const _temp=(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},filters),{},{organizationId:undefined});setFilters(_temp);onRefresh(_temp);},onUpdate:()=>onRefresh(filters)})})]})}),readBiometrics===true&&/*#__PURE__*/(0,jsx_runtime.jsx)(TableComponent,{tableData:data,tableLoading:loading,onEditIconClick:onEditIconClick,reloadTableData:onRefresh,meta:meta,filters:filters}),readBiometrics===false&&/*#__PURE__*/(0,jsx_runtime.jsx)(ErrorCodes/* ErrorCode403 */.$t,{mainMessage:"You don't have permission to view this data"}),currentEditType.openModal&&/*#__PURE__*/(0,jsx_runtime.jsx)(BiometricModal,{record:currentEditType.recordId,type:currentEditType.editType,reloadTableData:onRefresh,onCancel:onCancelClick,openModal:currentEditType.openModal,permissions:permissions})]});}/* harmony default export */ const Dashboard_Biometrics = (Biometrics_Biometrics);

/***/ }),

/***/ 64573:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   H: () => (/* binding */ BiometricModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
class BiometricModule{constructor(){this.endPoint="biometrics";/** Get all Biometric records
     * @param query - query params
     */this.getAllRecords=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint,{params:query});};/**Get Biometric record by id
     * @param id - Biometric id
     */this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/").concat(id));};/**Find published Biometric records
     * @param query - query params
     */this.findPublished=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/published"),{params:query});};/**Delete Biometric record
    * @param id - Biometric id
    */this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete("".concat(this.endPoint,"/").concat(id));};/**Create new Biometric record
     * @param data - Biometric data
     */this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint,data);};/**Update Biometric record
    * @param data - Biometric data
    * @param id - Biometric id
    */this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch("".concat(this.endPoint,"/").concat(id),data);};}}

/***/ }),

/***/ 69064:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Y: () => (/* binding */ BulkUploadJobPermissionsEnum)
/* harmony export */ });
let BulkUploadJobPermissionsEnum=/*#__PURE__*/function(BulkUploadJobPermissionsEnum){BulkUploadJobPermissionsEnum["CREATE"]="createBiometricsJob";BulkUploadJobPermissionsEnum["UPDATE"]="updateBiometricsJob";BulkUploadJobPermissionsEnum["DELETE"]="deleteBiometricsJob";BulkUploadJobPermissionsEnum["READ"]="readBiometricsJob";BulkUploadJobPermissionsEnum["ROLLBACK"]="rollbackBiometricsJob";return BulkUploadJobPermissionsEnum;}({});

/***/ }),

/***/ 42361:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   I: () => (/* binding */ OrganizationModule)
/* harmony export */ });
/* harmony import */ var _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83365);
/* harmony import */ var _modules_Common_config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(21073);
class OrganizationModule{constructor(){this.endPoint="organization";/**Get all organization records
     * @param query - query params
     */this.getAllRecords=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint,{params:query});};/**Get all organization records
     * @param query - query params
     */this.findPublished=query=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get(this.endPoint+"/find-published",{params:query});};/**Get organization record by id
     * @param id - organization id
     */this.getRecordById=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("".concat(this.endPoint,"/").concat(id));};/**Delete organization record
    * @param id - organization id
    */this.deleteRecord=id=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.delete("".concat(this.endPoint,"/").concat(id));};/**Create new organization record
     * @param data - organization data
     */this.createRecord=data=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.post(this.endPoint,data,{headers:_modules_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};/**Update organization record
    * @param data - organization data
    * @param id - organization id
    */this.updateRecord=(data,id)=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.patch("".concat(this.endPoint,"/").concat(id),data,{headers:_modules_Common_config__WEBPACK_IMPORTED_MODULE_1__/* .FormDataHeader */ .Y});};this.getTenants=()=>{return _services_axiosInstance__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A.get("xero/getTenants");};}}

/***/ })

}]);