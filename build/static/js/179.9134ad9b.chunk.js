"use strict";
(self["webpackChunkdat_projects"] = self["webpackChunkdat_projects"] || []).push([[179],{

/***/ 46756:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(9950);
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(57811);
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(65059);
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(17811);
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(80737);
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(56231);
/* harmony import */ var _ant_design_icons__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(90582);
/* harmony import */ var _ant_design_icons__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(26142);
/* harmony import */ var _ant_design_icons__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(78433);
/* harmony import */ var _ant_design_icons__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(72906);
/* harmony import */ var _styles_module_scss__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(98018);
/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(44414);
const ActionsDropdown=props=>{const{item,onDelete,onEdit,setNewProject,setQuickUpdate}=props;const[dropdownOpen,setDropdownOpen]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({});const[deleteConfirmation,setDeleteConfirmation]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);return/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(antd__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A,{trigger:['click'],open:dropdownOpen[item.id],destroyPopupOnHide:true,onOpenChange:open=>setDropdownOpen({[item.id]:open}),menu:{items:[{key:'edit',label:'Edit',icon:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_ant_design_icons__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .A,{}),onClick:()=>{onEdit(item);setDropdownOpen({[item.id]:false});}},{key:'link-to-project',icon:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_ant_design_icons__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .A,{}),label:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(antd__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .A,{placement:"top",trigger:"click",zIndex:9999,destroyTooltipOnHide:true,content:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(antd__WEBPACK_IMPORTED_MODULE_7__/* ["default"].Group */ .Ay.Group,{children:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(antd__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .A,{direction:"vertical",children:[/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(antd__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Ay,{value:"existing",onClick:()=>{var _item$Lead,_item$Lead$Submission,_item$Lead2,_item$Lead2$ProjectTy;setQuickUpdate({open:true,quoteId:item.id,initialProjectId:item.projectId,initialSubmissionById:item===null||item===void 0?void 0:(_item$Lead=item.Lead)===null||_item$Lead===void 0?void 0:(_item$Lead$Submission=_item$Lead.SubmissionBy)===null||_item$Lead$Submission===void 0?void 0:_item$Lead$Submission.id,initialProjectTypeId:item===null||item===void 0?void 0:(_item$Lead2=item.Lead)===null||_item$Lead2===void 0?void 0:(_item$Lead2$ProjectTy=_item$Lead2.ProjectType)===null||_item$Lead2$ProjectTy===void 0?void 0:_item$Lead2$ProjectTy.id});setDropdownOpen({[item.id]:false});},children:"Existing Project"}),/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(antd__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Ay,{value:"new",onClick:()=>{setNewProject({isOpen:true,quoteId:item.id,loading:false,submissionById:0,projectTypeId:0});setDropdownOpen({[item.id]:false});},children:"New Project"})]})}),children:"Link To Project"})// onClick: (e) => {
// e.domEvent.stopPropagation()
// setQuickUpdate({
//   open: true, quoteId: item.id, initialProjectId: item.projectId,
//   initialSubmissionById: item?.Lead?.SubmissionBy?.id,
//   initialProjectTypeId: item?.Lead?.ProjectType?.id
// })
// setDropdownOpen({ [item.id]: false })
// },
},{type:'divider'},{key:'delete',label:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(antd__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .A,{title:"Are you sure to delete this quotation?",onConfirm:()=>{onDelete(item.id);// Close the dropdown and delete confirmation
setDeleteConfirmation(false);setDropdownOpen({[item.id]:false});},okText:"Yes",cancelText:"No",placement:"bottomLeft",open:deleteConfirmation,destroyTooltipOnHide:true,onOpenChange:open=>setDeleteConfirmation(open),zIndex:9999,children:"Delete"}),icon:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_ant_design_icons__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .A,{}),onClick:e=>{e.domEvent.preventDefault();setDeleteConfirmation(!deleteConfirmation);},danger:true}]},children:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_ant_design_icons__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .A,{className:_styles_module_scss__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A.quotation_item_header_actions_more,onClick:e=>e.preventDefault()})})});};/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ActionsDropdown);

/***/ }),

/***/ 50179:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {


// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  A: () => (/* binding */ Card)
});

// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js
var objectSpread2 = __webpack_require__(89379);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(9950);
// EXTERNAL MODULE: ./node_modules/antd/es/typography/index.js + 15 modules
var typography = __webpack_require__(30377);
// EXTERNAL MODULE: ./node_modules/antd/es/message/index.js + 1 modules
var message = __webpack_require__(92759);
// EXTERNAL MODULE: ./node_modules/antd/es/tooltip/index.js
var tooltip = __webpack_require__(81541);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/PlusCircleOutlined.js + 1 modules
var PlusCircleOutlined = __webpack_require__(53387);
// EXTERNAL MODULE: ./src/Components/Atoms/index.tsx + 12 modules
var Atoms = __webpack_require__(9394);
// EXTERNAL MODULE: ./src/Components/Icons/index.tsx + 58 modules
var Icons = __webpack_require__(63668);
// EXTERNAL MODULE: ./src/helpers/dateHandler.ts
var dateHandler = __webpack_require__(98933);
// EXTERNAL MODULE: ./src/Components/Organisms/Invoice/Drawer/index.tsx + 3 modules
var Drawer = __webpack_require__(53822);
// EXTERNAL MODULE: ./src/Components/Organisms/Quotations/Card/actions.tsx
var actions = __webpack_require__(46756);
// EXTERNAL MODULE: ./src/Components/Organisms/Quotations/Card/Dropdown/index.tsx
var Dropdown = __webpack_require__(39799);
// EXTERNAL MODULE: ./node_modules/antd/es/popconfirm/index.js + 1 modules
var popconfirm = __webpack_require__(56231);
// EXTERNAL MODULE: ./node_modules/antd/es/checkbox/index.js + 2 modules
var es_checkbox = __webpack_require__(52765);
// EXTERNAL MODULE: ./node_modules/antd/es/button/index.js
var es_button = __webpack_require__(48538);
// EXTERNAL MODULE: ./node_modules/antd/es/table/index.js + 96 modules
var table = __webpack_require__(41821);
// EXTERNAL MODULE: ./node_modules/@ant-design/icons/es/icons/CheckOutlined.js
var CheckOutlined = __webpack_require__(65472);
// EXTERNAL MODULE: ./src/helpers/commonEnums.ts
var commonEnums = __webpack_require__(2360);
// EXTERNAL MODULE: ./src/helpers/common.ts
var common = __webpack_require__(88132);
// EXTERNAL MODULE: ./src/Modules/Quotation/index.ts
var Quotation = __webpack_require__(83480);
// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js
var jsx_runtime = __webpack_require__(44414);
;// ./src/Components/Organisms/Quotations/Card/Dropdown/milestones.tsx
const MilestonesAndInvoices=props=>{const{item,setDrawer,onRefresh}=props;const{QuotationMilestone}=item;// console.log('QuotationMilestone', QuotationMilestone)
// console.log('item', item)
const allCompletedIds=(0,react.useMemo)(()=>{const ids=[];QuotationMilestone===null||QuotationMilestone===void 0?void 0:QuotationMilestone.forEach(milestone=>{if((milestone===null||milestone===void 0?void 0:milestone.status)!==commonEnums/* MilestoneStatus */.jY['Not Completed']){ids.push(milestone===null||milestone===void 0?void 0:milestone.id);}});return ids;},[QuotationMilestone]);const[selected,setSelected]=(0,react.useState)({open:false,ids:[],completedIds:allCompletedIds});const module=(0,react.useMemo)(()=>new Quotation/* QuotationModule */.v(),[]);const checkUncheck=id=>{const ids=selected.ids.filter(key=>key!==id);setSelected(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{open:false,ids}));};const onCompleteMilestone=id=>{module.completeMilestone(id).then(res=>{var _res$data;message/* default */.Ay.success((res===null||res===void 0?void 0:(_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.message)||'Milestone completed successfully');//remove it from the ids and add it to the completedIds
const ids=selected.ids.filter(key=>key!==id);setSelected(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{open:false,ids,completedIds:[...prev.completedIds,id]}));onRefresh();}).catch(err=>{const errMessage=(0,common/* handleError */.H4)(err);message/* default */.Ay.error(errMessage||'Something went wrong');});};const columns=[{title:'',dataIndex:'id',key:'id',render(id,_record,index){var _selected$completedId,_selected$completedId2,_selected$completedId3;return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"d-flex align-items-center",children:item.projectId?/*#__PURE__*/(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(_selected$completedId=selected.completedIds)!==null&&_selected$completedId!==void 0&&_selected$completedId.includes(id)?/*#__PURE__*/(0,jsx_runtime.jsx)(tooltip/* default */.A,{title:"This milestone is already completed",children:/*#__PURE__*/(0,jsx_runtime.jsx)(CheckOutlined/* default */.A,{style:{color:'var(--color-primary-main)'}})}):/*#__PURE__*/(0,jsx_runtime.jsx)(popconfirm/* default */.A,{title:"This will mark the milestone as completed. Are you sure?",okText:"Yes",cancelText:"No",zIndex:9999,onConfirm:()=>{checkUncheck(id);onCompleteMilestone(id);},onCancel:()=>checkUncheck(id),onOpenChange:open=>{if(!open){checkUncheck(id);}},children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_checkbox/* default */.A,{checked:selected.ids.includes(id),onChange:()=>setSelected(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{open:true,ids:[...prev.ids,id]})),disabled:(_selected$completedId2=selected.completedIds)===null||_selected$completedId2===void 0?void 0:_selected$completedId2.includes(id),defaultChecked:(_selected$completedId3=selected.completedIds)===null||_selected$completedId3===void 0?void 0:_selected$completedId3.includes(id)})})}):/*#__PURE__*/(0,jsx_runtime.jsxs)("span",{children:[index+1,"."]})});}},{title:'Title',dataIndex:'title',key:'title',render(value){return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"d-flex align-items-center",children:/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:value})});}},{title:'Amount',dataIndex:'amount',key:'amount',render(value){return/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:(0,common/* formatCurrency */.vv)(value)});}},{title:'Status',dataIndex:'status',key:'status',render(status,record){return/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[/*#__PURE__*/(0,jsx_runtime.jsx)("span",{children:commonEnums/* MilestoneStatus */.jY[status]}),status===commonEnums/* MilestoneStatus */.jY.Completed&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{type:"ghost",size:"small",style:{fontSize:'0.7rem',borderColor:'var(--color-primary-main)',color:'var(--color-primary-main)'},onClick:()=>{setDrawer({type:'create',open:true,quotation:item,id:record.invoiceId,projectId:item.projectId});},children:"Create Invoice"})}),status===commonEnums/* MilestoneStatus */.jY['Invoice Generated']&&/*#__PURE__*/(0,jsx_runtime.jsx)("div",{children:/*#__PURE__*/(0,jsx_runtime.jsx)(es_button/* default */.A,{type:"ghost",size:"small",style:{fontSize:'0.7rem',borderColor:'var(--color-primary-main)',color:'var(--color-primary-main)'},onClick:()=>{setDrawer({open:true,type:'preview',quotation:item,id:record.invoiceId,projectId:item.projectId});},children:"Submit Invoice"})})]});}}];return/*#__PURE__*/(0,jsx_runtime.jsx)(table/* default */.A,{columns:columns,dataSource:QuotationMilestone||[],pagination:false});};/* harmony default export */ const milestones = (MilestonesAndInvoices);
// EXTERNAL MODULE: ./src/Components/Organisms/Quotations/Card/styles.module.scss
var styles_module = __webpack_require__(98018);
;// ./src/Components/Organisms/Quotations/Card/Dropdown/scope-of-work.tsx
const ScopeOfWork=_ref=>{let{item}=_ref;return/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:"mx-2 color-dark-sub ".concat(styles_module/* default */.A.accordianItem),dangerouslySetInnerHTML:{__html:item===null||item===void 0?void 0:item.scopeOfWork}});};/* harmony default export */ const scope_of_work = (ScopeOfWork);
// EXTERNAL MODULE: ./src/Components/Organisms/Quotations/status.tsx
var Quotations_status = __webpack_require__(75492);
// EXTERNAL MODULE: ./src/Components/Organisms/Quotations/quick-update.tsx
var quick_update = __webpack_require__(15459);
// EXTERNAL MODULE: ./src/Components/Organisms/Quotations/new-project.tsx
var new_project = __webpack_require__(88374);
// EXTERNAL MODULE: ./src/hooks/index.ts + 5 modules
var hooks = __webpack_require__(91970);
;// ./src/Components/Organisms/Quotations/Card/index.tsx
const{Paragraph}=typography/* default */.A;const QuotationsCard=props=>{const{data,permissions,setQuotationDrawer,setNewProject,newProject}=props;const{onRefresh,allQuotation}=data;const module=(0,react.useMemo)(()=>new Quotation/* QuotationModule */.v(),[]);// Invoice Drawer State
const{drawer,setDrawer}=(0,hooks/* useInvoiceDrawer */.C9)();// Quick Update Modal State
const[quickUpdate,setQuickUpdate]=(0,react.useState)({open:false,quoteId:0,initialProjectId:0,initialSubmissionById:0,initialProjectTypeId:0});/**Function to delete a lead
  * @param {number} id id of the lead to be deleted
  */const onDelete=id=>{if(permissions.deleteQuotation===true){module.deleteRecord(id).then(()=>onRefresh()).catch(err=>{const errorMessages=(0,common/* handleError */.H4)(err);message/* default */.Ay.error(errorMessages||"Something went wrong, please try again later.");});}else{message/* default */.Ay.error("You don't have permission to delete this quotation, Please contact your admin");}};const onEdit=record=>{if(permissions.updateQuotation===false){message/* default */.Ay.error("You don't have permission to update record");return;}setQuotationDrawer(()=>{var _record$Lead,_record$Lead$Submissi;return{open:true,type:"edit",quoteId:record===null||record===void 0?void 0:record.id,leadId:record===null||record===void 0?void 0:record.leadId,submissionById:record===null||record===void 0?void 0:(_record$Lead=record.Lead)===null||_record$Lead===void 0?void 0:(_record$Lead$Submissi=_record$Lead.SubmissionBy)===null||_record$Lead$Submissi===void 0?void 0:_record$Lead$Submissi.id};});};return/*#__PURE__*/(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(allQuotation===null||allQuotation===void 0?void 0:allQuotation.length)===0&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* CustomEmpty */.ZX,{description:"No quotation found",className:"my-5"}),/*#__PURE__*/(0,jsx_runtime.jsx)("section",{className:styles_module/* default */.A.quotations,children:allQuotation===null||allQuotation===void 0?void 0:allQuotation.map((item,index)=>{var _item$Lead,_item$Lead$Client,_item$Lead2,_item$Lead2$Client,_item$Lead3,_item$Lead3$Client,_item$Lead4,_item$Lead4$Client;return/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.quotation_item,children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.quotation_item_header,children:[/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:styles_module/* default */.A.quotation_item_header_left,children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{className:styles_module/* default */.A.quotation_item_header_title,onClick:()=>setQuotationDrawer(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{open:true,quoteId:item===null||item===void 0?void 0:item.id,type:"preview",quotation:item})),color:"dark-main",size:"sm",children:(item===null||item===void 0?void 0:item.quoteNumber)||"No Quote Number"}),"Amount: ",(0,common/* formatCurrency */.vv)((item===null||item===void 0?void 0:item.total)||0),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex flex-column",children:[(item===null||item===void 0?void 0:(_item$Lead=item.Lead)===null||_item$Lead===void 0?void 0:(_item$Lead$Client=_item$Lead.Client)===null||_item$Lead$Client===void 0?void 0:_item$Lead$Client.name)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"sm",className:"mt-1 mb-0",children:item===null||item===void 0?void 0:(_item$Lead2=item.Lead)===null||_item$Lead2===void 0?void 0:(_item$Lead2$Client=_item$Lead2.Client)===null||_item$Lead2$Client===void 0?void 0:_item$Lead2$Client.name}),(item===null||item===void 0?void 0:(_item$Lead3=item.Lead)===null||_item$Lead3===void 0?void 0:(_item$Lead3$Client=_item$Lead3.Client)===null||_item$Lead3$Client===void 0?void 0:_item$Lead3$Client.email)&&/*#__PURE__*/(0,jsx_runtime.jsx)(Paragraph,{ellipsis:{rows:1,expandable:false},copyable:{text:item.Lead.Client.email},className:"font-size-xs color-dark-sub mb-0",children:item===null||item===void 0?void 0:(_item$Lead4=item.Lead)===null||_item$Lead4===void 0?void 0:(_item$Lead4$Client=_item$Lead4.Client)===null||_item$Lead4$Client===void 0?void 0:_item$Lead4$Client.email}),item.Lead.Client.phone!=="undefined"&&item.Lead.Client.phone&&/*#__PURE__*/(0,jsx_runtime.jsx)(Paragraph,{ellipsis:{rows:1,expandable:false},copyable:{text:"".concat(item.Lead.Client.phoneCode).concat(item.Lead.Client.phone)},className:"font-size-xs color-dark-sub mb-0",children:"+".concat(item.Lead.Client.phoneCode).concat(item.Lead.Client.phone)})]})]})}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.quotation_item_header_actions,children:[/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.quotation_item_header_actions_items,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Quotations_status/* default */.A,{item:item,onRefresh:onRefresh,permissions:permissions,setDrawer:setQuotationDrawer,setNewProject:setNewProject}),/*#__PURE__*/(0,jsx_runtime.jsx)(actions/* default */.A,{item:item,onDelete:onDelete,onEdit:onEdit,setNewProject:setNewProject,setQuickUpdate:setQuickUpdate})]}),(item===null||item===void 0?void 0:item.sentDate)&&/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex align-center",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Icons/* CalenderIcon */.e$,{className:"mr-2",width:13}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"xs",className:"mt-1",children:"Sent: ".concat((0,dateHandler/* convertDate */.ic)(item.addedDate,"dd MM yy"))||0})]}),(item===null||item===void 0?void 0:item.addedDate)&&/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex align-center",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Icons/* CalenderIcon */.e$,{className:"mr-2",width:13}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"xs",className:"mt-1",children:"Created: ".concat((0,dateHandler/* convertDate */.ic)(item.addedDate,"dd MM yy"))||0})]}),(item===null||item===void 0?void 0:item.modifiedDate)&&/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex align-center",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Icons/* CalenderIcon */.e$,{className:"mr-2",width:13}),/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-sub",size:"xs",className:"mt-1",children:"Modified: ".concat((0,dateHandler/* convertDate */.ic)(item.modifiedDate,"dd MM yy"))||0})]})]})]}),/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:styles_module/* default */.A.quotation_item_body,children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Dropdown/* default */.A,{label:/*#__PURE__*/(0,jsx_runtime.jsx)("div",{className:styles_module/* default */.A.quotation_title,children:/*#__PURE__*/(0,jsx_runtime.jsxs)("div",{className:"d-flex align-center",children:[/*#__PURE__*/(0,jsx_runtime.jsx)(Atoms/* Typography */.o5,{color:"dark-main",size:"sm",children:"Milestones & Invoices"}),/*#__PURE__*/(0,jsx_runtime.jsx)(tooltip/* default */.A,{title:"Add Quotation",children:/*#__PURE__*/(0,jsx_runtime.jsx)(PlusCircleOutlined/* default */.A,{className:"ml-2",style:{fontSize:'1rem'},onClick:e=>{e.stopPropagation();setDrawer(prev=>(0,objectSpread2/* default */.A)((0,objectSpread2/* default */.A)({},prev),{},{open:true,type:"create",quotation:item,projectId:item===null||item===void 0?void 0:item.projectId}));}})})]})}),children:/*#__PURE__*/(0,jsx_runtime.jsx)(milestones,{item:item,setDrawer:setDrawer,onRefresh:onRefresh})}),/*#__PURE__*/(0,jsx_runtime.jsx)(Dropdown/* default */.A,{label:"Scope Of Work",placement:"bottomRight",children:/*#__PURE__*/(0,jsx_runtime.jsx)(scope_of_work,{item:item})})]})]},"invoice-".concat(index));})}),drawer.open&&/*#__PURE__*/(0,jsx_runtime.jsx)(Drawer/* default */.A,{drawer:drawer,setDrawer:setDrawer,onRefresh:onRefresh,permissions:permissions}),(quickUpdate===null||quickUpdate===void 0?void 0:quickUpdate.open)&&/*#__PURE__*/(0,jsx_runtime.jsx)(quick_update/* default */.A,{open:quickUpdate.open,quickUpdate:quickUpdate,onClose:()=>{setQuickUpdate({open:false,quoteId:0,initialProjectId:0,initialSubmissionById:0,initialProjectTypeId:0});onRefresh();}}),(newProject===null||newProject===void 0?void 0:newProject.isOpen)&&/*#__PURE__*/(0,jsx_runtime.jsx)(new_project/* default */.A,{setNewProject:setNewProject,newProject:newProject,onRefresh:onRefresh,permissions:permissions})]});};/* harmony default export */ const Card = (QuotationsCard);

/***/ }),

/***/ 15459:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(9950);
/* harmony import */ var _atoms_index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(9394);
/* harmony import */ var _helpers_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(88132);
/* harmony import */ var _helpers_useDebounce__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(28173);
/* harmony import */ var _modules_Organization__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(42361);
/* harmony import */ var _modules_Project__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(50167);
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(10678);
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(92759);
/* harmony import */ var antd__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(32645);
/* harmony import */ var hooks__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(91970);
/* harmony import */ var _modules_Quotation__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(83480);
/* harmony import */ var _modules_ProjectType__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(12975);
/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(44414);
const QuickUpdate=props=>{const{open,onClose,quickUpdate}=props;const[form]=antd__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .A.useForm();const[loading,setLoading]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);const module=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>new _modules_Quotation__WEBPACK_IMPORTED_MODULE_7__/* .QuotationModule */ .v(),[]);const projectModule=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>new _modules_Project__WEBPACK_IMPORTED_MODULE_5__/* .ProjectModule */ .K(),[]);const orgModule=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>new _modules_Organization__WEBPACK_IMPORTED_MODULE_4__/* .OrganizationModule */ .I(),[]);const projectTypeModule=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>new _modules_ProjectType__WEBPACK_IMPORTED_MODULE_8__/* .ProjectTypeModule */ .g(),[]);// Project Search Term
const[searchTermProject,setSearchTermProject]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)("");const debouncedSearchTermProject=(0,_helpers_useDebounce__WEBPACK_IMPORTED_MODULE_3__/* .useDebounce */ .d)(searchTermProject,500);const{data:orgData}=(0,hooks__WEBPACK_IMPORTED_MODULE_6__/* .useConditionFetchData */ .P6)({method:orgModule.findPublished,condition:open});const{data:projectTypeData}=(0,hooks__WEBPACK_IMPORTED_MODULE_6__/* .useConditionFetchData */ .P6)({method:projectTypeModule.getPublishRecords,condition:open,initialQuery:{perPage:100}});const[projectOptions,setProjectOptions]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]);// Project Search
const onProjectSearch=function(){let{title,ids}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};projectModule.getAllRecords({title:title,ids:ids}).then(res=>{const{data}=res===null||res===void 0?void 0:res.data;setProjectOptions(prev=>{// if the data is already present in the state, then don't add it again
const filteredData=data===null||data===void 0?void 0:data.filter(item=>{return!(prev!==null&&prev!==void 0&&prev.find(prevItem=>prevItem.id===item.id));});// add the new data to the existing data
return[...prev,...filteredData];});}).catch(err=>{const errorMessage=(0,_helpers_common__WEBPACK_IMPORTED_MODULE_2__/* .handleError */ .H4)(err);antd__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Ay.error(errorMessage);});};const onFinish=values=>{setLoading(true);module.quickUpdate(quickUpdate===null||quickUpdate===void 0?void 0:quickUpdate.quoteId,values).then(res=>{antd__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Ay.success("Quotation updated successfully!");onClose();}).catch(err=>{const errorMessage=(0,_helpers_common__WEBPACK_IMPORTED_MODULE_2__/* .handleError */ .H4)(err);antd__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Ay.error(errorMessage);}).finally(()=>setLoading(false));};// Project Search Request
(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{if(!debouncedSearchTermProject)return;onProjectSearch({title:debouncedSearchTermProject});},[debouncedSearchTermProject]);// Initial Project Id
(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{if((quickUpdate===null||quickUpdate===void 0?void 0:quickUpdate.initialProjectId)!==0){onProjectSearch({ids:[quickUpdate===null||quickUpdate===void 0?void 0:quickUpdate.initialProjectId]});form.setFieldsValue({projectId:quickUpdate===null||quickUpdate===void 0?void 0:quickUpdate.initialProjectId});}},[quickUpdate===null||quickUpdate===void 0?void 0:quickUpdate.initialProjectId]);return/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(antd__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .A,{open:open,onCancel:onClose,zIndex:10000,destroyOnClose:true,title:"Quick Update",okText:"Update",cancelText:"Cancel",okButtonProps:{htmlType:'submit',form:'quick-update-form',loading},children:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)(antd__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .A,{onFinish:onFinish,form:form,name:"quick-update-form",children:[/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(antd__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .A.Item,{name:"projectId",rules:[{required:true,message:"Please select a project"}],children:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_atoms_index__WEBPACK_IMPORTED_MODULE_1__/* .SelectWithSearch */ .fd,{label:"Select Project",notFoundDescription:"No projects found., Please search for projects.",onSearch:value=>setSearchTermProject(value),onChange:value=>form.setFieldsValue({projectId:value}),options:projectOptions===null||projectOptions===void 0?void 0:projectOptions.map(item=>({label:"".concat(item.referenceNumber," | ").concat(item.title),value:item.id}))})}),/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(antd__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .A.Item,{name:"submissionById",initialValue:(quickUpdate===null||quickUpdate===void 0?void 0:quickUpdate.initialSubmissionById)||undefined,rules:[{required:true,message:"Please select a submission by!"}],children:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_atoms_index__WEBPACK_IMPORTED_MODULE_1__/* .CustomSelect */ .Ae,{label:"Submission By",asterisk:true,options:orgData===null||orgData===void 0?void 0:orgData.map(item=>({label:item.name,value:item.id}))})}),/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(antd__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .A.Item,{name:"projectTypeId",initialValue:(quickUpdate===null||quickUpdate===void 0?void 0:quickUpdate.initialProjectTypeId)||undefined,rules:[{required:true,message:"Please select project type"}],children:/*#__PURE__*/(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_atoms_index__WEBPACK_IMPORTED_MODULE_1__/* .CustomSelect */ .Ae,{label:"Project Type",asterisk:true,placeholder:"Select Project Type",options:projectTypeData===null||projectTypeData===void 0?void 0:projectTypeData.map(item=>{return{value:item.id,label:item.title};})})})]})});};/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (QuickUpdate);

/***/ })

}]);